<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE11" /><meta name="copyright" content="(C) Copyright 2023" />
<meta name="DC.rights.owner" content="(C) Copyright 2023" />
<meta name="DC.type" content="topic" />
<meta name="DC.title" content="Application Development" />
<meta name="DC.relation" scheme="URI" content="GUID-F05AF46A-7BBB-4175-9128-7552429BC260.html" />
<meta name="DC.format" content="XHTML" />
<meta name="DC.identifier" content="GUID-EBCBA6AB-093F-4B8D-88F1-C98BE40F5156" />
<meta name="DC.language" content="en-US" />
<link rel="stylesheet" type="text/css" href="stylesheets/atmel.css" />
<title>Application Development</title>
<meta name="Microsoft.Help.Id" content="GUID-A5330D3A-9F51-4A26-B71D-8503A493DF9C-GUID-EBCBA6AB-093F-4B8D-88F1-C98BE40F5156" />
<meta name="Microsoft.Help.TocParent" content="GUID-A5330D3A-9F51-4A26-B71D-8503A493DF9C-GUID-F05AF46A-7BBB-4175-9128-7552429BC260" />
<meta name="Microsoft.Help.TocOrder" content="0" />
<meta name="Microsoft.Help.Locale" content="en-US" />
<meta name="Microsoft.Help.TopicLocale" content="en-US" />
<meta name="Microsoft.Help.DisplayVersion" content="Software Development Reference A 09/2022" />
<script language="javascript">
       
       if (window.parent.location.protocol != 'file:') {
				document.addEventListener('click', function(e) {
				    if (e.target) {
               if (e.target.nodeName == "A" ) {
                    if (!e.target.target) {
                      e.preventDefault();
                      e.stopPropagation();
                              
                      var origUrl = window.parent.location.href.substr(0, window.parent.location.href.indexOf("?"));
                      if (origUrl.length === 0) {
                          origUrl = window.parent.location.href;
                      }
                      var href= e.target.getAttribute("href");
                      var parts = href.split("#");
          
                      var url = "";
                      if (parts.length == 2 ) {
                        if (!parts[0].length) {
                            url = window.parent.location.search.replace('?','')
                        } else {
                            url = parts[0].replace('.html','');
                        }
                      } else {
                        url = parts[0].replace('.html','');
                      }

                      if (parts.length == 2) {
                          url += "#" + parts[1];
                      }
    
                      window.parent.location.href = origUrl + "?" + url;

                      return false;
                    }
               }
            }
				});
			}

		</script><script language="javascript">
         
         function copyContent(content, button) {
         
            var textArea = document.createElement("textarea");
            
            // Place in the top-left corner of screen regardless of scroll position.
            textArea.style.position = 'fixed';
            textArea.style.top = 0;
            textArea.style.left = 0;
            
            // Ensure it has a small width and height. Setting to 1px / 1em
            // doesn't work as this gives a negative w/h on some browsers.
            textArea.style.width = '2em';
            textArea.style.height = '2em';
            
            // We don't need padding, reducing the size if it does flash render.
            textArea.style.padding = 0;
            
            // Clean up any borders.
            textArea.style.border = 'none';
            textArea.style.outline = 'none';
            textArea.style.boxShadow = 'none';
            
            // Avoid flash of the white box if rendered for any reason.
            textArea.style.background = 'transparent';
            
            textArea.value = content;
            
            document.body.appendChild(textArea);
            textArea.focus();
            textArea.select();
            
            try {
               var successful = document.execCommand('copy');
               var msg = successful ? 'successful' : 'unsuccessful';
               if (!button.classList.contains("copied")){
                  button.textContent = "Copied";
                  button.classList.add("copied");
                  setTimeout(function(){
                     button.textContent = "Copy";
                     button.classList.remove("copied");
                  },1000);
               }
            } catch (err) {
               console.log('Oops, unable to copy');
            }
            
            document.body.removeChild(textArea);
         }
         
         function cpy(id, button) {
            var element = document.getElementById(id);
            var content = element.getAttribute("content");
            
            copyContent(content, button);
         }
         
         document.addEventListener("DOMContentLoaded", function(event) {
            document.querySelectorAll(".codeblock").forEach(function(elem) {
               elem.style.position = "relative";
               var copy = document.createElement("button");
               copy.textContent = "Copy";
               copy.setAttribute("class", "copy-code");
               
               var content = elem.textContent;
               
               copy.addEventListener("click", function(){
                  copyContent(content, copy);
               });
               
               elem.addEventListener("mouseenter", function(evt){
                  elem.prepend(copy);
               });
            });
            
            document.querySelectorAll(".codeblock").forEach(function(elem) {
               elem.addEventListener("mouseleave", function(evt){
                  document.querySelector(".copy-code").remove();
               });
            });
         });
         
      </script><script language="javascript">
          
          // Add the MathML namespace to html
          var html = document.getElementsByTagName("html")[0],
          head = document.getElementsByTagName("head")[0];
          
          var mathJax = document.createElement("script");
          mathJax.src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML";
          head.appendChild(mathJax);
          
          html.setAttribute("xmlns:m","http://www.w3.org/1998/Math/MathML");
          
          function inIframe() { try { return window.self !== window.top; } catch (e) { return true; } }
          
          if (!inIframe()) { 
          
          var Default = "index.html?GUID-EBCBA6AB-093F-4B8D-88F1-C98BE40F5156"; 
          
          var displaylocation = "value" + window.location.href;
          
          var GUIDS = displaylocation.split('GUID');          
          
          if (displaylocation.indexOf('#GUID') != -1) {            
          var First = GUIDS[1].split('.html');  
          if (GUIDS[3]){First = GUIDS[2].split('.html');}
          if (GUIDS[4]){First = GUIDS[3].split('.html');}
          if (GUIDS[5]){First = GUIDS[4].split('.html');}
          
          var Second = GUIDS[2].split('#');   
          if (GUIDS[3]){Second = GUIDS[3].split('#');}
          if (GUIDS[4]){Second = GUIDS[4].split('#');}
          if (GUIDS[5]){Second = GUIDS[5].split('#');}
          
          Default = "index.html?" + "GUID" + First[0] + "GUID" + Second[0];     
          }                    
          window.top.location = Default;
          }       
          
        </script><link rel="stylesheet" type="text/css" href="syntax-highlight.css" /><style xml:space="">
        
          button.copy-code{
            display:none;
            padding:0.7em 1.4em;
            margin:0 0.3em 0.3em 0;
            border-radius:0.15em;
            box-sizing: border-box;
            text-decoration:none;
            font-family:'Roboto',sans-serif;
            text-transform:uppercase;
            font-weight:400;
            color:#FFFFFF;
            background-color:#9c9c9c;
            box-shadow:inset 0 -0.6em 0 -0.35em rgba(0,0,0,0.17);
            text-align:center;
            position:relative;
            border: 0;
            float: right;
            border-radius: .5em;
            cursor: pointer;
          }
          button.copy-code:active{
            top:0.1em;
          }
          
          pre:hover button.copy-code{
            display: inline-block !important;
          }
          button.copy-code.copied {
            cursor: default !important;
          }
          
          
          @media all and (max-width:30em){
            button.copy-code{
              display:block;
              margin:0.4em auto;
            }
          }
        
        
      </style><link rel="stylesheet" type="text/css" href="syntax-highlight.css" /></head>
<body id="GUID-EBCBA6AB-093F-4B8D-88F1-C98BE40F5156">
<h1 class="title topictitle1" id="GUID-EBCBA6AB-093F-4B8D-88F1-C98BE40F5156__GUID-6B21F709-B835-4297-95DC-CC68FF58F9BB" style="">Application Development</h1><div class="body"><p class="shortdesc"></p>
<p class="p"></p>
<ol class="ol" id="GUID-EBCBA6AB-093F-4B8D-88F1-C98BE40F5156__GUID-C12A5377-F9AE-4B53-9E40-172AC962C7A8"><li class="li" id="GUID-EBCBA6AB-093F-4B8D-88F1-C98BE40F5156__GUID-2A193D2A-F5DA-4FAF-99E7-ABD6EA0DEFC7"><span class="indent-level-default">1.</span><p class="p"><strong class="ph b">Compile MCC auto generated project</strong></p>
<ul class="ul"><li class="li" id="GUID-EBCBA6AB-093F-4B8D-88F1-C98BE40F5156__GUID-18456F9F-CE92-4B4E-B5BD-959F7DE0ECA0"><div class="p">Compile the MCC auto generated project as below<div class="fig fignone" id="GUID-EBCBA6AB-093F-4B8D-88F1-C98BE40F5156__GUID-078F3DB0-3142-4D77-8E1D-0AE4E830FFB8"><span class="desc figdesc"></span><img class="image" src="GUID-874854AB-42CF-495A-AA4B-7EF88B6C4B24-low.png" /></div>
</div>
</li>
</ul>
<div class="p"><div class="fig fignone" id="GUID-EBCBA6AB-093F-4B8D-88F1-C98BE40F5156__GUID-A45A5D00-F767-494F-AE66-C13968F3946E"><img class="image" src="GUID-FA28854B-D69C-45AF-B59C-E4380D69C5A2-low.png" /></div>
</div>
<ul class="ul"><li class="li" id="GUID-EBCBA6AB-093F-4B8D-88F1-C98BE40F5156__GUID-AE040CE4-2CD7-497E-8990-6BBC69F9AF30"><div class="p">Addressing the mandatory error (if not already done): User action required in app_user_edits.c. Follow the steps mentioned in the note and do the necessary changes. Then comment the <strong class="ph b">#error</strong> message as below.<div class="fig fignone" id="GUID-EBCBA6AB-093F-4B8D-88F1-C98BE40F5156__GUID-3BD70DC3-5F32-4E28-BDCA-995AE6E9C06C"><span class="desc figdesc"></span><img class="image" src="GUID-8E864E0B-4B57-4020-B4AA-E65B58C813F9-low.png" /></div>
</div>
</li>
</ul>
</li>
<li class="li" id="GUID-EBCBA6AB-093F-4B8D-88F1-C98BE40F5156__GUID-2A193D2A-F5DA-4FAF-99E7-ABD6EA0DEFC7"><span class="indent-level-default">2.</span><p class="p">Some configurations of interest in \zigbee\zigbee_device\configs\otauConfig.h</p>
</li>
</ol>
<ul class="ul"><li class="li" id="GUID-EBCBA6AB-093F-4B8D-88F1-C98BE40F5156__GUID-C9641FAA-77B0-4531-8594-2AC8CF4C0AD3"><p class="p">Interval between block requests. This decides the firmware upgrade speed. If the interval is more, then the upgrade will take longer time.</p>
</li>
</ul>
<p class="p">#define ZCL_OTAU_DEFAULT_BLOCK_REQ_PERIOD 1000</p>
<ul class="ul"><li class="li" id="GUID-EBCBA6AB-093F-4B8D-88F1-C98BE40F5156__GUID-194C68BA-C444-46D2-9419-4899ACC1F96B"><p class="p">AES Key and Init Vector. This is used to decrypting the upgradable image which is encrypted. The key used to encrypt the upgradable image should match with this key value.</p>
</li>
</ul>
<p class="p">#define OTA_IMAGE_CBC_KEY {0x01, 0x12, 0x23, 0x34, 0x45, 0x56, 0x67, 0x78, 0x89, 0x90, 0x99, 0x88, 0x77, 0x66, 0x55, 0x44}</p>
<p class="p">#define OTA_IMAGE_CBC_IV {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}</p>
<ul class="ul"><li class="li" id="GUID-EBCBA6AB-093F-4B8D-88F1-C98BE40F5156__GUID-ED50A022-79DD-4747-BDDA-F05E1929870B"><p class="p">The current running image checks the version of new image against to this configuration value and expects the new image version is not same as this value.</p>
</li>
</ul>
<p class="p">#define CS_ZCL_OTAU_FILE_VERSION 0X50030700//CS_STACK_VERSION_VALUE</p>
<ul class="ul"><li class="li" id="GUID-EBCBA6AB-093F-4B8D-88F1-C98BE40F5156__GUID-719A971A-E795-4DD4-A12B-8B4425983CD9"><p class="p">This configuration is image Type and running image checks the upgradable image type against to this value. If the upgradable image type matches to this configuration value or 0xFFFF, only then upgrade happens.</p>
</li>
</ul>
<p class="p">#define OTAU_APP_IMAGE_TYPE OTA_EXTENDED_COLOR_LIGHT_IMAGE_TYPE</p>
<p class="p"></p>
</div>
<div class="related-links">
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a class="link" href="GUID-F05AF46A-7BBB-4175-9128-7552429BC260.html">OTA Implementation Details - OTAU Client Side</a></div>
</div>
</div></body>
</html>