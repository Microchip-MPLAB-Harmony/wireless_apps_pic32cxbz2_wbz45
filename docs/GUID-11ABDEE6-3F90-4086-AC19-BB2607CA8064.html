<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us" data-whc_version="24.1">
    <head><link rel="shortcut icon" href="oxygen-webhelp\template\resources/images/favicon.ico"/><link rel="icon" href="oxygen-webhelp\template\resources/images/favicon.ico"/><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="description" content="This tutorial explains to the users on how create multiprotocol (BLE and ZIGBEE) example project using Mplab code configurator. The step by step procedure will help the user to generate the ..."/><meta name="copyright" content="(C) Copyright 2024"/><meta name="generator" content="DITA-OT"/><title>5.1 Multiprotocol (BLE+ZIGBEE) Concurrent Application - Tutorial</title><!--  Generated with Oxygen version 24.1, build number 2022062014.  --><meta name="wh-path2root" content=""/><meta name="wh-toc-id" content="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064-d1765e576"/><meta name="wh-source-relpath" content="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064.xml"/><meta name="wh-out-relpath" content="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064.html"/>
    <!-- Latest compiled and minified Bootstrap CSS -->
    <link rel="stylesheet" type="text/css" href="./oxygen-webhelp/lib/bootstrap/css/bootstrap.min.css"/>
    
    <link rel="stylesheet" href="./oxygen-webhelp/lib/jquery-ui/jquery-ui.min.css"/>
    
    <!-- Template default styles  -->
    <link rel="stylesheet" type="text/css" href="./oxygen-webhelp/app/topic-page.css?buildId=2022062014"/>
    
    
    <script src="./oxygen-webhelp/lib/jquery/jquery-3.5.1.min.js"></script>
    
    <script data-main="./oxygen-webhelp/app/topic-page.js" src="./oxygen-webhelp/lib/requirejs/require.js"></script>
<link rel="stylesheet" type="text/css" href="oxygen-webhelp/template/microchip.css?buildId=2022062014"/><link rel="stylesheet" type="text/css" href="oxygen-webhelp/template/notes.css?buildId=2022062014"/>
<script src="mchp-context-help.js"></script>
<link href="https://fonts.googleapis.com/css?family=Open+Sans:400,600,300" rel="stylesheet" type="text/css"/>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async="" type="text/javascript"></script>
    <script src="https://assets.adobedtm.com/6a72a357eb48/a636c708c7fe/launch-0b0023397020.min.js"></script><!-- Adobe Analytics -->
</head>

    <body id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064" class="wh_topic_page frmBody">
        <a href="#wh_topic_body" class="sr-only sr-only-focusable">
            Jump to main content
        </a>
        
        
        
        
        <header class="navbar navbar-default wh_header">
    <div class="container-fluid">
        <div class="wh_header_flex_container navbar-nav navbar-expand-md navbar-dark">
            <div class="wh_logo_and_publication_title_container">
                <div class="wh_logo_and_publication_title">
                    
                    <a href="index.html" class=" wh_logo d-none d-sm-block "><img src="oxygen-webhelp\template\resources/images/microchip.png" alt="PIC32CXBZ2 Application Developer's Guide "/></a>
                    <div class=" wh_publication_title "><a href="index.html">PIC32CXBZ2 Application Developer's Guide </a></div>
                    
                </div>
                
                
            </div>

            <div class="wh_top_menu_and_indexterms_link collapse navbar-collapse" id="wh_top_menu_and_indexterms_link">
                
                
                
                
            </div>
        </div>
    </div>
</header>
        
        
         
        
        <div class=" wh_search_input navbar-form wh_topic_page_search search " role="form">
            
            
            
            <form id="searchForm" method="get" role="search" action="search.html"><div class="d-flex justify-contents-around"><div class="flex-grow-1"></div><div class="position-relative flex-grow-1"><input type="search" placeholder="Search " class="wh_search_textfield" id="textToSearch" name="searchQuery" aria-label="Search query" required="required"/><button type="submit" class="wh_search_button" aria-label="Search"><span class="search_input_text">Search</span></button></div><div class="align-self-center flex-grow-1 ml-2"><div class="d-flex justify-content-end"><div class="dropdown"><a style="font-size: 1em; padding: 7px 12px !important;" class="btn py-3 px-3 btn-outline-light dropdown-toggle" href="#" role="button" id="devicesMenu" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Product Pages</a><div style="font-size: 1em;" class="dropdown-menu" aria-labelledby="devicesMenu"><a class="dropdown-item" target="_blank" href="https://www.microchip.com/en-us/product/pic32cx-bz2">PIC32CX-BZ2</a><a class="dropdown-item" target="_blank" href="https://www.microchip.com/en-us/product/wbz451"> WBZ451</a></div></div></div></div></div></form>
            
            <div class="mchp-color-stripe-grid-container">
  <div class="mchp-main-bar mchp-orange-bar"></div>
  <div class="mchp-main-bar mchp-blue-bar"></div>
  <div class="mchp-main-bar mchp-green-bar"></div>
</div>
            
        </div>
        
        <div class="container-fluid" id="wh_topic_container">
            <div class="row">

                <nav class="wh_tools d-print-none navbar-expand-md" aria-label="Tools">
                    
                    <div data-tooltip-position="bottom" class=" wh_breadcrumb "><ol class="d-print-none"><li><span class="home"><a href="index.html"><span>Home</span></a></span></li><li><div class="topicref" data-id="GUID-2A54CAC1-1370-4448-8768-E6C7B8CFCA23"><div class="title"><a href="GUID-2A54CAC1-1370-4448-8768-E6C7B8CFCA23.html"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">5</ph>
Getting Started with Multiprotocol Applications</a><div class="wh-tooltip"><p class="shortdesc">This section  describes steps to test and develop the precompiled BLE and Zigbee         coexistence application examples.</p></div></div></div></li><li class="active"><div class="topicref" data-id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064"><div class="title"><a href="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064.html"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">5.1</ph>
Multiprotocol (BLE+ZIGBEE) Concurrent Application - Tutorial</a></div></div></li></ol></div>
                    
                    
                    
                    <div class="wh_right_tools">
                        <button class="wh_hide_highlight" aria-label="Toggle search highlights" title="Toggle search highlights"></button>
                        <button class="webhelp_expand_collapse_sections" data-next-state="collapsed" aria-label="Collapse sections" title="Collapse sections"></button>
                        
                        
                        
                        
                        <div class=" wh_print_link print d-none d-md-inline-block "><button onClick="window.print()" title="Print this page" aria-label="Print this page"></button></div>
                        
                        <button type="button" id="wh_toc_button" class="custom-toggler navbar-toggler collapsed wh_toggle_button navbar-light" aria-expanded="false" aria-label="Toggle publishing table of content" aria-controls="wh_publication_toc">
                            <span class="navbar-toggler-icon"></span>
                        </button>
                    </div>
                    
                </nav>
            </div>
            
            
            
            
            <div class="wh_content_area">
                <div class="row">
                    
                        <nav id="wh_publication_toc" class="col-lg-3 col-md-3 col-sm-12 d-md-block d-none d-print-none" aria-label="Table of Contents Container">
                            <div id="wh_publication_toc_content">
		                        
                            	<div class=" wh_publication_toc " data-tooltip-position="right"><span class="expand-button-action-labels"><span id="button-expand-action" role="button" aria-label="Expand"></span><span id="button-collapse-action" role="button" aria-label="Collapse"></span><span id="button-pending-action" role="button" aria-label="Pending"></span></span><ul role="tree" aria-label="Table of Contents"><li role="treeitem"><div data-tocid="GUID-7663617B-0DD1-45FA-86B5-EB0778A5A424-d1765e9" class="topicref introduction" data-id="GUID-7663617B-0DD1-45FA-86B5-EB0778A5A424" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="GUID-7663617B-0DD1-45FA-86B5-EB0778A5A424.html" id="GUID-7663617B-0DD1-45FA-86B5-EB0778A5A424-d1765e9-link">Introduction</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="GUID-4A40968E-8B6E-4C84-93B9-D31419BBBDA6-d1765e17" class="topicref" data-id="GUID-4A40968E-8B6E-4C84-93B9-D31419BBBDA6" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action GUID-4A40968E-8B6E-4C84-93B9-D31419BBBDA6-d1765e17-link" class="wh-expand-btn"></span><div class="title"><a href="GUID-4A40968E-8B6E-4C84-93B9-D31419BBBDA6.html" id="GUID-4A40968E-8B6E-4C84-93B9-D31419BBBDA6-d1765e17-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">1</ph>
Getting Started with WBZ451 Curiosity Board</a><div class="wh-tooltip"><p class="shortdesc">This section covers the evaluation board features and running the preprogrammed demo         example. </p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="GUID-2AD37FE2-1915-4E34-9A05-79E3810726D7-d1765e76" class="topicref" data-id="GUID-2AD37FE2-1915-4E34-9A05-79E3810726D7" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action GUID-2AD37FE2-1915-4E34-9A05-79E3810726D7-d1765e76-link" class="wh-expand-btn"></span><div class="title"><a href="GUID-2AD37FE2-1915-4E34-9A05-79E3810726D7.html" id="GUID-2AD37FE2-1915-4E34-9A05-79E3810726D7-d1765e76-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">2</ph>
Getting Started with Software Development</a><div class="wh-tooltip"><p class="shortdesc">This section gives a detailed information on the steps to install IDE, compiler, tool         chain, BLE, Zigbee stacks and application examples on the PC. </p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="GUID-3CC3561E-252E-43B9-BC8A-47DD108A0A46-d1765e161" class="topicref" data-id="GUID-3CC3561E-252E-43B9-BC8A-47DD108A0A46" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action GUID-3CC3561E-252E-43B9-BC8A-47DD108A0A46-d1765e161-link" class="wh-expand-btn"></span><div class="title"><a href="GUID-3CC3561E-252E-43B9-BC8A-47DD108A0A46.html" id="GUID-3CC3561E-252E-43B9-BC8A-47DD108A0A46-d1765e161-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">3</ph>
Bluetooth Low Energy Applications</a><div class="wh-tooltip"><p class="shortdesc">This section provides details on documentation describing the steps to test and develop         the precompiled BLE application examples. </p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="GUID-668A6CB2-F1FB-438D-9E1E-D67AC3C1C132-d1765e433" class="topicref" data-id="GUID-668A6CB2-F1FB-438D-9E1E-D67AC3C1C132" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action GUID-668A6CB2-F1FB-438D-9E1E-D67AC3C1C132-d1765e433-link" class="wh-expand-btn"></span><div class="title"><a href="GUID-668A6CB2-F1FB-438D-9E1E-D67AC3C1C132.html" id="GUID-668A6CB2-F1FB-438D-9E1E-D67AC3C1C132-d1765e433-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">4</ph>
Getting Started with Zigbee Applications</a></div></div></li><li role="treeitem" aria-expanded="true"><div data-tocid="GUID-2A54CAC1-1370-4448-8768-E6C7B8CFCA23-d1765e565" class="topicref" data-id="GUID-2A54CAC1-1370-4448-8768-E6C7B8CFCA23" data-state="expanded"><span role="button" tabindex="0" aria-labelledby="button-collapse-action GUID-2A54CAC1-1370-4448-8768-E6C7B8CFCA23-d1765e565-link" class="wh-expand-btn"></span><div class="title"><a href="GUID-2A54CAC1-1370-4448-8768-E6C7B8CFCA23.html" id="GUID-2A54CAC1-1370-4448-8768-E6C7B8CFCA23-d1765e565-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">5</ph>
Getting Started with Multiprotocol Applications</a><div class="wh-tooltip"><p class="shortdesc">This section  describes steps to test and develop the precompiled BLE and Zigbee         coexistence application examples.</p></div></div></div><ul role="group" class="navbar-nav nav-list"><li role="treeitem" class="active"><div data-tocid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064-d1765e576" class="topicref" data-id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064.html" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064-d1765e576-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">5.1</ph>
Multiprotocol (BLE+ZIGBEE) Concurrent Application - Tutorial</a></div></div></li><li role="treeitem"><div data-tocid="GUID-707BAEEE-0EFF-428F-AFEC-C2E6C5E65BA9-d1765e584" class="topicref" data-id="GUID-707BAEEE-0EFF-428F-AFEC-C2E6C5E65BA9" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="GUID-707BAEEE-0EFF-428F-AFEC-C2E6C5E65BA9.html" id="GUID-707BAEEE-0EFF-428F-AFEC-C2E6C5E65BA9-d1765e584-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">5.2</ph>
 Multiprotocol Application Demo: Zigbee Light and Zigbee Commissioning through BLE</a></div></div></li><li role="treeitem"><div data-tocid="GUID-CD3623AD-850D-4926-AE66-031692156BAB-d1765e592" class="topicref" data-id="GUID-CD3623AD-850D-4926-AE66-031692156BAB" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="GUID-CD3623AD-850D-4926-AE66-031692156BAB.html" id="GUID-CD3623AD-850D-4926-AE66-031692156BAB-d1765e592-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">5.3</ph>
Multiprotocol Device Firmware Upgrade over BLE Link</a></div></div></li><li role="treeitem"><div data-tocid="GUID-998705A8-0286-429C-B35C-0F5E95D94A3D-d1765e600" class="topicref" data-id="GUID-998705A8-0286-429C-B35C-0F5E95D94A3D" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="GUID-998705A8-0286-429C-B35C-0F5E95D94A3D.html" id="GUID-998705A8-0286-429C-B35C-0F5E95D94A3D-d1765e600-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">5.4</ph>
Zigbee Commissioning through BLE - Protocol Exchange</a></div></div></li><li role="treeitem"><div data-tocid="GUID-3D00CE26-A97E-44F4-9A17-A9CC112DAF43-d1765e608" class="topicref" data-id="GUID-3D00CE26-A97E-44F4-9A17-A9CC112DAF43" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="GUID-3D00CE26-A97E-44F4-9A17-A9CC112DAF43.html" id="GUID-3D00CE26-A97E-44F4-9A17-A9CC112DAF43-d1765e608-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">5.5</ph>
BLE ZigBee Provisioning Low Power Application Demo: Zigbee Multi-Sensor and Zigbee Commissioning through BLE</a></div></div></li></ul></li><li role="treeitem"><div data-tocid="GUID-64131DE4-2C60-4116-A206-EF72A41E71CE-d1765e616" class="topicref" data-id="GUID-64131DE4-2C60-4116-A206-EF72A41E71CE" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="GUID-64131DE4-2C60-4116-A206-EF72A41E71CE.html" id="GUID-64131DE4-2C60-4116-A206-EF72A41E71CE-d1765e616-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">6</ph>
Flashing hex from MPLAB DISCOVER using MPLAB IPE</a><div class="wh-tooltip"><p class="shortdesc">This section provides a detailed procedure of how to download an already existing     application hex file from MPLAB DISCOVER and flash the hex file into <span class="ph">WBZ451</span> Curiosity Board using MPLAB IPE.</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="GUID-3E242310-437D-4F50-9E63-3C9EF144CD18-d1765e630" class="topicref" data-id="GUID-3E242310-437D-4F50-9E63-3C9EF144CD18" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action GUID-3E242310-437D-4F50-9E63-3C9EF144CD18-d1765e630-link" class="wh-expand-btn"></span><div class="title"><a href="GUID-3E242310-437D-4F50-9E63-3C9EF144CD18.html" id="GUID-3E242310-437D-4F50-9E63-3C9EF144CD18-d1765e630-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">7</ph>
 Getting Started with IEEE 802.15.4 P2P Phy Application</a></div></div></li><li role="treeitem"><div data-tocid="GUID-5C1924BD-FC6E-4FD5-9786-55FDC1B4035A-d1765e686" class="topicref" data-id="GUID-5C1924BD-FC6E-4FD5-9786-55FDC1B4035A" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="GUID-5C1924BD-FC6E-4FD5-9786-55FDC1B4035A.html" id="GUID-5C1924BD-FC6E-4FD5-9786-55FDC1B4035A-d1765e686-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">8</ph>
Getting Started with IEEE 802.15.4 MAC Applications</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="GUID-B9333775-2F34-4B60-9429-E1B1B7F505FD-d1765e694" class="topicref" data-id="GUID-B9333775-2F34-4B60-9429-E1B1B7F505FD" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action GUID-B9333775-2F34-4B60-9429-E1B1B7F505FD-d1765e694-link" class="wh-expand-btn"></span><div class="title"><a href="GUID-B9333775-2F34-4B60-9429-E1B1B7F505FD.html" id="GUID-B9333775-2F34-4B60-9429-E1B1B7F505FD-d1765e694-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">9</ph>
Adding Chip Peripherals</a><div class="wh-tooltip"><p class="shortdesc">This section describes how to add analog/digital peripherals to the                                         application</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="GUID-38BBA2DC-AE28-4500-BCC9-0FEFC317CF04-d1765e737" class="topicref" data-id="GUID-38BBA2DC-AE28-4500-BCC9-0FEFC317CF04" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action GUID-38BBA2DC-AE28-4500-BCC9-0FEFC317CF04-d1765e737-link" class="wh-expand-btn"></span><div class="title"><a href="GUID-38BBA2DC-AE28-4500-BCC9-0FEFC317CF04.html" id="GUID-38BBA2DC-AE28-4500-BCC9-0FEFC317CF04-d1765e737-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">10</ph>
Thread Applications</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="GUID-F9A40E74-7127-4C2C-B480-2746007AAEAE-d1765e801" class="topicref" data-id="GUID-F9A40E74-7127-4C2C-B480-2746007AAEAE" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action GUID-F9A40E74-7127-4C2C-B480-2746007AAEAE-d1765e801-link" class="wh-expand-btn"></span><div class="title"><a href="GUID-F9A40E74-7127-4C2C-B480-2746007AAEAE.html" id="GUID-F9A40E74-7127-4C2C-B480-2746007AAEAE-d1765e801-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">11</ph>
Low Power Design</a><div class="wh-tooltip"><p class="shortdesc">This section explains in detail on how to enable the low power modes –             <span class="ph instanceOffsets">Sleep/Standby or Deep Sleep/Backup modes in the             design.</span></p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="GUID-D7A53CEA-74B4-4CAA-A5D4-F69980188D1B-d1765e832" class="topicref" data-id="GUID-D7A53CEA-74B4-4CAA-A5D4-F69980188D1B" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action GUID-D7A53CEA-74B4-4CAA-A5D4-F69980188D1B-d1765e832-link" class="wh-expand-btn"></span><div class="title"><a href="GUID-D7A53CEA-74B4-4CAA-A5D4-F69980188D1B.html" id="GUID-D7A53CEA-74B4-4CAA-A5D4-F69980188D1B-d1765e832-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">12</ph>
Firmware and OTA Updates</a><div class="wh-tooltip"><p class="shortdesc">This section documents how to enable firmware updates in the design, whether it is serial         or Over The Air (OTA)</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="GUID-E1A30ECC-1212-4B25-AE72-7EAF982C6D50-d1765e1231" class="topicref" data-id="GUID-E1A30ECC-1212-4B25-AE72-7EAF982C6D50" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action GUID-E1A30ECC-1212-4B25-AE72-7EAF982C6D50-d1765e1231-link" class="wh-expand-btn"></span><div class="title"><a href="GUID-E1A30ECC-1212-4B25-AE72-7EAF982C6D50.html" id="GUID-E1A30ECC-1212-4B25-AE72-7EAF982C6D50-d1765e1231-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">13</ph>
Wireless System Services API</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="GUID-5FC6D5A2-B8C3-4AD8-AC31-0AABE237A2F7-d1765e1920" class="topicref" data-id="GUID-5FC6D5A2-B8C3-4AD8-AC31-0AABE237A2F7" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action GUID-5FC6D5A2-B8C3-4AD8-AC31-0AABE237A2F7-d1765e1920-link" class="wh-expand-btn"></span><div class="title"><a href="GUID-5FC6D5A2-B8C3-4AD8-AC31-0AABE237A2F7.html" id="GUID-5FC6D5A2-B8C3-4AD8-AC31-0AABE237A2F7-d1765e1920-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">14</ph>
Support Documentation</a><div class="wh-tooltip"><p class="shortdesc">This section has documentation that is generic and used as supporting document with the         application example documentation. </p></div></div></div></li><li role="treeitem"><div data-tocid="GUID-BA0204D8-EFF0-4932-830D-73E2A72614A0-d1765e1957" class="topicref" data-id="GUID-BA0204D8-EFF0-4932-830D-73E2A72614A0" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="GUID-BA0204D8-EFF0-4932-830D-73E2A72614A0.html" id="GUID-BA0204D8-EFF0-4932-830D-73E2A72614A0-d1765e1957-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">15</ph>
Porting Guide for WBZ451 to PIC32CX1012BZ25048</a></div></div></li><li role="treeitem"><div data-tocid="GUID-A1E48517-2E8D-4E14-B1BB-B3541DB0DA27-d1765e1965" class="topicref" data-id="GUID-A1E48517-2E8D-4E14-B1BB-B3541DB0DA27" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="GUID-A1E48517-2E8D-4E14-B1BB-B3541DB0DA27.html" id="GUID-A1E48517-2E8D-4E14-B1BB-B3541DB0DA27-d1765e1965-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">16</ph>
Porting Guide for WBZ451 to WBZ450</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="GUID-0FB3F908-88EE-45CE-94F5-E97AF9049C9B-d1765e1973" class="topicref backmatter backmatter_parent" data-id="GUID-0FB3F908-88EE-45CE-94F5-E97AF9049C9B" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action GUID-0FB3F908-88EE-45CE-94F5-E97AF9049C9B-d1765e1973-link" class="wh-expand-btn"></span><div class="title"><a href="GUID-0FB3F908-88EE-45CE-94F5-E97AF9049C9B.html" id="GUID-0FB3F908-88EE-45CE-94F5-E97AF9049C9B-d1765e1973-link">Microchip Information</a></div></div></li></ul></div>
		                        
                            </div>
                        </nav>
                    
                    
                    <div class="col-lg-7 col-md-9 col-sm-12" id="wh_topic_body">
                        <button id="wh_close_publication_toc_button" class="close-toc-button d-none" aria-label="Toggle publishing table of content" aria-controls="wh_publication_toc" aria-expanded="true">
                            <span class="close-toc-icon-container">
                                <span class="close-toc-icon"></span>     
                            </span>
                        </button>
                        <button id="wh_close_topic_toc_button" class="close-toc-button d-none" aria-label="Toggle topic table of content" aria-controls="wh_topic_toc" aria-expanded="true">
                            <span class="close-toc-icon-container">
                                <span class="close-toc-icon"></span>     
                            </span>
                        </button>
                        
                        <div class=" wh_topic_content body "><main role="main"><article role="article" aria-labelledby="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-653CE1B0-6179-4CF8-82B3-BA8D0855BB65"><h1 class="- topic/title title topictitle1" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-653CE1B0-6179-4CF8-82B3-BA8D0855BB65" style="">5.1 Multiprotocol (BLE+ZIGBEE) Concurrent Application - Tutorial</h1><div class="- topic/body body"><p class="- topic/p p">This tutorial explains to the users on how create multiprotocol (BLE and ZIGBEE) example project
            using Mplab code configurator. The step by step procedure will help the user to generate
            the multiprotocol project from scratch and will guide in understanding few API calls
            needed for data transaction between 2 protocols.</p><p class="- topic/p p">The project created at end of this tutorial, will look the sample project available here .</p><section class="- topic/section section" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__HARDWARE-REQUIRED" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__HARDWARE-REQUIRED"><h2 class="- topic/title title sectiontitle">Hardware Requirement</h2><div class="table-container"><table class="- topic/table table" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-E0402AE1-10FD-4FE8-8E32-055F9342F535" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-E0402AE1-10FD-4FE8-8E32-055F9342F535" data-cols="2"><caption></caption><colgroup><col/><col/></colgroup><thead class="- topic/thead thead"><tr class="- topic/row"><th class="- topic/entry entry colsep-0 rowsep-0" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-E0402AE1-10FD-4FE8-8E32-055F9342F535__entry__1"> <strong class="+ topic/ph hi-d/b ph b">Tool</strong></th><th class="- topic/entry entry colsep-0 rowsep-0" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-E0402AE1-10FD-4FE8-8E32-055F9342F535__entry__2"> <strong class="+ topic/ph hi-d/b ph b">Qty</strong></th></tr></thead><tbody class="- topic/tbody tbody"><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-E0402AE1-10FD-4FE8-8E32-055F9342F535__entry__1"><span class="- topic/ph ph">WBZ451</span> Curiosity Board</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-E0402AE1-10FD-4FE8-8E32-055F9342F535__entry__2">2</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-E0402AE1-10FD-4FE8-8E32-055F9342F535__entry__1">Micro USB cable</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-E0402AE1-10FD-4FE8-8E32-055F9342F535__entry__2">2</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-E0402AE1-10FD-4FE8-8E32-055F9342F535__entry__1">Android/iOS Mobile</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-E0402AE1-10FD-4FE8-8E32-055F9342F535__entry__2">1</td></tr></tbody></table></div></section><section class="- topic/section section" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__SDK-SETUP" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__SDK-SETUP"><h2 class="- topic/title title sectiontitle">SDK Setup</h2><p class="- topic/p p"> <a class="- topic/xref xref" href="GUID-2AD37FE2-1915-4E34-9A05-79E3810726D7.html" title="This section gives a detailed information on the steps to install IDE, compiler, tool chain, BLE, Zigbee stacks and application examples on the PC.">SDK Setup</a></p></section><section class="- topic/section section" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__SOFTWARE" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__SOFTWARE"><h2 class="- topic/title title sectiontitle">Software Requirement</h2><p class="- topic/p p"> <a class="- topic/xref xref" href="https://ttssh2.osdn.jp/index.html.en" target="_blank" rel="external noopener">TeraTerm</a></p></section><section class="- topic/section section" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__SMARTPHONE-APP" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__SMARTPHONE-APP"><h2 class="- topic/title title sectiontitle">Smartphone App</h2><p class="- topic/p p">Microchip Bluetooth Data (MBD) iOS/Android app available in stores</p></section><section class="- topic/section section" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__DEMO-DESCRIPTION" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__DEMO-DESCRIPTION"><h2 class="- topic/title title sectiontitle">Demo Description</h2><p class="- topic/p p">This application demonstrate the Zigbee On/Off light joining to Zigbee gateway (Combined Interface) and the Microchip Proprietary Transparent Service based BLE peripheral running concurrently with zigbee protocol connects with mobile app. When the Zigbee light gets the light on/off command from CI will be displayed in mobile app. Hence the simple concurrent operation of multiprotocol is demonstrated here. Lights and Bridge (CI) devices are the interest of this tutorial, where the WIFI/Ethernet gateway is not scope of this application. The third party gateway like Amazon Echo plus can also be used instead of CI.</p><div class=""><img class="- topic/image image break break" src="GUID-F77964E0-46D6-44BD-A53F-9A31892870FF-high.png"/></div></section><section class="- topic/section section" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__DEVELOPING-THIS-APPLICATION-FROM-SCRATCH-USING-MPLAB-CODE-CONFIGURATOR" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__DEVELOPING-THIS-APPLICATION-FROM-SCRATCH-USING-MPLAB-CODE-CONFIGURATOR"><h2 class="- topic/title title sectiontitle">Developing the Application from Scratch using
                MPLab Code Configurator</h2><p class="- topic/p p">The following steps will help to understand the <span class="- topic/ph ph">PIC32CXBZ2</span> device ZIGBEE and BLE stack programming structure. We recommend to follow the steps. If wish to have Out-of-Box experience with the precompiled hex file Go Here</p></section><section class="- topic/section section" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__PULL-IN-H3-COMPONENTS" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__PULL-IN-H3-COMPONENTS"><h2 class="- topic/title title sectiontitle">Pull-in MCC Components</h2><ul class="- topic/ul ul"><li class="- topic/li li" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-AEE0CF5D-9E47-43E7-9A41-CB0CD9FE51C7" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-AEE0CF5D-9E47-43E7-9A41-CB0CD9FE51C7"><p class="- topic/p p">Create a new MPLAB Code Configurator Project. Follow the instructions mentioned in <a class="- topic/xref xref" href="GUID-B86E8493-D00D-46EF-8624-D412342147F0.html"><span><span>2.5 </span><span>Creating a New MCC Harmony Project</span></span></a> .</p></li><li class="- topic/li li" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-13FC328C-DFCD-4806-9B70-984EFE9906A4" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-13FC328C-DFCD-4806-9B70-984EFE9906A4"><p class="- topic/p p">Drag and Drop the Zigbee components from "Available" components to Project Graph</p><ul class="- topic/ul ul"><li class="- topic/li li" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-0823CFC6-326A-4688-8515-44298ABDCAF9" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-0823CFC6-326A-4688-8515-44298ABDCAF9"><p class="- topic/p p">OnOffLight Device component</p></li></ul><p class="- topic/p p">"Accept Dependencies or satisfiers, select "Yes""</p></li></ul><div class=""><img class="- topic/image image" src="GUID-CB3F5A27-899A-4DAE-A20B-D6BA0256C1B9-high.png"/></div><div class=""><img class="- topic/image image" src="GUID-2587431C-3EBD-4357-A62B-DCF7830F17B7-high.png"/></div><ul class="- topic/ul ul"><li class="- topic/li li" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-640ADB8F-85CC-4D40-99C9-CDD69107E2F5" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-640ADB8F-85CC-4D40-99C9-CDD69107E2F5"><p class="- topic/p p">Drag and Drop the BLE components</p><ul class="- topic/ul ul"><li class="- topic/li li" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-C8A065DC-87F0-4282-9983-3783B31E375A" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-C8A065DC-87F0-4282-9983-3783B31E375A"><p class="- topic/p p">BLE Stack component</p></li></ul></li></ul><div class=""><img class="- topic/image image" src="GUID-48BA10E0-BF46-4A57-8480-FE142E46B008-high.png"/></div><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>- Transparent Profile and Service components

 "Add  Dependencies or satisfiers"
</code></pre><div class=""><img class="- topic/image image" src="GUID-5261D052-7132-438C-AFCE-2D17D513C50A-high.png"/></div><ul class="- topic/ul ul"><li class="- topic/li li" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-B93FBDEA-0BE8-4402-B8BD-04B6D08B56AB" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-B93FBDEA-0BE8-4402-B8BD-04B6D08B56AB"><p class="- topic/p p">Add UART components needed for console logs</p></li></ul><div class=""><img class="- topic/image image" src="GUID-F6F71066-F292-449D-B24D-6CA7F564F23C-high.png"/></div><ul class="- topic/ul ul"><li class="- topic/li li" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-A15664F4-3B37-46FB-82F9-3A01357C90AF" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-A15664F4-3B37-46FB-82F9-3A01357C90AF"><p class="- topic/p p">Verify the Project Graph window has all the expected components</p></li></ul><div class=""><img class="- topic/image image" src="GUID-C1BAE3D2-CBAA-4DD7-BDD4-B1B2BC6C6F4B-high.png"/></div></section><section class="- topic/section section" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__EDIT-BLE-STACK-SPECIFIC-CONFIGURATIONS" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__EDIT-BLE-STACK-SPECIFIC-CONFIGURATIONS"><h2 class="- topic/title title sectiontitle">Edit BLE Stack Specific Configurations</h2><ul class="- topic/ul ul"><li class="- topic/li li" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-D81B883F-70A8-4E55-AE03-5EAD10D65EE5" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-D81B883F-70A8-4E55-AE03-5EAD10D65EE5"><p class="- topic/p p">Select <strong class="+ topic/ph hi-d/b ph b">BLE_Stack</strong> component in project graph and edit as below</p></li></ul><div class=""><img class="- topic/image image" src="GUID-88003D8C-9FD2-4374-BBCB-4E71D38D6858-high.png"/></div><ul class="- topic/ul ul"><li class="- topic/li li" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-C4564168-6194-4EA0-B035-816CCA781973" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-C4564168-6194-4EA0-B035-816CCA781973"><p class="- topic/p p">Select <strong class="+ topic/ph hi-d/b ph b">Transparent Profile</strong> component in project graph and edit as below.</p></li></ul><div class=""><img class="- topic/image image" src="GUID-D6120FDC-F032-4877-9CA9-6999E37400F4-high.png"/></div></section><section class="- topic/section section" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__EDIT-ZIGBEE-STACK-SPECIFIC-CONFIGURATIONS" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__EDIT-ZIGBEE-STACK-SPECIFIC-CONFIGURATIONS"><h2 class="- topic/title title sectiontitle">Edit Zigbee Stack Specific Configurations</h2><ul class="- topic/ul ul"><li class="- topic/li li" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-8C4635F1-D166-4A28-B79E-E76897A61A2B" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-8C4635F1-D166-4A28-B79E-E76897A61A2B"><p class="- topic/p p">Edit <strong class="+ topic/ph hi-d/b ph b">Onoff Light</strong> component in project graph. The "Commissioning Configuration" is edited to enable only Steering option</p></li></ul><div class=""><img class="- topic/image image" src="GUID-FA281534-F32F-4C5A-A830-C86515D46BAC-high.png"/></div></section><section class="- topic/section section" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__EDIT-PERIPHERAL-SPECIFIC-CONFIGURATIONS" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__EDIT-PERIPHERAL-SPECIFIC-CONFIGURATIONS"><h2 class="- topic/title title sectiontitle">Edit Peripheral Specific Configurations</h2><ul class="- topic/ul ul"><li class="- topic/li li" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-2E06101B-7744-4A69-8D45-C79A1BC6EFA3" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-2E06101B-7744-4A69-8D45-C79A1BC6EFA3"><p class="- topic/p p">Edit <strong class="+ topic/ph hi-d/b ph b">SERCOM0</strong> component in project graph for UART pin map and Baud rate</p></li></ul><div class=""><img class="- topic/image image" src="GUID-0F04E2D6-4678-4F4B-A699-8F7B624D138F-high.png"/></div><ul class="- topic/ul ul"><li class="- topic/li li" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-24EBA8D0-B75B-42B7-A526-4AE5D96986D8" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-24EBA8D0-B75B-42B7-A526-4AE5D96986D8"><p class="- topic/p p">Edit <strong class="+ topic/ph hi-d/b ph b">Pin Configuration</strong> in project graph for RED LED GPIO configuration</p></li></ul><div class=""><img class="- topic/image image" src="GUID-7E100586-3D75-4457-B641-419F4615C978-high.png"/></div></section><section class="- topic/section section" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GENERATE-CODE-LINK-FOR-INSTRUCTIONS" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GENERATE-CODE-LINK-FOR-INSTRUCTIONS"><h2 class="- topic/title title sectiontitle">Generate Code link for instructions</h2></section><section class="- topic/section section" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__FILES-AND-ROUTINES-AUTOMATICALLY-GENERATED-BY-THE-MHC" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__FILES-AND-ROUTINES-AUTOMATICALLY-GENERATED-BY-THE-MHC"><h2 class="- topic/title title sectiontitle">Files and Routines Automatically
                Generated by the MCC</h2><p class="- topic/p p">After generating the code from MCC interface by
                clicking Generate Code, below is the project folder structure.</p><div class=""><img class="- topic/image image" src="GUID-76411F1D-A6F2-4BFE-90BD-CAF1E6079E60-high.png"/></div><ol class="- topic/ol ol" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-D64C5FF7-61C9-4921-B710-2C5E1ABCF889" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-D64C5FF7-61C9-4921-B710-2C5E1ABCF889">
                <li class="- topic/li li" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-CF5CFFE1-4CA7-40AA-9B6D-344EBE4D4830" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-CF5CFFE1-4CA7-40AA-9B6D-344EBE4D4830">
                    <p class="- topic/p p">BLE, Zigbee Stack Initialization and Application callback registration:</p>
                </li>
            </ol><p class="- topic/p p">The RF System, BLE System, ZIGBEE, PERIPHERAL initialization routine executed
                during program initialization can be found in <strong class="+ topic/ph hi-d/b ph b">SYS_Initialize()</strong> of
                    <strong class="+ topic/ph hi-d/b ph b">initialization.c</strong> file</p><p class="- topic/p p">Zigbee Stack provides various APIs for
                application, and those APIs belong to the specific module within dedicated group.
                The sequence of initialization is already taken care in the stack when
                    <strong class="+ topic/ph hi-d/b ph b">Zigbee_Init()</strong> from <strong class="+ topic/ph hi-d/b ph b">initialization.c</strong> is called.</p><div class=""><img class="- topic/image image" src="GUID-0A8E8C62-2382-47AE-B683-8CC6BAA6C8E4-high.png"/></div><p class="- topic/p p">The BLE stack
                initialization routine executed during Application Initialization can be found in
                    <strong class="+ topic/ph hi-d/b ph b">APP_BleStackInit()</strong> in <strong class="+ topic/ph hi-d/b ph b">app.c</strong>. This call initializes and configures
                different BLE layers like GAP, GATT, SMP, L2CAP and BLE middleware layers and
                registers the application layer callbacks. The event callbacks from BLE stack, BLE
                middleware and Profile/service layer are registered.</p><p class="- topic/p p">Also, the MCC configured
                advertisement data payload can be seen in <strong class="+ topic/ph hi-d/b ph b">APP_BleConfigBasic()</strong></p><div class=""><img class="- topic/image image" src="GUID-4582B1DA-1C58-4F46-8B23-DB7E963CEEBC-high.png"/></div><p class="- topic/p p">Similar to BLE,
                Zigbee Stack also generate events to inform application if there is any status
                changed or activity. Application may need to get the relevant information from
                Zigbee Stack and do the corresponding procedure.</p><div class=""><img class="- topic/image image" src="GUID-22BCB827-B425-421F-AAA0-888251A17B38-high.png"/></div><ol class="- topic/ol ol" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-FC5ADF35-A751-4769-B32C-4DB61DF1FF93" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-FC5ADF35-A751-4769-B32C-4DB61DF1FF93">
                <li class="- topic/li li" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-E7BEA253-62F3-45AD-A2E9-9EE41DC74059" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-E7BEA253-62F3-45AD-A2E9-9EE41DC74059">
                    <p class="- topic/p p">BLE, Zigbee Stack application events handling: <strong class="+ topic/ph hi-d/b ph b">app.c</strong> file is
                        autogenerated and has a state machine for application callback handling from
                        BLE, Zigbee stacks</p>
                </li>
            </ol><div class=""><img class="- topic/image image" src="GUID-7FB8A493-0D28-4A38-B972-12F181ACC370-high.png"/></div></section><section class="- topic/section section" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__USER-APPLICATION-DEVELOPMENT" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__USER-APPLICATION-DEVELOPMENT"><h2 class="- topic/title title sectiontitle">User Application Development</h2><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">1. Compile MCC auto generated project</strong></p><ol class="- topic/ol ol" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-A0083FB0-BA23-412A-8B72-1BFB3557AA28" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-A0083FB0-BA23-412A-8B72-1BFB3557AA28"><li class="- topic/li li" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-60A67517-783A-4AE9-95BD-C58D6FE0AB69" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-60A67517-783A-4AE9-95BD-C58D6FE0AB69"><p class="- topic/p p">Compile the MCC auto generated project as below</p></li></ol><div class=""><img class="- topic/image image break break" src="GUID-56046397-1FDA-421E-8264-85EA0AFDBF5C-high.png"/></div><div class=""><img class="- topic/image image" src="GUID-624BC4FE-BA09-4D26-B4C5-DAB4DA44E793-high.png"/></div><ol class="- topic/ol ol" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-36E20D52-DFEB-43EC-9BD4-C78DFFD4F542" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-36E20D52-DFEB-43EC-9BD4-C78DFFD4F542"><li class="- topic/li li" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-1E7D6E33-EA14-4AB3-B3DD-43D2BCBBD45B" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-1E7D6E33-EA14-4AB3-B3DD-43D2BCBBD45B"><p class="- topic/p p">Addressing the mandatory error: User action required in app_idle_task.c. Follow the steps mentioned in the note and do the necessary changes. Then comment the <strong class="+ topic/ph hi-d/b ph b">#error</strong> message as below.</p></li></ol><div class=""><img class="- topic/image image" src="GUID-5B0478C1-3575-448F-838E-4FDFFBA414B5-high.png"/></div><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">2. BLE specific code addition</strong></p><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">1. Start Advertisement (app.c)</strong></p><p class="- topic/p p">Advertisement payload is already auto generated based on MCC configuration as mentioned in Edit BLE Stack Specific Configurations. It is only required to start the advertisement, by adding the below API in APP_STATE_INIT state.</p><ul class="- topic/ul ul"><li class="- topic/li li" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-F5FCE77E-BA3C-4C95-B2D6-2B9F6AA07A38" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-F5FCE77E-BA3C-4C95-B2D6-2B9F6AA07A38"><p class="- topic/p p">BLE_GAP_SetAdvEnable(true, 0);</p></li></ul><pre class="+ topic/pre pr-d/codeblock pre codeblock json">void APP_Tasks ( void )
{
    APP_Msg_T    appMsg[<span class="hl-number">1</span>];
    APP_Msg_T   *p_appMsg;
    p_appMsg=appMsg;

    ZB_AppGenericCallbackParam_t cb;
    <em class="hl-comment">/* Check the application's current state. */</em>
    switch ( appData.state )
    {
        <em class="hl-comment">/* Application's initial state. */</em>
        case APP_STATE_INIT:
        {
            bool appInitialized = true;
            <em class="hl-comment">//appData.appQueue = xQueueCreate( 10, sizeof(APP_Msg_T) );</em>
            APP_BleStackInit();
            BLE_GAP_SetAdvEnable(true, <span class="hl-number">0</span>);</pre><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">2. Connected &amp; Disconnected Events (app_ble_handler.c)</strong></p><p class="- topic/p p">The BLE application specific callbacks from BLE stack is handled in <strong class="+ topic/ph hi-d/b ph b">app_ble_handler.c</strong> file. Few events needed for this application to be handled by the user code as below.</p><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">Connection Handler</strong></p><ul class="- topic/ul ul"><li class="- topic/li li" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-9ED43873-987E-48D0-87D4-7C44150C7863" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-9ED43873-987E-48D0-87D4-7C44150C7863"><p class="- topic/p p">In <strong class="+ topic/ph hi-d/b ph b">app_ble_handler.c</strong>, BLE_GAP_EVT_CONNECTED event will be generated when a BLE peripheral is connected with Central (mobile app)</p></li><li class="- topic/li li" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-CA6EF885-EB50-469E-B13B-BE08662B616E" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-CA6EF885-EB50-469E-B13B-BE08662B616E"><p class="- topic/p p">Connection handle associated with the peer central device needs to be saved for data exchange after a BLE connection. Add the below code in <strong class="+ topic/ph hi-d/b ph b">APP_BleGapEvtHandler()</strong>.</p></li><li class="- topic/li li" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-BA2698C8-04CA-4171-A2E4-621D9C94A59C" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-BA2698C8-04CA-4171-A2E4-621D9C94A59C"><p class="- topic/p p">Console log is also added to print the connected message and respective #include file is also added.</p></li></ul><pre class="+ topic/pre pr-d/codeblock pre codeblock json">#include &lt;app_zigbee/zigbee_console/console.h&gt;

void APP_BleGapEvtHandler(BLE_GAP_Event_T *p_event)
{
    switch(p_event-&gt;eventId)
    {
        case BLE_GAP_EVT_CONNECTED:
        {
            <em class="hl-comment">/* TODO: implement your application code.*/</em>
            appSnprintf(<span class="hl-string">"[BLE} Connected\n\r"</span>);
            conn_hdl = p_event-&gt;eventField.evtConnect.connHandle;
            linkState = APP_BLE_STATE_CONNECTED;
        }
        break;</pre><ul class="- topic/ul ul"><li class="- topic/li li" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-C2F78A73-7866-4654-AFB4-FE619AD5C454" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-C2F78A73-7866-4654-AFB4-FE619AD5C454"><p class="- topic/p p">In <strong class="+ topic/ph hi-d/b ph b">app_ble_handler.h</strong> add the below definitions which are used in above step</p></li></ul><pre class="+ topic/pre pr-d/codeblock pre codeblock json"><em class="hl-comment">// *****************************************************************************</em>
<em class="hl-comment">// *****************************************************************************</em>
<em class="hl-comment">// Section: Type Definitions</em>
<em class="hl-comment">// *****************************************************************************</em>
<em class="hl-comment">// *****************************************************************************</em>
uint16_t conn_hdl;
uint8_t linkState;

#define APP_BLE_STATE_CONNECTED <span class="hl-number">0x01</span>
#define APP_BLE_STATE_STANDBY  <span class="hl-number">0x00</span></pre><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">Disconnection Handler</strong></p><ul class="- topic/ul ul"><li class="- topic/li li" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-A0309B50-CF92-4407-8FB4-0BC55FD7A014" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-A0309B50-CF92-4407-8FB4-0BC55FD7A014"><p class="- topic/p p">In <strong class="+ topic/ph hi-d/b ph b">app_ble_handler.c</strong>, BLE_GAP_EVT_DISCONNECTED event will be generated when BLE peripheral is disconnected from Central (mobile app)</p></li><li class="- topic/li li" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-4C26B41F-C8C6-4D21-AF1A-5D8DEDA769ED" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-4C26B41F-C8C6-4D21-AF1A-5D8DEDA769ED"><p class="- topic/p p">Advertisement can be started again to enable another connection</p></li><li class="- topic/li li" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-6B80AAB9-D80B-4859-8A46-A6C4BFC1F9FF" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-6B80AAB9-D80B-4859-8A46-A6C4BFC1F9FF"><p class="- topic/p p">Console log is also added to print the disconnected message</p></li></ul><pre class="+ topic/pre pr-d/codeblock pre codeblock json">case BLE_GAP_EVT_DISCONNECTED:
{
    <em class="hl-comment">/* TODO: implement your application code.*/</em>
    appSnprintf(<span class="hl-string">"[BLE} DisConnected\n\r"</span>);
    BLE_GAP_SetAdvEnable(true, <span class="hl-number">0</span>);
    linkState = APP_BLE_STATE_STANDBY;               
}
break;</pre><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">3. Zigbee specific code addition (app_zigbee_handler.c)</strong></p><p class="- topic/p p">There will be 3 major events which the stack would provide to the user application in <strong class="+ topic/ph hi-d/b ph b">app_zigbee_handler.c</strong> file. They are ,</p><ul class="- topic/ul ul"><li class="- topic/li li" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-ED88ED94-0CF1-4FBF-95B6-A43125D89E60" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-ED88ED94-0CF1-4FBF-95B6-A43125D89E60"><p class="- topic/p p">Zigbee Events which is defined as "EVENT_ZIGBEE"</p></li><li class="- topic/li li" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-CB329CF3-6A1B-41B9-B3DA-4609278C37C7" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-CB329CF3-6A1B-41B9-B3DA-4609278C37C7"><p class="- topic/p p">ZCL and Cluster Events defined as "EVENT_CLUSTER"</p></li><li class="- topic/li li" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-59ACB48D-0001-4362-8D6D-35B20BBB7168" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-59ACB48D-0001-4362-8D6D-35B20BBB7168"><p class="- topic/p p">Board Specific Package (BSP) Events defined as "EVENT_BSP"</p></li></ul><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">1. ZCL EVENT_CLUSTER event handling for on/off Light cluster</strong></p><p class="- topic/p p"> <strong class="+ topic/ph hi-d/b ph b">ZCL (Zigbee cluster library)</strong></p><ul class="- topic/ul ul"><li class="- topic/li li" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-B91FA471-D1F0-4BC7-89C1-C065AEA060ED" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-B91FA471-D1F0-4BC7-89C1-C065AEA060ED"><p class="- topic/p p">ZCL is a repository for cluster functionalities</p></li><li class="- topic/li li" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-5249A33F-0171-46F3-A678-67DB0F674462" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-5249A33F-0171-46F3-A678-67DB0F674462"><p class="- topic/p p">Regularly updated with new functionality added</p></li><li class="- topic/li li" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-A55B4679-1525-4DBF-8D4C-DC1C9CE9305E" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-A55B4679-1525-4DBF-8D4C-DC1C9CE9305E"><p class="- topic/p p">Not to “re-invent the wheel” for new application development</p></li></ul><p class="- topic/p p"> <strong class="+ topic/ph hi-d/b ph b">Cluster</strong></p><ul class="- topic/ul ul"><li class="- topic/li li" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-C53A6D88-AFEB-433B-9DAE-BC6543621FEF" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-C53A6D88-AFEB-433B-9DAE-BC6543621FEF"><p class="- topic/p p">Cluster is a set of attributes and commands which are defined for a particular application functionality/feature.</p></li><li class="- topic/li li" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-A1F70403-3BFB-414F-A2BF-8C2AE90CC520" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-A1F70403-3BFB-414F-A2BF-8C2AE90CC520"><p class="- topic/p p">Attributes and their data types are defined</p></li><li class="- topic/li li" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-EAFB96ED-BB4D-4E41-B58D-3F0353E34CDC" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-EAFB96ED-BB4D-4E41-B58D-3F0353E34CDC"><p class="- topic/p p">Uses client/server model of communication</p></li><li class="- topic/li li" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-EE291F03-02D1-47D9-9C90-2BB3AEF6CCE7" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-EE291F03-02D1-47D9-9C90-2BB3AEF6CCE7"><p class="- topic/p p">Standard commands/messages ensure interoperability, abstracts the commands for developers.</p></li></ul><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">Ex: On/Off cluster</strong> Attributes: OnOff, OnTime, OffWaitTime Commands: Off, On, Toggle, OffWithEffect, OnWithRecallGlobalScene, OnWithTimedOff</p> <span class="- topic/ph ph icon icon-search inline-block highlight-info"> <em class="+ topic/ph hi-d/i ph i">-Explore</em> </span><p class="- topic/p p">For more details regarding clusters, please refer to, the specification from Zigbee Alliance -&gt; <a class="- topic/xref xref" href="https://zigbeealliance.org/wp-content/uploads/2019/12/07-5123-06-zigbee-cluster-library-specification.pdf" target="_blank" rel="external noopener">Link to Zigbee Cluster Library Specification by Zigbee Alliance</a></p><p class="- topic/p p">This project uses On/Off device type. Hence uses <strong class="+ topic/ph hi-d/b ph b">On/Off light cluster</strong> from Zigbee defined cluster library. When the On/Off command to control the light is received from Combined Interface gateway, CMD_ZCL_ON, CMD_ZCL_OFF of ZCL EVENT_CLUSTER will be received on light device. A simple console print is already added in those event callbacks as below.</p><pre class="+ topic/pre pr-d/codeblock pre codeblock json">void Cluster_Event_Handler(APP_Zigbee_Event_t event)
{
    switch(event.eventId)
    {
        case CMD_ZCL_ON:
        {
            <em class="hl-comment">/* ZCL Command ON received */</em>
            <em class="hl-comment">//Access - &gt; event.eventData.zclEventData.addressing;</em>
            <em class="hl-comment">//Access - &gt; event.eventData.zclEventData.payloadLength;</em>
            <em class="hl-comment">//Access - &gt; event.eventData.zclEventData.payload;</em>
            appSnprintf(<span class="hl-string">"On\r\n"</span>);
            uint8_t onCmd;
            onCmd = <span class="hl-number">0x01</span>;
            
            if(linkState == APP_BLE_STATE_CONNECTED)
                BLE_TRSPS_SendVendorCommand(conn_hdl, <span class="hl-number">0x8F</span>, <span class="hl-number">0x01</span>, &amp;onCmd);            
        }
        break;
        case CMD_ZCL_OFF:
        {
            <em class="hl-comment">/* ZCL Command Off received */</em>
            <em class="hl-comment">//Access - &gt; event.eventData.zclEventData.addressing;</em>
            <em class="hl-comment">//Access - &gt; event.eventData.zclEventData.payloadLength;</em>
            <em class="hl-comment">//Access - &gt; event.eventData.zclEventData.payload;</em>
            appSnprintf(<span class="hl-string">"Off\r\n"</span>);
            uint8_t offCmd;
            offCmd = <span class="hl-number">0x00</span>;
            
            if(linkState == APP_BLE_STATE_CONNECTED)
                BLE_TRSPS_SendVendorCommand(conn_hdl, <span class="hl-number">0x8F</span>, <span class="hl-number">0x01</span>, &amp;offCmd);             
        }
        break;</pre><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">2. EVENT_BSP event handling for on/off Light control</strong></p><ul class="- topic/ul ul"><li class="- topic/li li" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-0BFADC1A-6FE4-4149-B55A-18C514F4D3ED" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-0BFADC1A-6FE4-4149-B55A-18C514F4D3ED"><p class="- topic/p p">In addition to above ZCL event, BSP event will also be called when On/Off command is received. This will enable the user to write the board specific functionality code like switch on/off the on board LED. <strong class="+ topic/ph hi-d/b ph b">CMD_LED_BRIGHTNESS</strong> single event is called for both On or Off, since On/Off cluster is added in many other device types like dimmable light, color control light, where light functionality is also mapped to brightness/color and not simple On/Off. Add below code to control on board <strong class="+ topic/ph hi-d/b ph b">RED</strong> LED.</p></li></ul><pre class="+ topic/pre pr-d/codeblock pre codeblock json">void BSP_Event_Handler(APP_Zigbee_Event_t event)
{
    <em class="hl-comment">// User to handle  board Support package events</em>
    switch(event.eventId)
    {
        case CMD_LED_BRIGHTNESS:
        {
            <em class="hl-comment">/* Set the given LED brightness */</em>
            <em class="hl-comment">//Access - &gt; event.eventData.value;</em>
            <em class="hl-comment">//appSnprintf("Led Brightness \r\n");</em>
            if(event.eventData.value == <span class="hl-number">255</span>)<em class="hl-comment">// MAX_BRIGHTNESS_LEVEL for On</em>
               RED_LED_Set();
            else if (event.eventData.value == <span class="hl-number">0</span>) <em class="hl-comment">//MIN_BRIGHTNESS_LEVEL for Off</em>
               RED_LED_Clear();
                
        }
        break;</pre><ul class="- topic/ul ul"><li class="- topic/li li" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-13CA5601-FD99-4015-850A-85A26CD81851" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-13CA5601-FD99-4015-850A-85A26CD81851"><p class="- topic/p p">Add the include file needed for LED GPIO functionality in <strong class="+ topic/ph hi-d/b ph b">app_zigbee_handler.c</strong></p></li></ul><pre class="+ topic/pre pr-d/codeblock pre codeblock json">#include <span class="hl-string">"peripheral/gpio/plib_gpio.h"</span></pre><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">3. Edit device unique ID (zigbeeAppDeviceSelect.h)</strong></p><p class="- topic/p p">All the zigbee devices/modules will hold their unique IEEE address purchased from IEEE. For the demo purpose, where UID is not present in internal NVM, the pre-compiled fixed UID to be used. Edit the CS_UID to user defined value and not matching with combined interface UID (default 0xbee) as below in <strong class="+ topic/ph hi-d/b ph b">zigbeeAppDeviceSelect.h</strong></p><p class="- topic/p p"><div class=""><img class="- topic/image image" height="500" src="GUID-B142CF1F-4D82-47B8-B9F6-69C68958F0D4-high.png" width="500"/></div></p><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">4. Data Transaction between BLE to ZIGBEE protocol and vice versa</strong></p><p class="- topic/p p">Transparent Profile and Service (TRP/TRS) is the proprietary BLE service by microchip to establish data and control channel between BLE Central (Phone) and Peripheral (device). The custom 128-bit GATT characteristics are defined under this service.</p><p class="- topic/p p"> <strong class="+ topic/ph hi-d/b ph b">Definition of Transparent Service and Characteristics UUID's</strong></p><div class="table-container"><table class="- topic/table table" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-51677772-4EC3-45C7-AE0C-AE67E67AE426" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-51677772-4EC3-45C7-AE0C-AE67E67AE426" data-cols="3"><caption></caption><colgroup><col/><col/><col/></colgroup><thead class="- topic/thead thead"><tr class="- topic/row"><th class="- topic/entry entry colsep-0 rowsep-0" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-51677772-4EC3-45C7-AE0C-AE67E67AE426__entry__1">Characteristic Name</th><th class="- topic/entry entry colsep-0 rowsep-0" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-51677772-4EC3-45C7-AE0C-AE67E67AE426__entry__2">UUID</th><th class="- topic/entry entry colsep-0 rowsep-0" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-51677772-4EC3-45C7-AE0C-AE67E67AE426__entry__3">Properties</th></tr></thead><tbody class="- topic/tbody tbody"><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-51677772-4EC3-45C7-AE0C-AE67E67AE426__entry__1">TRS Service</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-51677772-4EC3-45C7-AE0C-AE67E67AE426__entry__2">49535343-FE7D-4AE5-8FA9-9FAFD205E455</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-51677772-4EC3-45C7-AE0C-AE67E67AE426__entry__3"></td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-51677772-4EC3-45C7-AE0C-AE67E67AE426__entry__1">TRS TxD- Tx Data to Client role (Data pipe)</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-51677772-4EC3-45C7-AE0C-AE67E67AE426__entry__2">49535343-1E4D-4BD9-BA61-23C647249616</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-51677772-4EC3-45C7-AE0C-AE67E67AE426__entry__3">Notify, Write</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-51677772-4EC3-45C7-AE0C-AE67E67AE426__entry__1">TRS TxD - Client Characteristic Configuration Descriptor</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-51677772-4EC3-45C7-AE0C-AE67E67AE426__entry__2"></td><td class="- topic/entry entry colsep-0 rowsep-0" headers="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-51677772-4EC3-45C7-AE0C-AE67E67AE426__entry__3">Read, Write</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-51677772-4EC3-45C7-AE0C-AE67E67AE426__entry__1">TRS RxD- Rx Data from Client role (Data pipe)</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-51677772-4EC3-45C7-AE0C-AE67E67AE426__entry__2">49535343-8841-43F4-A8D4-ECBE34729BB3</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-51677772-4EC3-45C7-AE0C-AE67E67AE426__entry__3">Write, Write without response</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-51677772-4EC3-45C7-AE0C-AE67E67AE426__entry__1">TRS Ctrl Pt - Command and Response (Ctrl pipe)</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-51677772-4EC3-45C7-AE0C-AE67E67AE426__entry__2">49535343-4C8A-39B3-2F49-511CFF073B7E</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-51677772-4EC3-45C7-AE0C-AE67E67AE426__entry__3">Notify, Write, Write without response</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-51677772-4EC3-45C7-AE0C-AE67E67AE426__entry__1">TRS Ctrl Pt - Client Characteristic Configuration descriptor</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-51677772-4EC3-45C7-AE0C-AE67E67AE426__entry__2"></td><td class="- topic/entry entry colsep-0 rowsep-0" headers="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-51677772-4EC3-45C7-AE0C-AE67E67AE426__entry__3">Read, Write</td></tr></tbody></table></div><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">1. Send data over BLE (app_zigbee_handler.c)</strong></p><p class="- topic/p p">When the On/Off command is received from CI, send single byte of data to mobile app using Transparent service. We use TRS Ctrl Pt characteristic in this example project to send and receive data from mobile app.</p><ul class="- topic/ul ul"><li class="- topic/li li" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-E4452AAC-C9D3-4245-89AD-E8B51B4375B1" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-E4452AAC-C9D3-4245-89AD-E8B51B4375B1"><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">BLE_TRSPS_SendVendorCommand(conn_hdl, 0x8F, 0x01, &amp;onCmd)</strong> is the API to be used for sending data towards the central device. Here 0x8F is any custom command value for identification and 0x01 is length of the command data. Add this API call in Zigbee On/Off ZCL event callbacks as below.</p></li></ul><pre class="+ topic/pre pr-d/codeblock pre codeblock json">void Cluster_Event_Handler(APP_Zigbee_Event_t event)
{
    switch(event.eventId)
    {
        case CMD_ZCL_ON:
        {
            <em class="hl-comment">/* ZCL Command ON received */</em>
            <em class="hl-comment">//Access - &gt; event.eventData.zclEventData.addressing;</em>
            <em class="hl-comment">//Access - &gt; event.eventData.zclEventData.payloadLength;</em>
            <em class="hl-comment">//Access - &gt; event.eventData.zclEventData.payload;</em>
            appSnprintf(<span class="hl-string">"On\r\n"</span>);
            uint8_t onCmd;
            onCmd = <span class="hl-number">0x01</span>;

            if(linkState == APP_BLE_STATE_CONNECTED)
                BLE_TRSPS_SendVendorCommand(conn_hdl, <span class="hl-number">0x8F</span>, <span class="hl-number">0x01</span>, &amp;onCmd);            
        }
        break;
        case CMD_ZCL_OFF:
        {
            <em class="hl-comment">/* ZCL Command Off received */</em>
            <em class="hl-comment">//Access - &gt; event.eventData.zclEventData.addressing;</em>
            <em class="hl-comment">//Access - &gt; event.eventData.zclEventData.payloadLength;</em>
            <em class="hl-comment">//Access - &gt; event.eventData.zclEventData.payload;</em>
            appSnprintf(<span class="hl-string">"Off\r\n"</span>);
            uint8_t offCmd;
            offCmd = <span class="hl-number">0x00</span>;

            if(linkState == APP_BLE_STATE_CONNECTED)
                BLE_TRSPS_SendVendorCommand(conn_hdl, <span class="hl-number">0x8F</span>, <span class="hl-number">0x01</span>, &amp;offCmd);             
        }
        break;</pre><ul class="- topic/ul ul"><li class="- topic/li li" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-2CC195B1-1226-43C8-A77F-4B5FCA698F38" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-2CC195B1-1226-43C8-A77F-4B5FCA698F38"><p class="- topic/p p">Add the include file needed for the above BLE API's in <strong class="+ topic/ph hi-d/b ph b">app_zigbee_handler.c</strong></p></li></ul><pre class="+ topic/pre pr-d/codeblock pre codeblock json">#include <span class="hl-string">"app_ble_handler.h"</span>
#include <span class="hl-string">"ble/profile_ble/ble_trsps/ble_trsps.h"</span></pre><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">2. Send data over ZIGBEE (app_trsps_handler.c)</strong></p><ul class="- topic/ul ul"><li class="- topic/li li" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-B04867A7-8809-4645-8FA0-4CFC70D3D2D0" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-B04867A7-8809-4645-8FA0-4CFC70D3D2D0"><p class="- topic/p p">When the On/Off single byte data is received from mobile app using Transparent service, change the global variable which holds the On/Off attribute value.</p></li><li class="- topic/li li" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-538F64AC-0E31-461F-818B-18ACA8AEEFCF" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-538F64AC-0E31-461F-818B-18ACA8AEEFCF"><p class="- topic/p p">On/Off attribute data is sent periodically at defined MAX interval to CI. When the On/Off attribute value is changed by BLE, an additional report will be sent at MIN report interval with the changed value. The reporting interval is configured in auto generated Zigbee middleware include file <strong class="+ topic/ph hi-d/b ph b"> firmware\src\config\default\zigbee\z3device\light\include\lightOnOffCluster.h</strong> (unit in seconds)</p></li></ul><pre class="+ topic/pre pr-d/codeblock pre codeblock json"><em class="hl-comment">/******************************************************************************
                    Definition(s) section
******************************************************************************/</em>
#define ONOFF_VAL_MIN_REPORT_PERIOD <span class="hl-number">30</span>
#define ONOFF_VAL_MAX_REPORT_PERIOD <span class="hl-number">120</span></pre><ul class="- topic/ul ul"><li class="- topic/li li" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-7CFF2C9A-FD82-4076-A96C-6C1D379F6CAF" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-7CFF2C9A-FD82-4076-A96C-6C1D379F6CAF"><p class="- topic/p p">When the non zero value is sent from mobile app using TRPS Ctrl pt characteristic, the LED is switched ON and for zero value LED is switched OFF in BLE_TRSPS_EVT_VENDOR_CMD event callback. Add the below code to update the On/Off attribute Value and to change <strong class="+ topic/ph hi-d/b ph b">RED LED</strong> Status. <strong class="+ topic/ph hi-d/b ph b">ZCL_ReportOnChangeIfNeeded()</strong> API is called to initiate the additional report at <strong class="+ topic/ph hi-d/b ph b">ONOFF_VAL_MIN_REPORT_PERIOD</strong> interval. <strong class="+ topic/ph hi-d/b ph b">lightOnOffClusterServerAttributes.onOff</strong> is the global variable defined in Zigbee middleware which holds the OnOFF attribute value.</p></li></ul><pre class="+ topic/pre pr-d/codeblock pre codeblock json">void APP_TrspsEvtHandler(BLE_TRSPS_Event_T *p_event)
{
    switch(p_event-&gt;eventId)
    {
        case BLE_TRSPS_EVT_VENDOR_CMD:
        {
            <em class="hl-comment">/* TODO: implement your application code.*/</em>
            if(p_event-&gt;eventField.onVendorCmd.length)
            {                 
                if(p_event-&gt;eventField.onVendorCmd.p_payLoad[<span class="hl-number">1</span>])
                {    
                    lightOnOffClusterServerAttributes.onOff.value = <span class="hl-number">1</span>;
                    RED_LED_Set();
                    appSnprintf(<span class="hl-string">"[BLE} On Command\n\r"</span>);                    
                }    
                else
                {    
                    lightOnOffClusterServerAttributes.onOff.value = <span class="hl-number">0</span>;
                    RED_LED_Clear();
                    appSnprintf(<span class="hl-string">"[BLE} Off Command\n\r"</span>);                    
                }                   
                ZCL_ReportOnChangeIfNeeded(&amp;lightOnOffClusterServerAttributes.onOff);
            }    
        }
        break;</pre><ul class="- topic/ul ul"><li class="- topic/li li" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-EC0801BE-E352-4F7E-8731-93A16D1DBFEF" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-EC0801BE-E352-4F7E-8731-93A16D1DBFEF"><p class="- topic/p p">Add the include file needed for the above ZIGBEE API and GPIO in <strong class="+ topic/ph hi-d/b ph b">app_trsps_handler.c</strong></p></li></ul><pre class="+ topic/pre pr-d/codeblock pre codeblock json">#include &lt;app_zigbee/zigbee_console/console.h&gt;
#include &lt;z3device/light/include/lightOnOffCluster.h&gt;
#include <span class="hl-string">"peripheral/gpio/plib_gpio.h"</span></pre><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">Note:</strong> The sample project with all the above code changes is available in ble_zigbee_basic for your reference.</p></section><section class="- topic/section section" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__PROGRAMMING-THE-APPLICATION-USING-MPLABX-IDE" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__PROGRAMMING-THE-APPLICATION-USING-MPLABX-IDE"><h2 class="- topic/title title sectiontitle">Programming the Application using MPLABX IDE</h2><ul class="- topic/ul ul"><li class="- topic/li li" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-32338F67-60EA-4B5D-8AD5-5768B3DECD50" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-32338F67-60EA-4B5D-8AD5-5768B3DECD50"><p class="- topic/p p">Build the project after doing all the above changes and program on Curiosity board</p></li></ul><div class=""><img class="- topic/image image break break" src="GUID-000923CE-F0D6-4DDB-BBF3-A895F4DCF52B-high.png"/></div><ul class="- topic/ul ul"><li class="- topic/li li" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-3714BEB7-8EE4-4FA4-9426-8E51B3D6A85F" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-3714BEB7-8EE4-4FA4-9426-8E51B3D6A85F"><p class="- topic/p p">Program the combined interface hex image on another curiosity board for Zigbee gateway by following below steps.</p></li></ul></section><section class="- topic/section section" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__PROGRAMMING-THE-PRECOMPILED-HEX-FILE-USING-MPLABX-IPE" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__PROGRAMMING-THE-PRECOMPILED-HEX-FILE-USING-MPLABX-IPE"><h2 class="- topic/title title sectiontitle">Programming the Precompiled hex file using
                MPLABX IPE</h2><ol class="- topic/ol ol" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-4616F54A-6B91-4119-A893-CDEE0C6E8591" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-4616F54A-6B91-4119-A893-CDEE0C6E8591"><li class="- topic/li li" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-FD39FA31-5ECF-413F-9592-22CE2F8E0367" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-FD39FA31-5ECF-413F-9592-22CE2F8E0367"><p class="- topic/p p">Precompiled Hex file is located here </p></li><li class="- topic/li li" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-EBD70409-5C2B-4E76-9C3B-F2064A02AC14" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-EBD70409-5C2B-4E76-9C3B-F2064A02AC14"><p class="- topic/p p">Follow the steps mentioned <a class="- topic/xref xref" href="https://microchipdeveloper.com/ipe/programming-device" target="_blank" rel="external noopener">here</a></p></li><li class="- topic/li li" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-057E49C4-2465-46AB-B772-72B1A8848AAB" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-057E49C4-2465-46AB-B772-72B1A8848AAB"><p class="- topic/p p">Program the combined interface hex image on another curiosity board for Zigbee gateway by following same procedure.</p></li></ol><div class="- topic/p p">
                <div class="- topic/note note notype note_notype" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__NOTE_BNT_24V_DZB" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__NOTE_BNT_24V_DZB"><span class="note__title">Note:</span>  Users must choose the correct Device and Tool
                    information</div>
            </div></section><section class="- topic/section section" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__TESTING" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__TESTING"><h2 class="- topic/title title sectiontitle">Testing</h2><p class="- topic/p p">This section assumes that user has already programmed multiprotocol Application Example and combined interface example on 2 <span class="- topic/ph ph">WBZ451</span> Curiosity boards</p><p class="- topic/p p"> <strong class="+ topic/ph hi-d/b ph b">Demo Experience when using a Smartphone (MBD App) as Central Device</strong></p><ol class="- topic/ol ol" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-67387698-0DAC-4F78-AB40-D987EF9F0443" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-67387698-0DAC-4F78-AB40-D987EF9F0443"><li class="- topic/li li" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-4A512892-812B-4A04-8A11-9C9862FC52A1" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-4A512892-812B-4A04-8A11-9C9862FC52A1"><p class="- topic/p p">Reset the Combined Interface programmed <span class="- topic/ph ph">WBZ451</span> Curiosity board, Open
                        Terminal emulator like Tera Term, select the right COM port@ (Speed: 115200,
                        Data: 8-bit, Parity: none, stop bits: 1 bit, Flow control: none, enable
                        CR+LF for RX, TX in Terminal setup).</p></li><li class="- topic/li li" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-5D313BD0-56CE-415F-A09A-8D243B336E09" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-5D313BD0-56CE-415F-A09A-8D243B336E09"><p class="- topic/p p">send command: <em class="+ topic/ph hi-d/i ph i">resetToFN</em> and look for the below logs for successful zigbee network formation on CI</p></li></ol><div class=""><img class="- topic/image image" src="GUID-360B7F34-1018-453C-AEA6-71322B1E9964-high.png"/></div><ol class="- topic/ol ol" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-9625C325-4013-4025-91E3-DA7BD71B0C32" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-9625C325-4013-4025-91E3-DA7BD71B0C32"><li class="- topic/li li" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-6B9A06E9-AF64-4DCA-9E8D-1F9FBA04F8F3" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-6B9A06E9-AF64-4DCA-9E8D-1F9FBA04F8F3"><p class="- topic/p p">Reset combo device and send command: <em class="+ topic/ph hi-d/i ph i">resetToFN</em>. Look for combo device joined with combined
                        Interface. The on/off light cluster search and binding between 2 devices is
                        successful, and combo device on/off light attributes reports are seen in CI.
                        During the 180sec commissioning period, the RED LED will be toggle.</p></li></ol><div class=""><img class="- topic/image image" src="GUID-DA8D1C48-C80B-4243-84EE-09228ABC3707-high.png"/></div><ol class="- topic/ol ol" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-0647FACE-1FDA-42B6-A527-5FCDF67CE650" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-0647FACE-1FDA-42B6-A527-5FCDF67CE650"><li class="- topic/li li" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-D63F1ABB-7AAF-4142-BC2B-E6CE5506726E" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-D63F1ABB-7AAF-4142-BC2B-E6CE5506726E"><p class="- topic/p p">Open Microchip Bluetooth Data (MBD) App on your smartphone, Search and select the advertisement with Device Name "Combo". Connect with the combo device.</p></li></ol><div class=""><img class="- topic/image image" src="GUID-CB281E14-1E55-4AF7-A44B-C9CB76040CBB-high.gif"/></div><ol class="- topic/ol ol" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-A47BBDB0-F3DF-4772-816D-9005DEB510CC" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-A47BBDB0-F3DF-4772-816D-9005DEB510CC"><li class="- topic/li li" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-E7AF6E82-5A3E-4A6B-87DA-643F734E73BE" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-E7AF6E82-5A3E-4A6B-87DA-643F734E73BE"><p class="- topic/p p">Enable Notify/Indicate to receive data from combo device</p></li></ol><p class="- topic/p p"><div class=""><img class="- topic/image image" height="500" src="GUID-DF37D8AF-CA64-4607-A28D-E28CA2C12D29-high.jpg" width="250"/></div></p><ol class="- topic/ol ol" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-B5DCFE88-12A7-405D-A1FD-E818D1BA2C25" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-B5DCFE88-12A7-405D-A1FD-E818D1BA2C25"><li class="- topic/li li" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-7DECBD8E-CC7E-4B12-9363-7CE67F236275" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-7DECBD8E-CC7E-4B12-9363-7CE67F236275"><p class="- topic/p p">After the 180 seconds commissioning period, write <strong class="+ topic/ph hi-d/b ph b">8F01</strong> to switch on RED LED and look for
                        on/off attribute value changing to 0x01 in CI, and also RED LED is getting
                        ON. Similarly write *<em class="+ topic/ph hi-d/i ph i">8F00</em> to switch off RED LED and look for
                        attribute value changing to 0x00 in CI. As mentioned previously, it would
                        take MIN report interval for the changed report value to appear in CI.</p></li></ol><p class="- topic/p p"><div class=""><img class="- topic/image image" height="500" src="GUID-70758EE6-1C91-4F94-834A-7FDF355E81C0-high.jpg" width="250"/></div></p><div class=""><img class="- topic/image image" height="500" src="GUID-1F21CC4C-F500-4724-8131-61D86E190F3A-high.jpg" width="250"/></div><p class="- topic/p p"></p><div class=""><img class="- topic/image image" src="GUID-FBEB61ED-4A19-49A5-B0C4-129DF718F83C-high.png"/></div><ol class="- topic/ol ol" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-D868AB55-67E1-463F-BD9E-86502B9919F7" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-D868AB55-67E1-463F-BD9E-86502B9919F7"><li class="- topic/li li" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-0C17E693-EEC7-4B71-81F9-E8AD81F5F67E" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-0C17E693-EEC7-4B71-81F9-E8AD81F5F67E"><p class="- topic/p p">By sending on/off command from CI the RED LED can be switched On/Off. The value can be seen in MBD app as well.</p></li></ol><ul class="- topic/ul ul"><li class="- topic/li li" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-446B9DDD-2F1F-40E9-A23C-49C322024CEE" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-446B9DDD-2F1F-40E9-A23C-49C322024CEE"><p class="- topic/p p">The network address of the combo device is needed to send light control commands to combo device from CI. This network address can be got from Combined interface console log while joining was done.</p></li></ul><div class=""><img class="- topic/image image" src="GUID-65728CD9-F2E5-4834-B7C7-272FE4B9BC4D-high.png"/></div><ul class="- topic/ul ul"><li class="- topic/li li" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-EC342EBB-EC15-4BB3-AEA5-28A24B4A281A" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-EC342EBB-EC15-4BB3-AEA5-28A24B4A281A"><p class="- topic/p p">Another way to get the network address from combo device is executing the below command in combo light side.</p></li></ul><pre class="+ topic/pre pr-d/codeblock pre codeblock json">        Command: getNetworkAddress
        Response: <span class="hl-number">9</span>bfa</pre><pre class="+ topic/pre pr-d/codeblock pre codeblock json">On/off command:
           onOff <span class="hl-number">0x0</span> <span class="hl-number">0x9bfa</span> <span class="hl-number">0x20</span> -on

           onOff <span class="hl-number">0x0</span> <span class="hl-number">0x9bfa</span> <span class="hl-number">0x20</span> -off</pre><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>  0x20 is zigbee end point number used for light can be taken from MCC configurator.
</code></pre><div class=""><img class="- topic/image image" src="GUID-1C221F36-FD2B-4982-9ADF-5F62185B62BF-high.png"/></div><div class=""><img class="- topic/image image" src="GUID-FBEB61ED-4A19-49A5-B0C4-129DF718F83C-high.png"/></div><p class="- topic/p p"><div class=""><img class="- topic/image image" height="500" src="GUID-2B151590-2FFA-49C9-B895-3BFC94E97A0F-high.jpg" width="250"/></div><div class=""><img class="- topic/image image" height="500" src="GUID-1A3A2D12-1BCB-4735-B605-807BB2AA5617-high.jpg" width="250"/></div></p></section><section class="- topic/section section" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__WHERE-TO-GO-FROM-HERE" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__WHERE-TO-GO-FROM-HERE"><h2 class="- topic/title title sectiontitle">Where to go from here</h2><ul class="- topic/ul ul"><li class="- topic/li li" id="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-73EEB446-3909-40DC-A5C4-9FA857F7FAE2" data-ofbid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GUID-73EEB446-3909-40DC-A5C4-9FA857F7FAE2"><p class="- topic/p p"><a class="- topic/xref xref" href="GUID-707BAEEE-0EFF-428F-AFEC-C2E6C5E65BA9.html">Advanced Multiprotocol Application with Zigbee Provisioning over BLE</a> by following the similar implementation. The guide also explains the wrapper protocol written on top of BLE Transparent service for BLE provisioning and light control. The on board RGB colour is controlled in this example, which can be referenced for PWM functionality.</p></li></ul></section></div></article></main></div>
                        
                        
                        
                        
                        
                        
                    </div>
                    
                        <nav role="navigation" id="wh_topic_toc" aria-label="On this page" class="col-lg-2 d-none d-lg-block navbar d-print-none"> 
                            <div id="wh_topic_toc_content">
		                        
	                            <div class=" wh_topic_toc "><div class="wh_topic_label">On this page</div><ul><li class="section-item"><div class="section-title"><a href="#GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__HARDWARE-REQUIRED" data-tocid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__HARDWARE-REQUIRED">Hardware Requirement</a></div></li><li class="section-item"><div class="section-title"><a href="#GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__SDK-SETUP" data-tocid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__SDK-SETUP">SDK Setup</a></div></li><li class="section-item"><div class="section-title"><a href="#GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__SOFTWARE" data-tocid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__SOFTWARE">Software Requirement</a></div></li><li class="section-item"><div class="section-title"><a href="#GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__SMARTPHONE-APP" data-tocid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__SMARTPHONE-APP">Smartphone App</a></div></li><li class="section-item"><div class="section-title"><a href="#GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__DEMO-DESCRIPTION" data-tocid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__DEMO-DESCRIPTION">Demo Description</a></div></li><li class="section-item"><div class="section-title"><a href="#GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__DEVELOPING-THIS-APPLICATION-FROM-SCRATCH-USING-MPLAB-CODE-CONFIGURATOR" data-tocid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__DEVELOPING-THIS-APPLICATION-FROM-SCRATCH-USING-MPLAB-CODE-CONFIGURATOR">Developing the Application from Scratch using
                MPLab Code Configurator</a></div></li><li class="section-item"><div class="section-title"><a href="#GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__PULL-IN-H3-COMPONENTS" data-tocid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__PULL-IN-H3-COMPONENTS">Pull-in MCC Components</a></div></li><li class="section-item"><div class="section-title"><a href="#GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__EDIT-BLE-STACK-SPECIFIC-CONFIGURATIONS" data-tocid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__EDIT-BLE-STACK-SPECIFIC-CONFIGURATIONS">Edit BLE Stack Specific Configurations</a></div></li><li class="section-item"><div class="section-title"><a href="#GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__EDIT-ZIGBEE-STACK-SPECIFIC-CONFIGURATIONS" data-tocid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__EDIT-ZIGBEE-STACK-SPECIFIC-CONFIGURATIONS">Edit Zigbee Stack Specific Configurations</a></div></li><li class="section-item"><div class="section-title"><a href="#GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__EDIT-PERIPHERAL-SPECIFIC-CONFIGURATIONS" data-tocid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__EDIT-PERIPHERAL-SPECIFIC-CONFIGURATIONS">Edit Peripheral Specific Configurations</a></div></li><li class="section-item"><div class="section-title"><a href="#GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GENERATE-CODE-LINK-FOR-INSTRUCTIONS" data-tocid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__GENERATE-CODE-LINK-FOR-INSTRUCTIONS">Generate Code link for instructions</a></div></li><li class="section-item"><div class="section-title"><a href="#GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__FILES-AND-ROUTINES-AUTOMATICALLY-GENERATED-BY-THE-MHC" data-tocid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__FILES-AND-ROUTINES-AUTOMATICALLY-GENERATED-BY-THE-MHC">Files and Routines Automatically
                Generated by the MCC</a></div></li><li class="section-item"><div class="section-title"><a href="#GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__USER-APPLICATION-DEVELOPMENT" data-tocid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__USER-APPLICATION-DEVELOPMENT">User Application Development</a></div></li><li class="section-item"><div class="section-title"><a href="#GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__PROGRAMMING-THE-APPLICATION-USING-MPLABX-IDE" data-tocid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__PROGRAMMING-THE-APPLICATION-USING-MPLABX-IDE">Programming the Application using MPLABX IDE</a></div></li><li class="section-item"><div class="section-title"><a href="#GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__PROGRAMMING-THE-PRECOMPILED-HEX-FILE-USING-MPLABX-IPE" data-tocid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__PROGRAMMING-THE-PRECOMPILED-HEX-FILE-USING-MPLABX-IPE">Programming the Precompiled hex file using
                MPLABX IPE</a></div></li><li class="section-item"><div class="section-title"><a href="#GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__TESTING" data-tocid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__TESTING">Testing</a></div></li><li class="section-item"><div class="section-title"><a href="#GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__WHERE-TO-GO-FROM-HERE" data-tocid="GUID-11ABDEE6-3F90-4086-AC19-BB2607CA8064__WHERE-TO-GO-FROM-HERE">Where to go from here</a></div></li></ul></div>
	                        	
                        	</div>
                        </nav>
                    
                </div>
            </div>
            
            
            
        </div> 
        <div class="mchp_disclaimer"><p class="mchp_disclaimer_text">The online versions of the documents are provided as a courtesy. Verify all content and data in the device’s PDF documentation found on the device product page.</p></div><footer class="navbar navbar-default wh_footer">
  <div class=" footer-container mx-auto ">
    <div class="footer">
  <div class="mchp-wh-footer">
    <div class="mchp-footer">
      <div class="mchp-footer-tier1">
        <div class="spacer"></div>
        <div class="mchp-footer-container">
          <div class="mchp-footer-links mchp-social-media-links">
            <div class="mchp-component-items">
              <div class="mchp-component-item">
                <a class="cmp-image__link" href="https://www.facebook.com/pages/Microchip-Technology-Inc/20320981741" target="_blank">
                  <img class="cmp-image__image" alt="Microchip Facebook" src="oxygen-webhelp/template/resources/images/201016-corp-facebook.png"/>
                </a>
              </div>
              <div class="mchp-component-item">
                <a class="cmp-image__link" href="https://www.linkedin.com/company/microchip-technology" target="_blank">
                  <img class="cmp-image__image" alt="Microchip LinkedIn" src="oxygen-webhelp/template/resources/images/201016-corp-linkedin.png"/>
                </a>
              </div>
              <div class="mchp-component-item">
                <a class="cmp-image__link" href="https://twitter.com/MicrochipTech" target="_blank">
                  <img class="cmp-image__image" alt="Microchip Twitter" src="oxygen-webhelp/template/resources/images/201016-corp-twitter.png"/>
                </a>
              </div>
              <div class="mchp-component-item">
                <a class="cmp-image__link" href="https://www.youtube.com/user/MicrochipTechnology" target="_blank">
                  <img class="cmp-image__image" alt="Microchip YouTube" src="oxygen-webhelp/template/resources/images/201016-corp-youtube.png"/>
                </a>
              </div>
              <div class="mchp-component-item">
                <a class="cmp-image__link" href="https://www.instagram.com/microchiptechnologyinc/" target="_blank">
                  <img class="cmp-image__image" alt="Microchip Instagram" src="oxygen-webhelp/template/resources/images/201016-corp-instagram.png"/>
                </a>
              </div>
              <div class="mchp-component-item">
                <a class="cmp-image__link" href="https://www.weibo.com/microchiptech" target="_blank">
                  <img class="cmp-image__image" alt="Microchip Weibo" src="oxygen-webhelp/template/resources/images/201016-corp-weibo.png"/>
                </a>
              </div>
              <div class="mchp-component-item">
                <a class="cmp-image__link" href="https://www.microchip.com/en-us/about/blog" target="_blank">
                  <img class="cmp-image__image" alt="Microchip Blog" src="oxygen-webhelp/template/resources/images/201016-corp-blog.png"/>
                </a>
              </div>
            </div>
          </div>
          <div class="mchp-footer-links">
            <div class="mchp-component-items">
              <div class="mchp-component-item">
                <div class="link">
                  <a href="https://www.microchip.com/about-us/contact-us" class="mchp-link__link">Contact</a>
                  <span class="mchp-link__separator">|</span>
                </div>
              </div>
              <div class="mchp-component-item ">
                <div class="link">
                  <a href="https://www.microchip.com/en-us/about/legal-information" class="mchp-link__link">Legal</a>
                  <span class="mchp-link__separator">|</span>
                </div>
              </div>
              <div class="mchp-component-item ">
                <div class="link">
                  <a href="https://www.microchip.com/en-us/about/legal-information/privacy-policy" class="mchp-link__link">Privacy Policy</a>
                  <span class="mchp-link__separator">|</span>
                </div>
              </div>
              <div class="mchp-component-item ">
                <div class="link">
                  <a href="https://www.microchip.com/en-us/about/legal-information/microchip-cookie-statement" class="mchp-link__link">Cookies</a>
                  <span class="mchp-link__separator">|</span>
                </div>
              </div>
              <div class="mchp-component-item">
                <div class="link">
                  <a href="https://careers.microchip.com/" class="mchp-link__link">Careers</a>
                  <span class="mchp-link__separator"></span>
                </div>
              </div>
            </div>
          </div>
          <div class="mchp-footer-newsletter">
            <div class="cmp-text">
              <p>Stay on the leading edge with our blog</p>
            </div>
            <div class="mchp-button-wrapper">
              <a role="button" href="https://www.microchip.com/en-us/about/blog" class="mchp-button mchp-button-regular solid">
                <span class="mchp-button__span">MicroSolutions</span>
              </a>
            </div>
          </div>
        </div>
        <div class="graphic">
          <img src="oxygen-webhelp/template/resources/images/footer-graphic.png"/>
        </div>
      </div>
      <div class="mchp-footer-tier2">
        <p class="mchp-copyright">© Copyright 1998-2022 Microchip Technology Inc. All rights reserved.</p>
      </div>
    </div>
  </div>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async="true" src="https://www.googletagmanager.com/gtag/js?id=UA-2724382-19"></script>
  <script>
    window.dataLayer = window.dataLayer || [];  
    function gtag(){dataLayer.push(arguments);}  
    gtag('js', new Date());   
    gtag('config', 'UA-2724382-19');
  </script>
  
  <script type="text/javascript">_satellite.pageBottom();</script><!-- Adobe Analytics -->
  
</div>
  </div>
</footer>
        
        <div id="go2top" class="d-print-none">
            <span class="oxy-icon oxy-icon-up"></span>
        </div>
        
        <div id="modal_img_large" class="modal">
            <span class="close oxy-icon oxy-icon-remove"></span>
            <div id="modal_img_container"></div>
            <div id="caption"></div>
        </div>
        
        
        
       
        </body>
</html>