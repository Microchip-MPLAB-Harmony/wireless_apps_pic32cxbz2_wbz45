<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE11" /><meta name="copyright" content="(C) Copyright 2023" />
<meta name="DC.rights.owner" content="(C) Copyright 2023" />
<meta name="DC.type" content="topic" />
<meta name="DC.title" content="Project Properties Configuration for Serial Bootloading" />
<meta name="DC.relation" scheme="URI" content="GUID-0B266078-AD33-4AB4-8C96-4F34D86C4BF3.html" />
<meta name="DC.format" content="XHTML" />
<meta name="DC.identifier" content="GUID-8D2F1488-E176-4352-994E-9B8B96AA6369" />
<meta name="DC.language" content="en-US" />
<link rel="stylesheet" type="text/css" href="stylesheets/atmel.css" />
<title>Project Properties Configuration for Serial Bootloading</title>
<meta name="Microsoft.Help.Id" content="GUID-A5330D3A-9F51-4A26-B71D-8503A493DF9C-GUID-8D2F1488-E176-4352-994E-9B8B96AA6369" />
<meta name="Microsoft.Help.TocParent" content="GUID-A5330D3A-9F51-4A26-B71D-8503A493DF9C-GUID-0B266078-AD33-4AB4-8C96-4F34D86C4BF3" />
<meta name="Microsoft.Help.TocOrder" content="1" />
<meta name="Microsoft.Help.Locale" content="en-US" />
<meta name="Microsoft.Help.TopicLocale" content="en-US" />
<meta name="Microsoft.Help.DisplayVersion" content="Software Development Reference A 09/2022" />
<script language="javascript">
       
       if (window.parent.location.protocol != 'file:') {
				document.addEventListener('click', function(e) {
				    if (e.target) {
               if (e.target.nodeName == "A" ) {
                    if (!e.target.target) {
                      e.preventDefault();
                      e.stopPropagation();
                              
                      var origUrl = window.parent.location.href.substr(0, window.parent.location.href.indexOf("?"));
                      if (origUrl.length === 0) {
                          origUrl = window.parent.location.href;
                      }
                      var href= e.target.getAttribute("href");
                      var parts = href.split("#");
          
                      var url = "";
                      if (parts.length == 2 ) {
                        if (!parts[0].length) {
                            url = window.parent.location.search.replace('?','')
                        } else {
                            url = parts[0].replace('.html','');
                        }
                      } else {
                        url = parts[0].replace('.html','');
                      }

                      if (parts.length == 2) {
                          url += "#" + parts[1];
                      }
    
                      window.parent.location.href = origUrl + "?" + url;

                      return false;
                    }
               }
            }
				});
			}

		</script><script language="javascript">
         
         function copyContent(content, button) {
         
            var textArea = document.createElement("textarea");
            
            // Place in the top-left corner of screen regardless of scroll position.
            textArea.style.position = 'fixed';
            textArea.style.top = 0;
            textArea.style.left = 0;
            
            // Ensure it has a small width and height. Setting to 1px / 1em
            // doesn't work as this gives a negative w/h on some browsers.
            textArea.style.width = '2em';
            textArea.style.height = '2em';
            
            // We don't need padding, reducing the size if it does flash render.
            textArea.style.padding = 0;
            
            // Clean up any borders.
            textArea.style.border = 'none';
            textArea.style.outline = 'none';
            textArea.style.boxShadow = 'none';
            
            // Avoid flash of the white box if rendered for any reason.
            textArea.style.background = 'transparent';
            
            textArea.value = content;
            
            document.body.appendChild(textArea);
            textArea.focus();
            textArea.select();
            
            try {
               var successful = document.execCommand('copy');
               var msg = successful ? 'successful' : 'unsuccessful';
               if (!button.classList.contains("copied")){
                  button.textContent = "Copied";
                  button.classList.add("copied");
                  setTimeout(function(){
                     button.textContent = "Copy";
                     button.classList.remove("copied");
                  },1000);
               }
            } catch (err) {
               console.log('Oops, unable to copy');
            }
            
            document.body.removeChild(textArea);
         }
         
         function cpy(id, button) {
            var element = document.getElementById(id);
            var content = element.getAttribute("content");
            
            copyContent(content, button);
         }
         
         document.addEventListener("DOMContentLoaded", function(event) {
            document.querySelectorAll(".codeblock").forEach(function(elem) {
               elem.style.position = "relative";
               var copy = document.createElement("button");
               copy.textContent = "Copy";
               copy.setAttribute("class", "copy-code");
               
               var content = elem.textContent;
               
               copy.addEventListener("click", function(){
                  copyContent(content, copy);
               });
               
               elem.addEventListener("mouseenter", function(evt){
                  elem.prepend(copy);
               });
            });
            
            document.querySelectorAll(".codeblock").forEach(function(elem) {
               elem.addEventListener("mouseleave", function(evt){
                  document.querySelector(".copy-code").remove();
               });
            });
         });
         
      </script><script language="javascript">
          
          // Add the MathML namespace to html
          var html = document.getElementsByTagName("html")[0],
          head = document.getElementsByTagName("head")[0];
          
          var mathJax = document.createElement("script");
          mathJax.src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML";
          head.appendChild(mathJax);
          
          html.setAttribute("xmlns:m","http://www.w3.org/1998/Math/MathML");
          
          function inIframe() { try { return window.self !== window.top; } catch (e) { return true; } }
          
          if (!inIframe()) { 
          
          var Default = "index.html?GUID-8D2F1488-E176-4352-994E-9B8B96AA6369"; 
          
          var displaylocation = "value" + window.location.href;
          
          var GUIDS = displaylocation.split('GUID');          
          
          if (displaylocation.indexOf('#GUID') != -1) {            
          var First = GUIDS[1].split('.html');  
          if (GUIDS[3]){First = GUIDS[2].split('.html');}
          if (GUIDS[4]){First = GUIDS[3].split('.html');}
          if (GUIDS[5]){First = GUIDS[4].split('.html');}
          
          var Second = GUIDS[2].split('#');   
          if (GUIDS[3]){Second = GUIDS[3].split('#');}
          if (GUIDS[4]){Second = GUIDS[4].split('#');}
          if (GUIDS[5]){Second = GUIDS[5].split('#');}
          
          Default = "index.html?" + "GUID" + First[0] + "GUID" + Second[0];     
          }                    
          window.top.location = Default;
          }       
          
        </script><link rel="stylesheet" type="text/css" href="syntax-highlight.css" /><style xml:space="">
        
          button.copy-code{
            display:none;
            padding:0.7em 1.4em;
            margin:0 0.3em 0.3em 0;
            border-radius:0.15em;
            box-sizing: border-box;
            text-decoration:none;
            font-family:'Roboto',sans-serif;
            text-transform:uppercase;
            font-weight:400;
            color:#FFFFFF;
            background-color:#9c9c9c;
            box-shadow:inset 0 -0.6em 0 -0.35em rgba(0,0,0,0.17);
            text-align:center;
            position:relative;
            border: 0;
            float: right;
            border-radius: .5em;
            cursor: pointer;
          }
          button.copy-code:active{
            top:0.1em;
          }
          
          pre:hover button.copy-code{
            display: inline-block !important;
          }
          button.copy-code.copied {
            cursor: default !important;
          }
          
          
          @media all and (max-width:30em){
            button.copy-code{
              display:block;
              margin:0.4em auto;
            }
          }
        
        
      </style><link rel="stylesheet" type="text/css" href="syntax-highlight.css" /></head>
<body id="GUID-8D2F1488-E176-4352-994E-9B8B96AA6369">
<h1 class="title topictitle1" id="GUID-8D2F1488-E176-4352-994E-9B8B96AA6369__GUID-D8DB0E69-DBD4-4810-863E-0594CCDA93EF" style="">Project Properties Configuration for Serial Bootloading</h1><div class="body"><p class="shortdesc"></p>
<p class="p">By following the previous steps, the Zigbee OTA Server capability is added into application project.</p>
<p class="p">The below steps are needed if upgrading the server firmware through UART when Bootloader service is added as per step <a class="xref" href="GUID-0B266078-AD33-4AB4-8C96-4F34D86C4BF3.html#GUID-0B266078-AD33-4AB4-8C96-4F34D86C4BF3__GUID-4B2F8EC6-2C04-4DBF-B231-A8F35A6B14AD">Bootloader Services</a>. Referring to <a class="xref" href="GUID-D3DC88CA-D2C0-4FFF-B035-FE4E6DAE1D97.html">Memory management</a>, Metatdata header and "Bootloader" has to be added into the project to receive new upgradable image over UART.</p>
<p class="p">MPLABXTools environment allows to configure and append the Metadata header into application image. The needed script is added into project folder (.X) when the "Bootloader Service" component was added and the code was generated from MCC.</p>
<div class="p"><div class="fig fignone" id="GUID-8D2F1488-E176-4352-994E-9B8B96AA6369__GUID-D12F49E0-F9B5-4E04-867F-70AD9ABF9FC1"><div class="figcap"><span class="fig--title-label">Figure 1. </span>. </div><span class="desc figdesc"></span><img class="image" src="GUID-2ED677BE-DBAE-4E19-BD86-2E9E757E1000-low.png" /></div>
</div>
<div class="note attention" id="GUID-8D2F1488-E176-4352-994E-9B8B96AA6369__GUID-A491221F-5E89-4807-8765-8D595C1B5391"><span class="attentiontitle">Attention:</span> <p class="p"><strong class="ph b">Note: Before proceeding to below steps, close the OTA application project and reopen the project. This step is mandatory for "SignFirmware" and "OTA" bin generation MPLABX script to be loaded into project environment.</strong></p>
</div>
<ol class="ol" id="GUID-8D2F1488-E176-4352-994E-9B8B96AA6369__GUID-01C0BD4A-95AA-4DFD-810C-63E960D7989D"><li class="li" id="GUID-8D2F1488-E176-4352-994E-9B8B96AA6369__GUID-4A82102F-1827-4484-8282-106D4226ED39"><span class="indent-level-default">1.</span><p class="p">Right click on the project -&gt; Properties.</p>
<div class="p"><div class="fig fignone" id="GUID-8D2F1488-E176-4352-994E-9B8B96AA6369__GUID-88CFC2BA-00FD-4D35-82A1-75845681F87D"><div class="figcap"><span class="fig--title-label">Figure 2. </span>. </div><span class="desc figdesc"></span><img class="image" src="GUID-E8129F69-9F9B-4066-AFAB-7633FD317C75-low.png" /></div>
<div class="fig fignone" id="GUID-8D2F1488-E176-4352-994E-9B8B96AA6369__GUID-DCC7B68D-A3A3-4CBC-8052-62158BA1D341"><div class="figcap"><span class="fig--title-label">Figure 3. </span>. </div><span class="desc figdesc"></span><img class="image" src="GUID-27EB8590-119B-4629-B703-6FA74CDD309B-low.png" /></div>
</div>
</li>
<li class="li" id="GUID-8D2F1488-E176-4352-994E-9B8B96AA6369__GUID-8A426628-626E-4117-BC8D-38296F4CEA46"><span class="indent-level-default">2.</span><div class="p"><strong class="ph b">SignFirmware</strong> - Adds Metadata header into application image. Refer to <a class="xref" href="GUID-894A155C-558E-45FD-AA0C-1546AE00DE53.html">Meta-data Header Configuration</a> for more details on header format. There are configurable parameters like Firmware Rev (version), authentication method and manufacturer ID. Configure as per requirement. <div class="fig fignone" id="GUID-8D2F1488-E176-4352-994E-9B8B96AA6369__GUID-CC4E7B75-037E-4544-8FB3-BFFD291D66DC"><div class="figcap"><span class="fig--title-label">Figure 4. </span>. </div><span class="desc figdesc"></span><img class="image" src="GUID-B6877E3A-F82B-4640-93DF-94CADFF4744E-low.png" /></div>
<ul class="ul"><li class="li" id="GUID-8D2F1488-E176-4352-994E-9B8B96AA6369__GUID-F5F14FE0-67F5-4F0D-8AA7-2653148031C4"><p class="p">Step1: "Firmware Rev" - Firmware version of current running firmware.</p>
</li>
<li class="li" id="GUID-8D2F1488-E176-4352-994E-9B8B96AA6369__GUID-25C5430B-108E-4544-A0B1-47522AF7C4EC"><p class="p">Step2a:"Auth Method" - There are 3 Supported authenticated methods</p>
<ul class="ul"><li class="li" id="GUID-8D2F1488-E176-4352-994E-9B8B96AA6369__GUID-2FF0FBA8-AB25-4FD5-8EC3-354AE941EA3C"><p class="p">Step 2b: <strong class="ph b">Signature validation</strong> (ECDSA256-SHA256) – most secure, and data integrity check. Signature is encrypted using ECDSA private key. 256-bit ECDSA Public key to be programmed in device to do signature decryption. <a class="xref" href="https://wiki.openssl.org/index.php/Command_Line_Elliptic_Curve_Operations" target="_blank">openssl</a> (example commands: https://techdocs.akamai.com/iot-token-access-control/docs/generate-jwt-ecdsa-keys) is one of the open tools to generate ECDSA public/private key pair. <a class="xref" href="GUID-70714605-ACB2-451F-87F0-66F97057949F.html">Sample private key</a> is available in project folder .X. Public key is input in Bootloader project.</p>
</li>
<li class="li" id="GUID-8D2F1488-E176-4352-994E-9B8B96AA6369__GUID-ECBF7BCE-FC40-4C21-89F8-17CE8B041FF2"><p class="p">Hash validation (SHA-256) – less security, and data integrity check.</p>
</li>
<li class="li" id="GUID-8D2F1488-E176-4352-994E-9B8B96AA6369__GUID-ECC90A5E-C775-4A73-AF8E-7939EF41D8B3"><p class="p">No validation (None) – no security, no integrity check.</p>
</li>
</ul>
</li>
</ul>
</div>
<div class="note warning" id="GUID-8D2F1488-E176-4352-994E-9B8B96AA6369__GUID-848F695E-E0AC-4815-9D2E-51FD4BB2257C"><span class="warningtitle">Warning:</span> <p class="p">Make sure to keep "Sequence number" as non-zero value and not 0xFFFFFFFF.</p>
</div>
</li>
<li class="li" id="GUID-8D2F1488-E176-4352-994E-9B8B96AA6369__GUID-7C8503EC-868F-439B-A0A3-BB05E0A4D41B"><span class="indent-level-default">3.</span><p class="p">Bootloader - Standalone Bootloader project is available in \bootloader folder. The bootloader code stays in Boot Flash section. The bootloader project can be added as loadable project into OTA project. When the OTA project is build, unified image with Bootloader+Metadata Header+Firmware will be generated. Add the loadable project/loadable file (bootloader.hex) into OTA project as shown below.</p>
<div class="p"><div class="fig fignone" id="GUID-8D2F1488-E176-4352-994E-9B8B96AA6369__GUID-26C395F7-00D0-4732-9EBB-35D77E7BB733"><div class="figcap"><span class="fig--title-label">Figure 5. </span>. </div><span class="desc figdesc"></span><img class="image" src="GUID-6F89C5D2-A4C2-4A90-8F9E-02434C6DD418-low.png" /></div>
</div>
</li>
<li class="li" id="GUID-8D2F1488-E176-4352-994E-9B8B96AA6369__GUID-D1E568DC-091A-47DE-8E5F-3E0A09751EFF"><span class="indent-level-default">4.</span><p class="p">After doing the above steps, click on "Apply", then "OK" to take the changes into effect.</p>
</li>
</ol>
<p class="p"></p>
</div>
<div class="related-links">
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a class="link" href="GUID-0B266078-AD33-4AB4-8C96-4F34D86C4BF3.html">OTA Implementation Details - OTAU Server</a></div>
</div>
</div></body>
</html>