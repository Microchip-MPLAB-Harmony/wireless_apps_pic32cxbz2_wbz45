<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE11" /><meta name="copyright" content="(C) Copyright 2022" />
<meta name="DC.rights.owner" content="(C) Copyright 2022" />
<meta name="DC.type" content="topic" />
<meta name="DC.title" content="Protocol Exchange" />
<meta name="DC.relation" scheme="URI" content="GUID-D3F1BF46-F275-409B-A344-4DB9EAABC5E9.html" />
<meta name="DC.format" content="XHTML" />
<meta name="DC.identifier" content="GUID-D320EA38-86CE-4C0B-8093-60C59E1F03AE" />
<meta name="DC.language" content="en-US" />
<link rel="stylesheet" type="text/css" href="stylesheets/atmel.css" />
<title>Protocol Exchange</title>
<meta name="Microsoft.Help.Id" content="GUID-A5330D3A-9F51-4A26-B71D-8503A493DF9C-GUID-D320EA38-86CE-4C0B-8093-60C59E1F03AE" />
<meta name="Microsoft.Help.TocParent" content="GUID-A5330D3A-9F51-4A26-B71D-8503A493DF9C-GUID-D3F1BF46-F275-409B-A344-4DB9EAABC5E9" />
<meta name="Microsoft.Help.TocOrder" content="0" />
<meta name="Microsoft.Help.Locale" content="en-US" />
<meta name="Microsoft.Help.TopicLocale" content="en-US" />
<meta name="Microsoft.Help.DisplayVersion" content="Software Development Reference 1 02/2022" />
<script language="javascript">
       
       if (window.parent.location.protocol != 'file:') {
				document.addEventListener('click', function(e) {
				    if (e.target) {
               if (e.target.nodeName == "A" ) {
                    if (!e.target.target) {
                      e.preventDefault();
                      e.stopPropagation();
                              
                      var origUrl = window.parent.location.href.substr(0, window.parent.location.href.indexOf("?"));
                      if (origUrl.length === 0) {
                          origUrl = window.parent.location.href;
                      }
                      var href= e.target.getAttribute("href");
                      var parts = href.split("#");
          
                      var url = "";
                      if (parts.length == 2 ) {
                        if (!parts[0].length) {
                            url = window.parent.location.search.replace('?','')
                        } else {
                            url = parts[0].replace('.html','');
                        }
                      } else {
                        url = parts[0].replace('.html','');
                      }

                      if (parts.length == 2) {
                          url += "#" + parts[1];
                      }
    
                      window.parent.location.href = origUrl + "?" + url;

                      return false;
                    }
               }
            }
				});
			}

		</script><script language="javascript">
         
         function copyContent(content, button) {
         
            var textArea = document.createElement("textarea");
            
            // Place in the top-left corner of screen regardless of scroll position.
            textArea.style.position = 'fixed';
            textArea.style.top = 0;
            textArea.style.left = 0;
            
            // Ensure it has a small width and height. Setting to 1px / 1em
            // doesn't work as this gives a negative w/h on some browsers.
            textArea.style.width = '2em';
            textArea.style.height = '2em';
            
            // We don't need padding, reducing the size if it does flash render.
            textArea.style.padding = 0;
            
            // Clean up any borders.
            textArea.style.border = 'none';
            textArea.style.outline = 'none';
            textArea.style.boxShadow = 'none';
            
            // Avoid flash of the white box if rendered for any reason.
            textArea.style.background = 'transparent';
            
            textArea.value = content;
            
            document.body.appendChild(textArea);
            textArea.focus();
            textArea.select();
            
            try {
               var successful = document.execCommand('copy');
               var msg = successful ? 'successful' : 'unsuccessful';
               if (!button.classList.contains("copied")){
                  button.textContent = "Copied";
                  button.classList.add("copied");
                  setTimeout(function(){
                     button.textContent = "Copy";
                     button.classList.remove("copied");
                  },1000);
               }
            } catch (err) {
               console.log('Oops, unable to copy');
            }
            
            document.body.removeChild(textArea);
         }
         
         function cpy(id, button) {
            var element = document.getElementById(id);
            var content = element.getAttribute("content");
            
            copyContent(content, button);
         }
         
         document.addEventListener("DOMContentLoaded", function(event) {
            document.querySelectorAll(".codeblock").forEach(function(elem) {
               elem.style.position = "relative";
               var copy = document.createElement("button");
               copy.textContent = "Copy";
               copy.setAttribute("class", "copy-code");
               
               var content = elem.textContent;
               
               copy.addEventListener("click", function(){
                  copyContent(content, copy);
               });
               
               elem.addEventListener("mouseenter", function(evt){
                  elem.prepend(copy);
               });
            });
            
            document.querySelectorAll(".codeblock").forEach(function(elem) {
               elem.addEventListener("mouseleave", function(evt){
                  document.querySelector(".copy-code").remove();
               });
            });
         });
         
      </script><script language="javascript">
          
          // Add the MathML namespace to html
          var html = document.getElementsByTagName("html")[0],
          head = document.getElementsByTagName("head")[0];
          
          var mathJax = document.createElement("script");
          mathJax.src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML";
          head.appendChild(mathJax);
          
          html.setAttribute("xmlns:m","http://www.w3.org/1998/Math/MathML");
          
          function inIframe() { try { return window.self !== window.top; } catch (e) { return true; } }
          
          if (!inIframe()) { 
          
          var Default = "index.html?GUID-D320EA38-86CE-4C0B-8093-60C59E1F03AE"; 
          
          var displaylocation = "value" + window.location.href;
          
          var GUIDS = displaylocation.split('GUID');          
          
          if (displaylocation.indexOf('#GUID') != -1) {            
          var First = GUIDS[1].split('.html');  
          if (GUIDS[3]){First = GUIDS[2].split('.html');}
          if (GUIDS[4]){First = GUIDS[3].split('.html');}
          if (GUIDS[5]){First = GUIDS[4].split('.html');}
          
          var Second = GUIDS[2].split('#');   
          if (GUIDS[3]){Second = GUIDS[3].split('#');}
          if (GUIDS[4]){Second = GUIDS[4].split('#');}
          if (GUIDS[5]){Second = GUIDS[5].split('#');}
          
          Default = "index.html?" + "GUID" + First[0] + "GUID" + Second[0];     
          }                    
          window.top.location = Default;
          }       
          
        </script><link rel="stylesheet" type="text/css" href="syntax-highlight.css" /><style xml:space="">
        
          button.copy-code{
            display:none;
            padding:0.7em 1.4em;
            margin:0 0.3em 0.3em 0;
            border-radius:0.15em;
            box-sizing: border-box;
            text-decoration:none;
            font-family:'Roboto',sans-serif;
            text-transform:uppercase;
            font-weight:400;
            color:#FFFFFF;
            background-color:#9c9c9c;
            box-shadow:inset 0 -0.6em 0 -0.35em rgba(0,0,0,0.17);
            text-align:center;
            position:relative;
            border: 0;
            float: right;
            border-radius: .5em;
            cursor: pointer;
          }
          button.copy-code:active{
            top:0.1em;
          }
          
          pre:hover button.copy-code{
            display: inline-block !important;
          }
          button.copy-code.copied {
            cursor: default !important;
          }
          
          
          @media all and (max-width:30em){
            button.copy-code{
              display:block;
              margin:0.4em auto;
            }
          }
        
        
      </style><link rel="stylesheet" type="text/css" href="syntax-highlight.css" /></head>
<body id="GUID-D320EA38-86CE-4C0B-8093-60C59E1F03AE">
<h1 class="title topictitle1" id="GUID-D320EA38-86CE-4C0B-8093-60C59E1F03AE__GUID-F4A53C77-C79D-421B-B8EC-93312B4986FC">Protocol Exchange</h1><div class="body"><p class="p">The communication protocol exchange between mobile app (BLE central) and <span class="ph">WBZ451</span> module (BLE peripheral) is explained here. </p>
<div class="section" id="GUID-D320EA38-86CE-4C0B-8093-60C59E1F03AE__1-BLE-SENSOR-DATA-IN-ADVERTISING-BEACON"><h2 class="title sectiontitle">1. BLE Sensor Data in Advertising Beacon:</h2><div class="p"><div class="fig fignone" id="GUID-D320EA38-86CE-4C0B-8093-60C59E1F03AE__GUID-A9EBF084-22B4-4DDD-A8C0-EABA57C3ACF9"><br /><img class="image" src="GUID-C33B9310-EC5E-4B3D-BABC-CFD2222FDFAE-low.jpg" /><br /></div>
</div>
<ul class="ul"><li class="li" id="GUID-D320EA38-86CE-4C0B-8093-60C59E1F03AE__GUID-BA34870A-ED74-48CE-AD27-EC50B95C97EF"><p class="p">Advertisement Data:</p>
<ul class="ul"><li class="li" id="GUID-D320EA38-86CE-4C0B-8093-60C59E1F03AE__GUID-20E2E3EB-6CAE-4B08-8BFF-9DEB4A7A3957"><p class="p">Service UUID: 16-bit Service UUID, 0xFEDA is purchased by Microchip from Bluetooth SIG.</p>
</li>
<li class="li" id="GUID-D320EA38-86CE-4C0B-8093-60C59E1F03AE__GUID-DC3BC23D-9F7D-4A40-885C-CB4B1749B2CE"><p class="p">BLE Sensor data: 0x40+Light ON/Off status (1 Byte)+ 0x41+Temperature data (2 bytes)</p>
</li>
</ul>
</li>
<li class="li" id="GUID-D320EA38-86CE-4C0B-8093-60C59E1F03AE__GUID-E5B0A483-20BE-4B34-850D-E7FE999B778E"><p class="p">Scan Response Data:</p>
<ul class="ul"><li class="li" id="GUID-D320EA38-86CE-4C0B-8093-60C59E1F03AE__GUID-CA2CB87B-8CB0-4ABF-A6FC-2CC6A9D3BA3C"><p class="p">The device name is part of the scan response. Device name is set as "BLE_SENSOR_XXXX” (XXXX means the last two bytes of the device address).</p>
</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="GUID-D320EA38-86CE-4C0B-8093-60C59E1F03AE__2-TRANSPARENT-PROFILE-AND-SERVICE-TRPTRS"><h2 class="title sectiontitle">2. Transparent Profile and Service (TRP/TRS):</h2><p class="p">Transparent Profile and Service (TRP/TRS) is the proprietary BLE service by microchip to establish data and control channel between BLE Central (Phone) and Peripheral (device).</p>
<div class="p"><div class="fig fignone" id="GUID-D320EA38-86CE-4C0B-8093-60C59E1F03AE__GUID-6708A39A-24A4-46DC-A9A9-D6BD05BC6BD3"><br /><img class="image" src="GUID-D12B8E11-AB50-4622-B088-5EF29C02CC79-low.png" /><br /></div>
</div>
<ul class="ul"><li class="li" id="GUID-D320EA38-86CE-4C0B-8093-60C59E1F03AE__GUID-485FCF77-E585-48B8-826E-D9869DD21493"><p class="p">Transparent Profile (TRP) enables higher layer application to control and allow data exchange between TRP Client and Server devices</p>
</li>
<li class="li" id="GUID-D320EA38-86CE-4C0B-8093-60C59E1F03AE__GUID-FF54B0AA-4A26-4371-AA46-E988138B4DDC"><p class="p">Transparent Service (TRS) includes both Ctrl and Data Pipes which are custom 128-bit GATT characteristics.</p>
<ul class="ul"><li class="li" id="GUID-D320EA38-86CE-4C0B-8093-60C59E1F03AE__GUID-C7045213-E50D-4996-A8BB-DA69039141F0"><p class="p">The Transparent Server shall be a GATT Server</p>
</li>
<li class="li" id="GUID-D320EA38-86CE-4C0B-8093-60C59E1F03AE__GUID-6A8DD6B5-010F-434E-B17D-6B918DAE2BED"><p class="p">The Transparent Client shall be a GATT Client</p>
<p class="p"><strong class="ph b">Definition of Transparent Service and Characteristics UUID's</strong></p>

<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="GUID-D320EA38-86CE-4C0B-8093-60C59E1F03AE__GUID-EE855293-DEC0-4C35-8BAF-00ABD14C8BCD" class="table" frame="border" border="1" rules="all"><col style="width:" /><col style="width:" /><col style="width:" /><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry cellrowborder" style="vertical-align:middle;" id="d42016e74"><span>Characteristic Name</span></th>
<th class="entry cellrowborder" style="vertical-align:middle;" id="d42016e76"><span>UUID</span></th>
<th class="entry cellrowborder" style="vertical-align:middle;" id="d42016e78"><span>Properties</span></th>
</tr>
</thead>
<tbody class="tbody"><tr class="row"><td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e74 "><span>TRS Service</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e76 "><span>49535343-FE7D-4AE5-8FA9-9FAFD205E455</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e78 "><span> </span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e74 "><span>TRS TxD- Tx Data to Client role (Data pipe)</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e76 "><span>49535343-1E4D-4BD9-BA61-23C647249616</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e78 "><span>Notify, Write</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e74 "><span>TRS TxD - Client Characteristic Configuration Descriptor</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e76 "><span> </span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e78 "><span>Read, Write</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e74 "><span>TRS RxD- Rx Data from Client role (Data pipe)</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e76 "><span>49535343-8841-43F4-A8D4-ECBE34729BB3</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e78 "><span>Write, Write without response</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e74 "><span>TRS Ctrl Pt - Command and Response (Ctrl pipe)</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e76 "><span>49535343-4C8A-39B3-2F49-511CFF073B7E</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e78 "><span>Notify, Write, Write without response</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e74 "><span>TRS Ctrl Pt - Client Characteristic Configuration descriptor</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e76 "><span> </span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e78 "><span>Read, Write</span></td>
</tr>
</tbody>
</table>
</div>
</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="GUID-D320EA38-86CE-4C0B-8093-60C59E1F03AE__3-BLE-SENSOR-APPLICATION-OVER-TRANSPARENT-SERVICE-CONTROL-POINT-TRS-CTRL-PT"><h2 class="title sectiontitle">3. BLE Sensor Application over Transparent Service Control Point (TRS Ctrl Pt):</h2><p class="p">BLE Sensor application uses TRS Control Point Characteristic of TRPS profile to exchange data between mobile phone and device.</p>
<div class="p"><div class="fig fignone" id="GUID-D320EA38-86CE-4C0B-8093-60C59E1F03AE__GUID-5AA24B72-AE67-487D-AF4A-60D3C2F7F02F"><br /><img class="image" src="GUID-4715F2C7-E7A4-4B16-B8BB-3E195439C2CC-low.png" /><br /></div>
</div>
<p class="p">The BLE Sensor application follows the below protocol format on TRS control point characteristic.</p>

<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="GUID-D320EA38-86CE-4C0B-8093-60C59E1F03AE__GUID-76841ACB-4A4F-41A8-95EE-88D67EB2F15D" class="table" frame="border" border="1" rules="all"><col style="width:" /><col style="width:" /><col style="width:" /><col style="width:" /><col style="width:" /><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry cellrowborder" style="vertical-align:middle;" id="d42016e139"><span>Item</span></th>
<th class="entry cellrowborder" style="vertical-align:middle;" id="d42016e141"><span>Opcode</span></th>
<th class="entry cellrowborder" style="vertical-align:middle;" id="d42016e143"><span>Length</span></th>
<th class="entry cellrowborder" style="vertical-align:middle;" id="d42016e145"><span>Sensor/Control ID</span></th>
<th class="entry cellrowborder" style="vertical-align:middle;" id="d42016e147"><span>Payload</span></th>
</tr>
</thead>
<tbody class="tbody"><tr class="row"><td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e139 "><span>Size</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e141 "><span>1 Byte</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e143 "><span>1 Byte</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e145 "><span>1 Byte</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e147 "><span>Variable</span></td>
</tr>
</tbody>
</table>
</div>
<p class="p">The description of each element is as below:</p>
<pre class="pre codeblock"><button title="Copy Code" class="copy-code" onclick="cpy('d42016e163', this);">Copy</button><code id="d42016e163" content="- The Opcode: (0x8A) is fixed 1 byte in size and related to BLE Sensor/Control commands.&#xA;- Length: 1 byte in size (size of Sensor/Control ID + size of Payload)&#xA;- The Sensor/Control ID: 1 byte in size. It could be divided into Control request, Control response, Sensor notify data described in detail in following sections.&#xA;- The Sensor/control data and payload size depends on the Sensor/Control ID as listed in the below table.&#xA;">- The Opcode: (0x8A) is fixed 1 byte in size and related to BLE Sensor/Control commands.
- Length: 1 byte in size (size of Sensor/Control ID + size of Payload)
- The Sensor/Control ID: 1 byte in size. It could be divided into Control request, Control response, Sensor notify data described in detail in following sections.
- The Sensor/control data and payload size depends on the Sensor/Control ID as listed in the below table.
</code></pre><p class="p"><strong class="ph b">BLE sensor application control and sensor command/response</strong></p>

<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="GUID-D320EA38-86CE-4C0B-8093-60C59E1F03AE__GUID-A64370E3-A34F-4CEA-8B00-DC505D446B6A" class="table" frame="border" border="1" rules="all"><col style="width:" /><col style="width:" /><col style="width:" /><col style="width:" /><col style="width:" /><col style="width:" /><col style="width:" /><col style="width:" /><col style="width:" /><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry cellrowborder" style="vertical-align:middle;" id="d42016e181"><span><strong class="ph b">Control Cmd</strong></span></th>
<th class="entry cellrowborder" style="vertical-align:middle;" id="d42016e184"><span><strong class="ph b">Opcode</strong></span></th>
<th class="entry cellrowborder" style="vertical-align:middle;" id="d42016e187"><span><strong class="ph b">Control Request ID</strong></span></th>
<th class="entry cellrowborder" style="vertical-align:middle;" id="d42016e190"><span><strong class="ph b">Parameter</strong></span></th>
<th class="entry cellrowborder" style="vertical-align:middle;" id="d42016e193"><span><strong class="ph b">Parameter Length (Byte)</strong></span></th>
<th class="entry cellrowborder" style="vertical-align:middle;" id="d42016e196"><span><strong class="ph b">Control Response ID</strong></span></th>
<th class="entry cellrowborder" style="vertical-align:middle;" id="d42016e199"><span><strong class="ph b">Control Response Payload</strong></span></th>
<th class="entry cellrowborder" style="vertical-align:middle;" id="d42016e202"><span><strong class="ph b">Control Response Payload Length (Byte)</strong></span></th>
<th class="entry cellrowborder" style="vertical-align:middle;" id="d42016e205"><span><strong class="ph b">Description</strong></span></th>
</tr>
</thead>
<tbody class="tbody"><tr class="row"><td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e181 "><span>RGB LED On/Off Set</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e184 "><span>0x8A</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e187 "><span>0x10</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e190 "><span>On/Off</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e193 "><span>1</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e196 "><span>0x20</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e199 "><span>Status code</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e202 "><span>1</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e205 "><span>Switch On/Off the RGB LED with the default/last set color</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e181 "><span>RGB LED On/Off Get</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e184 "><span>0x8A</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e187 "><span>0x11</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e190 "><span> </span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e193 "><span> </span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e196 "><span>0x21</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e199 "><span>Status code + On/Off status</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e202 "><span>2</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e205 "><span>Send the RGB LED on/off status</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e181 "><span>RGB Color Set</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e184 "><span>0x8A</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e187 "><span>0x12</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e190 "><span>Color value (HSV)</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e193 "><span>3</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e196 "><span>0x22</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e199 "><span>Status code</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e202 "><span>1</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e205 "><span>Set RGB color value in HSV format</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e181 "><span>RGB Color Get</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e184 "><span>0x8A</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e187 "><span>0x13</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e190 "><span> </span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e193 "><span> </span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e196 "><span>0x23</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e199 "><span>Status code + RGB color value</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e202 "><span>4</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e205 "><span>Send RGB color value in HSV format</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e181 "><span><strong class="ph b">Sensor Data</strong></span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e184 "><span> </span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e187 "><span> </span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e190 "><span> </span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e193 "><span> </span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e196 "><span><strong class="ph b">Sensor ID</strong></span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e199 "><span><strong class="ph b">Parameter</strong></span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e202 "><span><strong class="ph b">Parameter Length (Byte)</strong></span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e205 "><span><strong class="ph b">Description</strong></span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e181 "><span>RGB LED On/Off status</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e184 "><span>0x8A</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e187 "><span> </span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e190 "><span> </span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e193 "><span> </span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e196 "><span>0x40</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e199 "><span>On/Off status</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e202 "><span>1</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e205 "><span>RGB LED On/Off Status</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e181 "><span>Temperature data</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e184 "><span>0x8A</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e187 "><span> </span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e190 "><span> </span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e193 "><span> </span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e196 "><span>0x41</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e199 "><span>Temperature sensor data</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e202 "><span>2</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e205 "><span>Temperature value in Celsius with 0.1 resolution. The MSB bit will be set when the negative temperature is reported</span></td>
</tr>
</tbody>
</table>
</div>
<p class="p"><strong class="ph b">3.1 Control Command Request and Response</strong></p>
<p class="p">The Control command request is used by mobile app to send the command to device. The control request channel is opened only after Client Characteristic Configuration Descriptor of TRS Ctrl Pt Characteristic notification is enabled; it is closed when such notification is disabled.</p>
<p class="p">The format of Control command is an 8bit Opcode, an 8bit request ID followed by optional control payload.</p>
<p class="p"><strong class="ph b">Format of Control Command</strong></p>

<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="GUID-D320EA38-86CE-4C0B-8093-60C59E1F03AE__GUID-ACA0700C-7180-4DA3-86AB-BCCB4AD7619D" class="table" frame="border" border="1" rules="all"><col style="width:" /><col style="width:" /><col style="width:" /><col style="width:" /><col style="width:" /><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry cellrowborder" style="vertical-align:middle;" id="d42016e353"><span><strong class="ph b">Item</strong></span></th>
<th class="entry cellrowborder" style="vertical-align:middle;" id="d42016e356"><span>Op Code</span></th>
<th class="entry cellrowborder" style="vertical-align:middle;" id="d42016e358"><span>Length</span></th>
<th class="entry cellrowborder" style="vertical-align:middle;" id="d42016e360"><span>Control Request ID</span></th>
<th class="entry cellrowborder" style="vertical-align:middle;" id="d42016e362"><span>Control Payload</span></th>
</tr>
</thead>
<tbody class="tbody"><tr class="row"><td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e353 "><span><strong class="ph b">Size (Octet)</strong></span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e356 "><span>1</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e358 "><span>1</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e360 "><span>1</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e362 "><span>Variable</span></td>
</tr>
</tbody>
</table>
</div>
<p class="p">The control response is used by the device to send feedback to mobile app. The format of Response is an 8bit Opcode, an 8bit response ID and response status followed by optional Response payload.</p>
<p class="p"><strong class="ph b">Format of Control Response Data</strong></p>

<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="GUID-D320EA38-86CE-4C0B-8093-60C59E1F03AE__GUID-0E7C3254-09CE-49A8-94D8-B394F851DF73" class="table" frame="border" border="1" rules="all"><col style="width:" /><col style="width:" /><col style="width:" /><col style="width:" /><col style="width:" /><col style="width:" /><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry cellrowborder" style="vertical-align:middle;" id="d42016e392"><span><strong class="ph b">Item</strong></span></th>
<th class="entry cellrowborder" style="vertical-align:middle;" id="d42016e395"><span>Op Code</span></th>
<th class="entry cellrowborder" style="vertical-align:middle;" id="d42016e397"><span>Length</span></th>
<th class="entry cellrowborder" style="vertical-align:middle;" id="d42016e399"><span>Control Response ID</span></th>
<th class="entry cellrowborder" style="vertical-align:middle;" id="d42016e401"><span>Status</span></th>
<th class="entry cellrowborder" style="vertical-align:middle;" id="d42016e403"><span>Control Response Payload</span></th>
</tr>
</thead>
<tbody class="tbody"><tr class="row"><td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e392 "><span><strong class="ph b">Size (Octet)</strong></span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e395 "><span>1</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e397 "><span>1</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e399 "><span>1</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e401 "><span>1</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e403 "><span>Variable</span></td>
</tr>
</tbody>
</table>
</div>
<p class="p">Status code 0x00 means successful execution of control command. Any status code other than 0x00 means error code, as shown in below Table. An error status does not have optional control Response payload.</p>
<p class="p"><strong class="ph b">Definition of Status Code</strong></p>

<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="GUID-D320EA38-86CE-4C0B-8093-60C59E1F03AE__GUID-8E003105-ECFA-4F4A-B588-6CDF821D490C" class="table" frame="border" border="1" rules="all"><col style="width:" /><col style="width:" /><col style="width:" /><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry cellrowborder" style="vertical-align:middle;" id="d42016e432"><span><strong class="ph b">Status Code</strong></span></th>
<th class="entry cellrowborder" style="vertical-align:middle;" id="d42016e435"><span><strong class="ph b">Definition</strong></span></th>
<th class="entry cellrowborder" style="vertical-align:middle;" id="d42016e438"><span><strong class="ph b">Description</strong></span></th>
</tr>
</thead>
<tbody class="tbody"><tr class="row"><td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e432 "><span><strong class="ph b">0x00</strong></span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e435 "><span>Success</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e438 "><span>Response for successful operation</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e432 "><span><strong class="ph b">0x01</strong></span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e435 "><span>Op Code Not Supported</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e438 "><span>Response if unsupported Op Code is received</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e432 "><span><strong class="ph b">0x02</strong></span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e435 "><span>Invalid Parameter</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e438 "><span>Response if Parameter received does not meet the requirements of the service.</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e432 "><span><strong class="ph b">0x03</strong></span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e435 "><span>Operation Fail</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e438 "><span>Response for fail operation</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e432 "><span><strong class="ph b">0x04-0xFF</strong></span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e435 "><span>Reserved for Future use</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e438 "><span> </span></td>
</tr>
</tbody>
</table>
</div>
<p class="p"><strong class="ph b">3.2 Sensor Notify Data</strong></p>
<p class="p">The Sensor data is sent to mobile app periodically by <span class="ph">WBZ451</span> device. The sensor data channel is opened only after Client Characteristic Configuration Descriptor of TRS Ctrl Pt notification is enabled; it is closed when such notification is disabled.</p>
<p class="p">The format of sensor data is an 8bit Opcode, an 8bit Sensor ID followed by sensor data payload.</p>
<p class="p"><strong class="ph b">Format of Sensor Data</strong></p>

<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="GUID-D320EA38-86CE-4C0B-8093-60C59E1F03AE__GUID-9736F2FA-8C27-4DAC-849E-66C8D3A5897D" class="table" frame="border" border="1" rules="all"><col style="width:" /><col style="width:" /><col style="width:" /><col style="width:" /><col style="width:" /><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry cellrowborder" style="vertical-align:middle;" id="d42016e504"><span><strong class="ph b">Item</strong></span></th>
<th class="entry cellrowborder" style="vertical-align:middle;" id="d42016e507"><span>Op Code</span></th>
<th class="entry cellrowborder" style="vertical-align:middle;" id="d42016e509"><span>Length</span></th>
<th class="entry cellrowborder" style="vertical-align:middle;" id="d42016e511"><span>Sensor ID</span></th>
<th class="entry cellrowborder" style="vertical-align:middle;" id="d42016e513"><span>Sensor Payload</span></th>
</tr>
</thead>
<tbody class="tbody"><tr class="row"><td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e504 "><span><strong class="ph b">Size (Octet)</strong></span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e507 "><span>1</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e509 "><span>1</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e511 "><span>1</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d42016e513 "><span>Variable</span></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="related-links">
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a class="link" href="GUID-D3F1BF46-F275-409B-A344-4DB9EAABC5E9.html">BLE Sensor App</a></div>
</div>
</div></body>
</html>