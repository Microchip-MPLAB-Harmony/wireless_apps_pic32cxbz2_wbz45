<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE11" /><meta name="copyright" content="(C) Copyright 2023" />
<meta name="DC.rights.owner" content="(C) Copyright 2023" />
<meta name="DC.type" content="topic" />
<meta name="DC.title" content="USART with Direct Pin Enable" />
<meta name="Description" content="Direct Mode is a mode in which peripherals are running based on function priority for pins and not using Peripheral Pin Selection(PPS)." />
<meta name="DC.relation" scheme="URI" content="GUID-B9333775-2F34-4B60-9429-E1B1B7F505FD.html" />
<meta name="DC.format" content="XHTML" />
<meta name="DC.identifier" content="GUID-D79D28FC-6693-4FE3-B380-9F6983BCE151" />
<meta name="DC.language" content="en-US" />
<link rel="stylesheet" type="text/css" href="stylesheets/atmel.css" />
<title>USART with Direct Pin Enable</title>
<meta name="Microsoft.Help.Id" content="GUID-A5330D3A-9F51-4A26-B71D-8503A493DF9C-GUID-D79D28FC-6693-4FE3-B380-9F6983BCE151" />
<meta name="Microsoft.Help.TocParent" content="GUID-A5330D3A-9F51-4A26-B71D-8503A493DF9C-GUID-B9333775-2F34-4B60-9429-E1B1B7F505FD" />
<meta name="Microsoft.Help.TocOrder" content="0" />
<meta name="Microsoft.Help.Locale" content="en-US" />
<meta name="Microsoft.Help.TopicLocale" content="en-US" />
<meta name="Microsoft.Help.DisplayVersion" content="Software Development Reference A 09/2022" />
<script language="javascript">
       
       if (window.parent.location.protocol != 'file:') {
				document.addEventListener('click', function(e) {
				    if (e.target) {
               if (e.target.nodeName == "A" ) {
                    if (!e.target.target) {
                      e.preventDefault();
                      e.stopPropagation();
                              
                      var origUrl = window.parent.location.href.substr(0, window.parent.location.href.indexOf("?"));
                      if (origUrl.length === 0) {
                          origUrl = window.parent.location.href;
                      }
                      var href= e.target.getAttribute("href");
                      var parts = href.split("#");
          
                      var url = "";
                      if (parts.length == 2 ) {
                        if (!parts[0].length) {
                            url = window.parent.location.search.replace('?','')
                        } else {
                            url = parts[0].replace('.html','');
                        }
                      } else {
                        url = parts[0].replace('.html','');
                      }

                      if (parts.length == 2) {
                          url += "#" + parts[1];
                      }
    
                      window.parent.location.href = origUrl + "?" + url;

                      return false;
                    }
               }
            }
				});
			}

		</script><script language="javascript">
         
         function copyContent(content, button) {
         
            var textArea = document.createElement("textarea");
            
            // Place in the top-left corner of screen regardless of scroll position.
            textArea.style.position = 'fixed';
            textArea.style.top = 0;
            textArea.style.left = 0;
            
            // Ensure it has a small width and height. Setting to 1px / 1em
            // doesn't work as this gives a negative w/h on some browsers.
            textArea.style.width = '2em';
            textArea.style.height = '2em';
            
            // We don't need padding, reducing the size if it does flash render.
            textArea.style.padding = 0;
            
            // Clean up any borders.
            textArea.style.border = 'none';
            textArea.style.outline = 'none';
            textArea.style.boxShadow = 'none';
            
            // Avoid flash of the white box if rendered for any reason.
            textArea.style.background = 'transparent';
            
            textArea.value = content;
            
            document.body.appendChild(textArea);
            textArea.focus();
            textArea.select();
            
            try {
               var successful = document.execCommand('copy');
               var msg = successful ? 'successful' : 'unsuccessful';
               if (!button.classList.contains("copied")){
                  button.textContent = "Copied";
                  button.classList.add("copied");
                  setTimeout(function(){
                     button.textContent = "Copy";
                     button.classList.remove("copied");
                  },1000);
               }
            } catch (err) {
               console.log('Oops, unable to copy');
            }
            
            document.body.removeChild(textArea);
         }
         
         function cpy(id, button) {
            var element = document.getElementById(id);
            var content = element.getAttribute("content");
            
            copyContent(content, button);
         }
         
         document.addEventListener("DOMContentLoaded", function(event) {
            document.querySelectorAll(".codeblock").forEach(function(elem) {
               elem.style.position = "relative";
               var copy = document.createElement("button");
               copy.textContent = "Copy";
               copy.setAttribute("class", "copy-code");
               
               var content = elem.textContent;
               
               copy.addEventListener("click", function(){
                  copyContent(content, copy);
               });
               
               elem.addEventListener("mouseenter", function(evt){
                  elem.prepend(copy);
               });
            });
            
            document.querySelectorAll(".codeblock").forEach(function(elem) {
               elem.addEventListener("mouseleave", function(evt){
                  document.querySelector(".copy-code").remove();
               });
            });
         });
         
      </script><script language="javascript">
          
          // Add the MathML namespace to html
          var html = document.getElementsByTagName("html")[0],
          head = document.getElementsByTagName("head")[0];
          
          var mathJax = document.createElement("script");
          mathJax.src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML";
          head.appendChild(mathJax);
          
          html.setAttribute("xmlns:m","http://www.w3.org/1998/Math/MathML");
          
          function inIframe() { try { return window.self !== window.top; } catch (e) { return true; } }
          
          if (!inIframe()) { 
          
          var Default = "index.html?GUID-D79D28FC-6693-4FE3-B380-9F6983BCE151"; 
          
          var displaylocation = "value" + window.location.href;
          
          var GUIDS = displaylocation.split('GUID');          
          
          if (displaylocation.indexOf('#GUID') != -1) {            
          var First = GUIDS[1].split('.html');  
          if (GUIDS[3]){First = GUIDS[2].split('.html');}
          if (GUIDS[4]){First = GUIDS[3].split('.html');}
          if (GUIDS[5]){First = GUIDS[4].split('.html');}
          
          var Second = GUIDS[2].split('#');   
          if (GUIDS[3]){Second = GUIDS[3].split('#');}
          if (GUIDS[4]){Second = GUIDS[4].split('#');}
          if (GUIDS[5]){Second = GUIDS[5].split('#');}
          
          Default = "index.html?" + "GUID" + First[0] + "GUID" + Second[0];     
          }                    
          window.top.location = Default;
          }       
          
        </script><link rel="stylesheet" type="text/css" href="syntax-highlight.css" /><style xml:space="">
        
          button.copy-code{
            display:none;
            padding:0.7em 1.4em;
            margin:0 0.3em 0.3em 0;
            border-radius:0.15em;
            box-sizing: border-box;
            text-decoration:none;
            font-family:'Roboto',sans-serif;
            text-transform:uppercase;
            font-weight:400;
            color:#FFFFFF;
            background-color:#9c9c9c;
            box-shadow:inset 0 -0.6em 0 -0.35em rgba(0,0,0,0.17);
            text-align:center;
            position:relative;
            border: 0;
            float: right;
            border-radius: .5em;
            cursor: pointer;
          }
          button.copy-code:active{
            top:0.1em;
          }
          
          pre:hover button.copy-code{
            display: inline-block !important;
          }
          button.copy-code.copied {
            cursor: default !important;
          }
          
          
          @media all and (max-width:30em){
            button.copy-code{
              display:block;
              margin:0.4em auto;
            }
          }
        
        
      </style><link rel="stylesheet" type="text/css" href="syntax-highlight.css" /></head>
<body id="GUID-D79D28FC-6693-4FE3-B380-9F6983BCE151">
<h1 class="title topictitle1" id="GUID-D79D28FC-6693-4FE3-B380-9F6983BCE151__GUID-D4CE7295-948D-43D2-A163-5476676F1A39" style=""><strong class="ph b">USART with Direct Pin Enable</strong></h1><div class="body"><p class="shortdesc">Direct Mode is a mode in which peripherals are running based on function priority for pins and not using Peripheral Pin Selection(PPS).</p>
<p class="p"><strong class="ph b">SDK Setup</strong></p>
<p class="p"><a class="xref" href="GUID-2AD37FE2-1915-4E34-9A05-79E3810726D7.html" title="Steps to install IDE, compiler, tool chain, BLE, Zigbee stacks and application examples on your PC">Getting Started with Software Development</a></p>
<p class="p"><strong class="ph b">Software</strong></p>
<p class="p">1. <a class="xref" href="https://ttssh2.osdn.jp/index.html.en" target="_blank">Tera Term</a></p>
<p class="p"><strong class="ph b">Hardware</strong></p>
<p class="p">1. WBZ451 Curiosity board</p>
<div class="section" id="GUID-D79D28FC-6693-4FE3-B380-9F6983BCE151__GUID-2E08D3B5-2215-4D90-B186-CFACDE86EC9C"><h2 class="title sectiontitle"><strong class="ph b">Developing an application from scratch using MPLAB Code Configurator</strong></h2><p class="p">This section explains the steps required by a user to develop an application example from scratch using MPLABx Code Configurator.</p>
<p class="p">Tip: New users of MPLAB Code Configurator are recommended to go through the <a class="xref" href="https://onlinedocs.microchip.com/pr/GUID-1F7007B8-9A46-4D03-AEED-650357BA760D-en-US-6/index.html?GUID-B5D058F5-1D0B-4720-8649-ACE5C0EEE2C0" target="_blank">overview.</a></p>
<div class="p"><ol class="ol" id="GUID-D79D28FC-6693-4FE3-B380-9F6983BCE151__GUID-8FAFF268-A010-4ACE-A4E7-CDB1484E1CFC"><li class="li" id="GUID-D79D28FC-6693-4FE3-B380-9F6983BCE151__GUID-86F1F37F-C2DE-4E9B-9DD0-3DAF688B2209"><span class="indent-level-default">1.</span><p class="p">Create a new MCC Harmony Project -- <a class="xref" href="GUID-B86E8493-D00D-46EF-8624-D412342147F0.html">link</a> for instructions</p>
</li>
<li class="li" id="GUID-D79D28FC-6693-4FE3-B380-9F6983BCE151__GUID-F50EDC48-A06C-4F57-8849-E830ED3F1DED"><span class="indent-level-default">2.</span><p class="p">User can find <em class="ph i">Device Resources</em> window right below the Project resource tab</p>
</li>
</ol>
<div class="fig fignone" id="GUID-D79D28FC-6693-4FE3-B380-9F6983BCE151__GUID-2011A5C5-72C0-4652-BBE0-AA44ADAD8633"><div class="figcap"><span class="fig--title-label">Figure 1. </span>Device Resources. </div><span class="desc figdesc"></span><img class="image" src="GUID-C0B46022-4D03-4300-AAE9-71EF28CEDA56-low.jpg" /></div>
</div>
</div>
<p class="p">1. Add SERCOM0 from Peripherals list.</p>
<div class="p"><div class="fig fignone" id="GUID-D79D28FC-6693-4FE3-B380-9F6983BCE151__GUID-B906582C-31E4-4A5A-8F78-89A8F84CF0CC"><div class="figcap"><span class="fig--title-label">Figure 2. </span>SERCOM0 Peripheral. </div><span class="desc figdesc"></span><img class="image" src="GUID-6A3A06CE-ACE7-4321-9EE1-670484EA3EF0-low.jpg" /></div>
</div>
<p class="p">2. Project graph view after adding SERCOM0 to the project resources.</p>
<div class="p"><div class="fig fignone" id="GUID-D79D28FC-6693-4FE3-B380-9F6983BCE151__GUID-957710D2-6CD7-4E3D-9CB7-80EF4125AC7F"><div class="figcap"><span class="fig--title-label">Figure 3. </span>Project Graph. </div><span class="desc figdesc"></span><img class="image" src="GUID-0320B6D7-FAC1-48AF-9D88-0B3B9674DA61-low.jpg" /></div>
</div>
<div class="section" id="GUID-D79D28FC-6693-4FE3-B380-9F6983BCE151__GUID-73BD8A43-E026-4A94-BF88-F8C759567C87"><h2 class="title sectiontitle">Verify UART Configuration</h2><p class="p">1. Select SERCOM0 component in project graph. SERCOM0 USART provides 3 operating modes:</p>
<p class="p"></p>
</div>
<div class="section" id="GUID-D79D28FC-6693-4FE3-B380-9F6983BCE151__GUID-23DA3527-3C10-46B3-9EEE-F39E21674C25"><p class="p">a ) Ring buffer mode</p>
<p class="p">In ring buffer mode, the receiver is always enabled, and the received data is saved in the internal receive ring buffer, size of which can be configured using MHC. The application can use the API calls to read the data out from the ring buffer. APIs are provided to query the number of (unread) bytes available in the receive buffer, free space in the receive buffer and size of the receive buffer. Similarly, during transmission, the application data is deep copied into the internal transmit ring buffer, size of which can be configured using MHC. This allows the use of local buffers for data transmission. APIs are provided to query the free space in the transmit buffer, number of bytes pending transmission and the size of the transmit buffer. Additionally, application can enable notifications to get notified when n bytes are available in the receive buffer or when n bytes of free space is available in the transmit buffer. The APIs allow application to set the threshold levels for notification in both receive and transmit buffers. Further, application can also choose to enable persistent notifications, whereby the application is notified until the threshold condition is met.</p>
<div class="p"><div class="fig fignone" id="GUID-D79D28FC-6693-4FE3-B380-9F6983BCE151__GUID-E26BB157-6F20-46B9-A377-037B69F67060"><div class="figcap"><span class="fig--title-label">Figure 4. </span>Ring buffer mode configuration options. </div><span class="desc figdesc"></span><img class="image" src="GUID-9E90A961-CC5A-4B0F-9529-3991DB000744-low.jpg" /></div>
</div>
</div>
<div class="section" id="GUID-D79D28FC-6693-4FE3-B380-9F6983BCE151__GUID-6EECA618-EDE5-4286-9F8A-7B8038B75A18"><p class="p">b) Blocking mode</p>
<p class="p">In blocking mode, the transfer APIs block until the requested data is transferred.</p>
<div class="p"><div class="fig fignone" id="GUID-D79D28FC-6693-4FE3-B380-9F6983BCE151__GUID-1474C4A5-F853-4CB9-9E03-5C5788AE20E8"><div class="figcap"><span class="fig--title-label">Figure 5. </span>Blocking mode configuration options. </div><span class="desc figdesc"></span><img class="image" src="GUID-EAE6FF68-CECA-4DA7-8818-F16D726A16D1-low.jpg" /></div>
</div>
</div>
<div class="section" id="GUID-D79D28FC-6693-4FE3-B380-9F6983BCE151__GUID-4AFDB6E9-D0EA-4896-A953-1A0DA187DE92"><p class="p">c) Non-blocking mode</p>
<p class="p">In non-blocking mode the peripheral interrupt is enabled. The transfer API initiates the transfer and returns immediately. The transfer is then completed from the peripheral interrupt. Application can either use a callback to get notified when the transfer is complete or can use the <em class="ph i">IsBusy</em> API to check the completion status.</p>
<div class="p"><div class="fig fignone" id="GUID-D79D28FC-6693-4FE3-B380-9F6983BCE151__GUID-6AD1A972-9F12-4D66-BC9F-DF040AA461C2"><div class="figcap"><span class="fig--title-label">Figure 6. </span>Non-blocking mode configuration options. </div><span class="desc figdesc"></span><img class="image" src="GUID-66F4E3A1-6888-4716-93B5-07A859EC4BAC-low.jpg" /></div>
</div>
</div>
<p class="p">2. Select system component in project graph and set SERCOM0 in "Direct" mode.</p>
<div class="p"><div class="fig fignone" id="GUID-D79D28FC-6693-4FE3-B380-9F6983BCE151__GUID-9FA4FFA1-F82A-47AB-8270-9B67620776D2"><div class="figcap"><span class="fig--title-label">Figure 7. </span>System configuration. </div><span class="desc figdesc"></span><img class="image" src="GUID-19F0A5D5-D62D-4E41-B78D-E58B5737561E-low.jpg" /></div>
</div>
<div class="section" id="GUID-D79D28FC-6693-4FE3-B380-9F6983BCE151__GUID-BC72E5B8-465D-48C0-A43C-EDB0BE45F1CB"><h2 class="title sectiontitle">Generate Code</h2><p class="p"><a class="xref" href="GUID-9C28F407-4879-4174-9963-2CF34161398E.html">link</a> for instructions.</p>
<p class="p">The sercom initialization routine executed during program initialization can be found in the project files. This initialization routine is automatically generated by the MCC according to the user settings.</p>
<p class="p"><strong class="ph b">Header Files</strong></p>
<p class="p">Header File associated with sercom0 peripheral library or any other peripheral library for a different example is included in definitions.h file.</p>
<p class="p"><strong class="ph b">Function Calls</strong></p>
<p class="p">MCC generates and adds the code to initialize the UART peripheral in SYS_Initialize() function.</p>
<p class="p">SERCOM0_USART_Initialize() is the API that will be called inside the SYS_Initialize() function.</p>
<p class="p">User can exercise SERCOM0_USART_Write() api to create a “Hello World” application example like this:</p>
<div class="p"><div class="fig fignone" id="GUID-D79D28FC-6693-4FE3-B380-9F6983BCE151__GUID-98169C75-B68F-48DA-BED4-12B52733110D"><div class="figcap"><span class="fig--title-label">Figure 8. </span>App example. </div><span class="desc figdesc"></span><img class="image" src="GUID-AD63FD4B-6AF4-46A0-85B1-793026E5B014-low.jpg" /></div>
</div>
</div>
<div class="section" id="GUID-D79D28FC-6693-4FE3-B380-9F6983BCE151__GUID-24EF93D9-4176-4356-9682-87605986BF6F"><h2 class="title sectiontitle">Testing</h2><p class="p">Connect the WBZ451 Curiosity board to PC, program the application example. Open TeraTerm(Speed: 115200, Data: 8-bit, Parity: none, stop bits: 1 bit, Flow control: none) and select the COM port that is enumerated when connecting the WBZ451 Curiosity Board. Reset the board and your application example will output the message in Teraterm</p>
<div class="p"><div class="fig fignone" id="GUID-D79D28FC-6693-4FE3-B380-9F6983BCE151__GUID-1EB02C01-8E25-4402-9A6D-884C8DB22C9E"><div class="figcap"><span class="fig--title-label">Figure 9. </span>Terminal window. </div><span class="desc figdesc"></span><img class="image" src="GUID-28ACED31-AF18-488C-96F0-06B632DB25E3-low.jpg" /></div>
</div>
</div>
<p class="p"></p>
</div>
<div class="related-links">
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a class="link" href="GUID-B9333775-2F34-4B60-9429-E1B1B7F505FD.html" title="Guidance on how to add analog/digital peripherals to your application">How-to: Adding Chip Peripherals</a></div>
</div>
</div></body>
</html>