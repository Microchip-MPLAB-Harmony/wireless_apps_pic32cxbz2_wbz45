<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE11" /><meta name="copyright" content="(C) Copyright 2023" />
<meta name="DC.rights.owner" content="(C) Copyright 2023" />
<meta name="DC.type" content="topic" />
<meta name="DC.title" content="Zigbee Network Security Models" />
<meta name="DC.relation" scheme="URI" content="GUID-668A6CB2-F1FB-438D-9E1E-D67AC3C1C132.html" />
<meta name="DC.format" content="XHTML" />
<meta name="DC.identifier" content="GUID-C8CD15B7-2156-4EF8-8D55-C879C829A34B" />
<meta name="DC.language" content="en-US" />
<link rel="stylesheet" type="text/css" href="stylesheets/atmel.css" />
<title>Zigbee Network Security Models</title>
<meta name="Microsoft.Help.Id" content="GUID-A5330D3A-9F51-4A26-B71D-8503A493DF9C-GUID-C8CD15B7-2156-4EF8-8D55-C879C829A34B" />
<meta name="Microsoft.Help.TocParent" content="GUID-A5330D3A-9F51-4A26-B71D-8503A493DF9C-GUID-668A6CB2-F1FB-438D-9E1E-D67AC3C1C132" />
<meta name="Microsoft.Help.TocOrder" content="3" />
<meta name="Microsoft.Help.Locale" content="en-US" />
<meta name="Microsoft.Help.TopicLocale" content="en-US" />
<meta name="Microsoft.Help.DisplayVersion" content="Software Development Reference A 09/2022" />
<script language="javascript">
       
       if (window.parent.location.protocol != 'file:') {
				document.addEventListener('click', function(e) {
				    if (e.target) {
               if (e.target.nodeName == "A" ) {
                    if (!e.target.target) {
                      e.preventDefault();
                      e.stopPropagation();
                              
                      var origUrl = window.parent.location.href.substr(0, window.parent.location.href.indexOf("?"));
                      if (origUrl.length === 0) {
                          origUrl = window.parent.location.href;
                      }
                      var href= e.target.getAttribute("href");
                      var parts = href.split("#");
          
                      var url = "";
                      if (parts.length == 2 ) {
                        if (!parts[0].length) {
                            url = window.parent.location.search.replace('?','')
                        } else {
                            url = parts[0].replace('.html','');
                        }
                      } else {
                        url = parts[0].replace('.html','');
                      }

                      if (parts.length == 2) {
                          url += "#" + parts[1];
                      }
    
                      window.parent.location.href = origUrl + "?" + url;

                      return false;
                    }
               }
            }
				});
			}

		</script><script language="javascript">
         
         function copyContent(content, button) {
         
            var textArea = document.createElement("textarea");
            
            // Place in the top-left corner of screen regardless of scroll position.
            textArea.style.position = 'fixed';
            textArea.style.top = 0;
            textArea.style.left = 0;
            
            // Ensure it has a small width and height. Setting to 1px / 1em
            // doesn't work as this gives a negative w/h on some browsers.
            textArea.style.width = '2em';
            textArea.style.height = '2em';
            
            // We don't need padding, reducing the size if it does flash render.
            textArea.style.padding = 0;
            
            // Clean up any borders.
            textArea.style.border = 'none';
            textArea.style.outline = 'none';
            textArea.style.boxShadow = 'none';
            
            // Avoid flash of the white box if rendered for any reason.
            textArea.style.background = 'transparent';
            
            textArea.value = content;
            
            document.body.appendChild(textArea);
            textArea.focus();
            textArea.select();
            
            try {
               var successful = document.execCommand('copy');
               var msg = successful ? 'successful' : 'unsuccessful';
               if (!button.classList.contains("copied")){
                  button.textContent = "Copied";
                  button.classList.add("copied");
                  setTimeout(function(){
                     button.textContent = "Copy";
                     button.classList.remove("copied");
                  },1000);
               }
            } catch (err) {
               console.log('Oops, unable to copy');
            }
            
            document.body.removeChild(textArea);
         }
         
         function cpy(id, button) {
            var element = document.getElementById(id);
            var content = element.getAttribute("content");
            
            copyContent(content, button);
         }
         
         document.addEventListener("DOMContentLoaded", function(event) {
            document.querySelectorAll(".codeblock").forEach(function(elem) {
               elem.style.position = "relative";
               var copy = document.createElement("button");
               copy.textContent = "Copy";
               copy.setAttribute("class", "copy-code");
               
               var content = elem.textContent;
               
               copy.addEventListener("click", function(){
                  copyContent(content, copy);
               });
               
               elem.addEventListener("mouseenter", function(evt){
                  elem.prepend(copy);
               });
            });
            
            document.querySelectorAll(".codeblock").forEach(function(elem) {
               elem.addEventListener("mouseleave", function(evt){
                  document.querySelector(".copy-code").remove();
               });
            });
         });
         
      </script><script language="javascript">
          
          // Add the MathML namespace to html
          var html = document.getElementsByTagName("html")[0],
          head = document.getElementsByTagName("head")[0];
          
          var mathJax = document.createElement("script");
          mathJax.src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML";
          head.appendChild(mathJax);
          
          html.setAttribute("xmlns:m","http://www.w3.org/1998/Math/MathML");
          
          function inIframe() { try { return window.self !== window.top; } catch (e) { return true; } }
          
          if (!inIframe()) { 
          
          var Default = "index.html?GUID-C8CD15B7-2156-4EF8-8D55-C879C829A34B"; 
          
          var displaylocation = "value" + window.location.href;
          
          var GUIDS = displaylocation.split('GUID');          
          
          if (displaylocation.indexOf('#GUID') != -1) {            
          var First = GUIDS[1].split('.html');  
          if (GUIDS[3]){First = GUIDS[2].split('.html');}
          if (GUIDS[4]){First = GUIDS[3].split('.html');}
          if (GUIDS[5]){First = GUIDS[4].split('.html');}
          
          var Second = GUIDS[2].split('#');   
          if (GUIDS[3]){Second = GUIDS[3].split('#');}
          if (GUIDS[4]){Second = GUIDS[4].split('#');}
          if (GUIDS[5]){Second = GUIDS[5].split('#');}
          
          Default = "index.html?" + "GUID" + First[0] + "GUID" + Second[0];     
          }                    
          window.top.location = Default;
          }       
          
        </script><link rel="stylesheet" type="text/css" href="syntax-highlight.css" /><style xml:space="">
        
          button.copy-code{
            display:none;
            padding:0.7em 1.4em;
            margin:0 0.3em 0.3em 0;
            border-radius:0.15em;
            box-sizing: border-box;
            text-decoration:none;
            font-family:'Roboto',sans-serif;
            text-transform:uppercase;
            font-weight:400;
            color:#FFFFFF;
            background-color:#9c9c9c;
            box-shadow:inset 0 -0.6em 0 -0.35em rgba(0,0,0,0.17);
            text-align:center;
            position:relative;
            border: 0;
            float: right;
            border-radius: .5em;
            cursor: pointer;
          }
          button.copy-code:active{
            top:0.1em;
          }
          
          pre:hover button.copy-code{
            display: inline-block !important;
          }
          button.copy-code.copied {
            cursor: default !important;
          }
          
          
          @media all and (max-width:30em){
            button.copy-code{
              display:block;
              margin:0.4em auto;
            }
          }
        
        
      </style><link rel="stylesheet" type="text/css" href="syntax-highlight.css" /></head>
<body id="GUID-C8CD15B7-2156-4EF8-8D55-C879C829A34B">
<h1 class="title topictitle1" id="GUID-C8CD15B7-2156-4EF8-8D55-C879C829A34B__GUID-D1B877D2-52B2-4F54-8925-337C8B7D0C7C" style="">Zigbee Network Security Models</h1><div class="body"><p class="p">To satisfy a wide range of applications while maintaining low cost and power, Zigbee offers two
            network architectures and corresponding security models: <strong class="ph b">distributed</strong> and
                <strong class="ph b">centralized</strong>.</p>
<p class="p">They basically differ in how they admit new devices into the network. The security model controls how a network key is distributed; and may control how network frame counters are initialized. The security model does not affect how messages are secured.</p>
<ol class="ol" id="GUID-C8CD15B7-2156-4EF8-8D55-C879C829A34B__GUID-E7EC8463-3D92-408D-87C3-4C834CB66E1F"><li class="li" id="GUID-C8CD15B7-2156-4EF8-8D55-C879C829A34B__GUID-FAC90E9B-1093-4FF9-A795-CFAF45470DC7"><span class="indent-level-default">1.</span><strong class="ph b">Distributed security model :</strong><ol class="ol" type="a" id="GUID-C8CD15B7-2156-4EF8-8D55-C879C829A34B__GUID-E7EC8463-3D92-408D-87C3-4C834CB66E1F">
                    <li class="li" id="GUID-C8CD15B7-2156-4EF8-8D55-C879C829A34B__GUID-FAC90E9B-1093-4FF9-A795-CFAF45470DC7"><span class="indent-level-default">a.</span>
                        <p class="p">Provides a less-secured and simpler system</p>

                    </li>

                    <li class="li" id="GUID-C8CD15B7-2156-4EF8-8D55-C879C829A34B__GUID-FAC90E9B-1093-4FF9-A795-CFAF45470DC7"><span class="indent-level-default">b.</span>
                        <p class="p">It has two device types</p>

                        <ol class="ol" type="i" id="GUID-C8CD15B7-2156-4EF8-8D55-C879C829A34B__GUID-E7EC8463-3D92-408D-87C3-4C834CB66E1F">
                            <li class="li" id="GUID-C8CD15B7-2156-4EF8-8D55-C879C829A34B__GUID-FAC90E9B-1093-4FF9-A795-CFAF45470DC7"><span class="indent-level-default">i.</span>
                                <p class="p">Routers</p>

                            </li>

                            <li class="li" id="GUID-C8CD15B7-2156-4EF8-8D55-C879C829A34B__GUID-FAC90E9B-1093-4FF9-A795-CFAF45470DC7"><span class="indent-level-default">ii.</span>
                                <p class="p">End Devices</p>

                            </li>

                        </ol>

                    </li>

                    <li class="li" id="GUID-C8CD15B7-2156-4EF8-8D55-C879C829A34B__GUID-FAC90E9B-1093-4FF9-A795-CFAF45470DC7"><span class="indent-level-default">c.</span>
                        <p class="p">Here, a router can form a distributed security network, when it can’t ﬁnd
                            any existing network.</p>

                    </li>

                    <li class="li" id="GUID-C8CD15B7-2156-4EF8-8D55-C879C829A34B__GUID-FAC90E9B-1093-4FF9-A795-CFAF45470DC7"><span class="indent-level-default">d.</span>
                        <p class="p">Each router in the network can issue network keys. As more routers and
                            devices join the network, the router will share the network keys to the
                            device joining the network.</p>

                    </li>

                    <li class="li" id="GUID-C8CD15B7-2156-4EF8-8D55-C879C829A34B__GUID-FAC90E9B-1093-4FF9-A795-CFAF45470DC7"><span class="indent-level-default">e.</span>
                        <p class="p">To participate in distributed security networks, all router and end
                            devices must be pre-conﬁgured with a link key that is used to encrypt
                            the network key when passing it from a router parent to a newly joined
                            node.</p>

                    </li>

                    <li class="li" id="GUID-C8CD15B7-2156-4EF8-8D55-C879C829A34B__GUID-FAC90E9B-1093-4FF9-A795-CFAF45470DC7"><span class="indent-level-default">f.</span>
                        <p class="p">All the devices in the network encrypt messages with the same network
                            key.</p>

                    </li>

                </ol>
</li>
<li class="li" id="GUID-C8CD15B7-2156-4EF8-8D55-C879C829A34B__GUID-0F2D92A5-BA97-47BA-AD5E-D489C60F0606"><span class="indent-level-default">2.</span><p class="p"><strong class="ph b">Centralized security model :</strong></p>
<ol class="ol" type="a" id="GUID-C8CD15B7-2156-4EF8-8D55-C879C829A34B__GUID-E7EC8463-3D92-408D-87C3-4C834CB66E1F"><li class="li" id="GUID-C8CD15B7-2156-4EF8-8D55-C879C829A34B__GUID-796AD766-252F-4E0D-86C7-59A04BC1ACC0"><span class="indent-level-default">a.</span><p class="p">Provides higher security and is also more complicated.</p>
</li>
<li class="li" id="GUID-C8CD15B7-2156-4EF8-8D55-C879C829A34B__GUID-B7D0F7E2-4E38-4310-9E9F-339D127525B3"><span class="indent-level-default">b.</span><p class="p">It includes a third device type, the Trust Center (TC), which is usually also the network coordinator.</p>
</li>
<li class="li" id="GUID-C8CD15B7-2156-4EF8-8D55-C879C829A34B__GUID-943CB55F-1577-4196-824B-94AF9B49A74D"><span class="indent-level-default">c.</span><p class="p">The Trust Center forms a centralized network, conﬁgures and authenticates routers and end devices to join a network.</p>
</li>
<li class="li" id="GUID-C8CD15B7-2156-4EF8-8D55-C879C829A34B__GUID-D4E3CDDA-A57D-4941-BA89-C9C0657212EF"><span class="indent-level-default">d.</span><p class="p">The TC establishes a unique TC Link Key for each device on the network as they join and link keys for each pair of devices as requested.</p>
</li>
<li class="li" id="GUID-C8CD15B7-2156-4EF8-8D55-C879C829A34B__GUID-DC435AA1-C886-45D6-A22A-AC4A1DC480F7"><span class="indent-level-default">e.</span><p class="p">The TC also determines the network key.</p>
</li>
<li class="li" id="GUID-C8CD15B7-2156-4EF8-8D55-C879C829A34B__GUID-F50CC72C-A994-4316-A87B-24181067B326"><span class="indent-level-default">f.</span><p class="p">To participate in a centralized security network model, all entities must be pre-conﬁgured with a link key that is used to encrypt the network key when passing it from the TC to a newly joined entity. Only TC can share the network key with the newly joining device.</p>
</li>
</ol>
</li>
</ol>
<p class="p">All non coordinator ZigBee nodes shall be able to join a network supporting either model and adapt to the security conditions of the network they are joining.</p>
<div class="fig fignone" id="GUID-C8CD15B7-2156-4EF8-8D55-C879C829A34B__FIG_QKP_CHH_VSB"><div class="figcap"><span class="fig--title-label">Figure 1. </span>Zigbee Security Model</div><br /><div class="imagecenter"><img class="image imagecenter" src="GUID-2345731B-EBE4-48E5-8C0C-6251765E0D65-low.jpg" /></div><br /></div>
</div>
<div class="related-links">
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a class="link" href="GUID-668A6CB2-F1FB-438D-9E1E-D67AC3C1C132.html" title="This is a generic document, which gives the user an overview of few key Zigbee 3.0 protocol concepts and guidance on implementing these features on PIC32CX-BZ/WBZ using Microchip software. It shows how the protocol configurations(such as application, device types, clusters, commissioning) can be enabled/disabled, configured in a step by step manner, using Microchip's embedded software development framework tools. Microchip Harmony Framework is a full-featured, production grade, embedded software development platform from Microchip. It provides a framework for creating zigbee devices running on PIC32CX-BZ/WBZ family of device and modules.">Getting Started with Zigbee Applications</a></div>
</div>
</div><div class="topic nested1" aria-labelledby="KEY-EXCHANGE-PROCESS-CENTRALISED-NETWORK__GUID-CD274753-7DA7-4C6C-8962-EC4D6682CB2B" id="KEY-EXCHANGE-PROCESS-CENTRALISED-NETWORK"><h2 class="title topictitle2" id="KEY-EXCHANGE-PROCESS-CENTRALISED-NETWORK__GUID-CD274753-7DA7-4C6C-8962-EC4D6682CB2B" style="">Key Exchange Process: Centralised Network</h2><div class="body"><p class="shortdesc">The diagram below shows how a device is allowed to join Zigbee 3.0 network via the key
            exchange process in a centralized security model based network :</p>
<ul class="ul"><li class="li" id="KEY-EXCHANGE-PROCESS-CENTRALISED-NETWORK__GUID-09F3633B-5F57-4970-B556-E0252DD914E5"><p class="p">The joiner device begins the join procedure by transmitting an unsecured beacon request frame (depending on whether the scan is an active or passive scan)</p>
</li>
<li class="li" id="KEY-EXCHANGE-PROCESS-CENTRALISED-NETWORK__GUID-C74B0003-87FF-4D80-9A3E-BBF2852FCB04"><p class="p">It receives beacons from nearby routers and the NWK layer primitives parameter i.e. NetworkList will indicate all of the nearby PANs.</p>
</li>
<li class="li" id="KEY-EXCHANGE-PROCESS-CENTRALISED-NETWORK__GUID-04262256-A1EB-4651-9DED-F249A7782785"><p class="p">The joiner device shall decide which PAN to join and shall issue an association request command to the router</p>
</li>
<li class="li" id="KEY-EXCHANGE-PROCESS-CENTRALISED-NETWORK__GUID-286670AC-EF8A-485E-985A-AE236C6D3764"><p class="p">Upon receipt of an association request command, the router shall issue an association response command to be sent to the joiner.</p>
</li>
<li class="li" id="KEY-EXCHANGE-PROCESS-CENTRALISED-NETWORK__GUID-41F04DE3-D824-47E6-9E32-0582E7F168D8"><p class="p">If the router is the Trust Center, it shall begin the authorization procedure by simply operating as a Trust Center. If the router is not the Trust Center, it shall begin the authorization procedure immediately by issuing an update device command request to the Trust Center.</p>
</li>
<li class="li" id="KEY-EXCHANGE-PROCESS-CENTRALISED-NETWORK__GUID-7C33D7E6-FE26-495B-B72C-1F8E0A824EBA"><p class="p">The Trust Center role in the authorization procedure shall be activated upon receipt of an incoming update-device command. It shall determine whether or not to allow the device onto the network. This decision will be based on its own security policies. If it decides to allow the device onto the network, it shall send the device the active network key.</p>
</li>
<li class="li" id="KEY-EXCHANGE-PROCESS-CENTRALISED-NETWORK__GUID-0A6BEF25-01E1-473D-804A-E324A292E8B7"><p class="p">Once the network-level security is set-up , application-level security needs be setup for more secure communication, which is mandated in Zigbee 3.0 and will be used for all ongoing APS-layer communication.</p>
</li>
</ul>
<div class="fig fignone" id="KEY-EXCHANGE-PROCESS-CENTRALISED-NETWORK__FIG_VJ2_4HH_VSB"><div class="figcap"><span class="fig--title-label">Figure 2. </span>Centralized Network</div><br /><div class="imagecenter"><img class="image imagecenter" src="GUID-6FC1045C-5A28-4BD0-B283-47EF8B2F78DD-low.jpg" /></div><br /></div>
</div>
</div>
<div class="topic nested1" aria-labelledby="KEY-EXCHANGE-PROCESS-DISTRIBUTED-NETWORK__GUID-1F24948B-F142-454C-964F-02118E581D34" id="KEY-EXCHANGE-PROCESS-DISTRIBUTED-NETWORK"><h2 class="title topictitle2" id="KEY-EXCHANGE-PROCESS-DISTRIBUTED-NETWORK__GUID-1F24948B-F142-454C-964F-02118E581D34" style="">Key Exchange Process: Distributed Network</h2><div class="body"><p class="shortdesc">The diagram shows how a device is allowed to join Zigbee 3.0 network in a distributed security model based network.</p>
<ul class="ul"><li class="li" id="KEY-EXCHANGE-PROCESS-DISTRIBUTED-NETWORK__GUID-16D2C31D-C0DB-4989-875E-75786A03A5FA"><p class="p">The joiner device begins the join procedure by transmitting an unsecured beacon request frame (depending on whether the scan is an active or passive scan)</p>
</li>
<li class="li" id="KEY-EXCHANGE-PROCESS-DISTRIBUTED-NETWORK__GUID-9B45DD78-8569-451E-A75E-7F8FC5D6C6A4"><p class="p">It receives beacons from nearby routers and the NWK layer primitives parameter i.e. NetworkList will indicate all of the nearby PANs.</p>
</li>
<li class="li" id="KEY-EXCHANGE-PROCESS-DISTRIBUTED-NETWORK__GUID-0851E4F8-D6EA-4E0D-846B-5649637AA3F8"><p class="p">The joiner device shall decide which PAN to join and shall issue an association request or rejoin request command to the router</p>
</li>
<li class="li" id="KEY-EXCHANGE-PROCESS-DISTRIBUTED-NETWORK__GUID-3E053674-8E73-457A-B81A-3E1BD2E9A9FE"><p class="p">Upon receipt of an association request command, the router shall issue an association response command to be sent to the joiner.</p>
</li>
<li class="li" id="KEY-EXCHANGE-PROCESS-DISTRIBUTED-NETWORK__GUID-69B90310-5E30-4684-8C1D-0228F3CC3141"><p class="p">The router itself shall begin the authorization procedure. It shall determine whether or not to allow the device onto the network. This decision will be based on its own security policies. If it decides to allow the device onto the network, it shall send the device the active network key.</p>
</li>
<li class="li" id="KEY-EXCHANGE-PROCESS-DISTRIBUTED-NETWORK__GUID-4E3B0811-F596-493D-A5FB-FBE2C32F6152"><p class="p">Once the network-level security is set-up , application-level security needs be setup for more secure communication, which is mandated in Zigbee 3.0 and will be used for all ongoing APS-layer communication.</p>
</li>
</ul>
<div class="fig fignone" id="KEY-EXCHANGE-PROCESS-DISTRIBUTED-NETWORK__FIG_CQ5_QHH_VSB"><div class="figcap"><span class="fig--title-label">Figure 3. </span>Distributed Network</div><br /><div class="imagecenter"><img class="image imagecenter" src="GUID-32D478A9-7275-413D-AE11-83821F177B49-low.jpg" /></div><br /></div>
<p class="p">For more details regarding the network security models, please refer to, the Security section of the base device behaviour specification from Zigbee Alliance -&gt; <a class="xref" href="https://zigbeealliance.org/developer_resources/zigbee-base-device-behavior-bdb-v1-0/" target="_blank">Link to Base Device Behaviour Specification by Zigbee Alliance</a></p>
</div>
</div>
<div class="topic nested1" aria-labelledby="EXAMPLE-LOGS__GUID-048E58FE-438C-4E0C-AC82-8B4BDA2668ED" id="EXAMPLE-LOGS"><h2 class="title topictitle2" id="EXAMPLE-LOGS__GUID-048E58FE-438C-4E0C-AC82-8B4BDA2668ED" style="">Example Logs</h2><div class="body"><p class="shortdesc">Let us realize the concept of centralized network with the help of Combined Interface device (Zigbee Coordinator) and Thermostat(Zigbee router). Once the coordinator is powered-on, it forms a centralized network. The router which is powered on later, will join the already existing network. Now, the router is capable of supporting other new end devices to join the network via association process etc.</p>
<div class="p">Shows the console output from a Combined Interface Application which is a Zigbee coordinator device type and a Thermostat application which is a Zigbee router device type.<br /><div class="imagecenter"><img class="image imagecenter" src="GUID-7CCF43B0-32A6-4347-8C37-13E9F6C52B5F-low.png" /></div><br /></div>
<p class="p">The ZLO lights has the capability of forming its own network, though they are routers. If Extended Lights(Zigbee router) was powered-on earlier to the coordinator, it wouldn't be able to find any network to join. In the absence, it will create a distributed network. Any end device/router shall be able to join the network via appropriate authentication process.</p>
<p class="p">Shows the console output from a Extended Light Application (Zigbee router) establishes a Distributed Network. A Color Scene controller (Zigbee end device) joins the network :</p>
<br /><div class="imagecenter"><img class="image imagecenter" src="GUID-AA307522-CCB8-456E-91BD-CF25A4D5ED61-low.png" /></div><br /></div>
</div>
</body>
</html>