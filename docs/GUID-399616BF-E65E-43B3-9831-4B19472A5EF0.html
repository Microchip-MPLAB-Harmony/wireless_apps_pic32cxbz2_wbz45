<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us" data-whc_version="24.1">
    <head><link rel="shortcut icon" href="oxygen-webhelp\template\resources/images/favicon.ico"/><link rel="icon" href="oxygen-webhelp\template\resources/images/favicon.ico"/><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="description" content="Introduction A bootloader is a small application that can be used to upgrade firmware on a target device without the need for an external programmer or debugger. For PIC32CXBZ2 standalone bootloader, ..."/><meta name="copyright" content="(C) Copyright 2023"/><meta name="generator" content="DITA-OT"/><title>13.1 Bootloader</title><!--  Generated with Oxygen version 24.1, build number 2022062014.  --><meta name="wh-path2root" content=""/><meta name="wh-toc-id" content="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0-d1766e861"/><meta name="wh-source-relpath" content="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0.xml"/><meta name="wh-out-relpath" content="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0.html"/>
    <!-- Latest compiled and minified Bootstrap CSS -->
    <link rel="stylesheet" type="text/css" href="./oxygen-webhelp/lib/bootstrap/css/bootstrap.min.css"/>
    
    <link rel="stylesheet" href="./oxygen-webhelp/lib/jquery-ui/jquery-ui.min.css"/>
    
    <!-- Template default styles  -->
    <link rel="stylesheet" type="text/css" href="./oxygen-webhelp/app/topic-page.css?buildId=2022062014"/>
    
    
    <script src="./oxygen-webhelp/lib/jquery/jquery-3.5.1.min.js"></script>
    
    <script data-main="./oxygen-webhelp/app/topic-page.js" src="./oxygen-webhelp/lib/requirejs/require.js"></script>
<link rel="stylesheet" type="text/css" href="oxygen-webhelp/template/microchip.css?buildId=2022062014"/><link rel="stylesheet" type="text/css" href="oxygen-webhelp/template/notes.css?buildId=2022062014"/>
<script src="mchp-context-help.js"></script>
<link href="https://fonts.googleapis.com/css?family=Open+Sans:400,600,300" rel="stylesheet" type="text/css"/>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async="" type="text/javascript"></script>
    <script src="https://assets.adobedtm.com/6a72a357eb48/a636c708c7fe/launch-0b0023397020.min.js"></script><!-- Adobe Analytics -->
</head>

    <body id="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0" class="wh_topic_page frmBody">
        <a href="#wh_topic_body" class="sr-only sr-only-focusable">
            Jump to main content
        </a>
        
        
        
        
        <header class="navbar navbar-default wh_header">
    <div class="container-fluid">
        <div class="wh_header_flex_container navbar-nav navbar-expand-md navbar-dark">
            <div class="wh_logo_and_publication_title_container">
                <div class="wh_logo_and_publication_title">
                    
                    <a href="index.html" class=" wh_logo d-none d-sm-block "><img src="oxygen-webhelp\template\resources/images/microchip.png" alt="PIC32CXBZ2 Application Developer's Guide "/></a>
                    <div class=" wh_publication_title "><a href="index.html">PIC32CXBZ2 Application Developer's Guide </a></div>
                    
                </div>
                
                
            </div>

            <div class="wh_top_menu_and_indexterms_link collapse navbar-collapse" id="wh_top_menu_and_indexterms_link">
                
                
                
                
            </div>
        </div>
    </div>
</header>
        
        
         
        
        <div class=" wh_search_input navbar-form wh_topic_page_search search " role="form">
            
            
            
            <form id="searchForm" method="get" role="search" action="search.html"><div class="d-flex justify-contents-around"><div class="flex-grow-1"></div><div class="position-relative flex-grow-1"><input type="search" placeholder="Search " class="wh_search_textfield" id="textToSearch" name="searchQuery" aria-label="Search query" required="required"/><button type="submit" class="wh_search_button" aria-label="Search"><span class="search_input_text">Search</span></button></div><div class="align-self-center flex-grow-1 ml-2"><div class="d-flex justify-content-end"><div class="dropdown"><a style="font-size: 1em; padding: 7px 12px !important;" class="btn py-3 px-3 btn-outline-light dropdown-toggle" href="#" role="button" id="devicesMenu" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Product Pages</a><div style="font-size: 1em;" class="dropdown-menu" aria-labelledby="devicesMenu"><a class="dropdown-item" target="_blank" href="https://www.microchip.com/en-us/product/pic32cx-bz2">PIC32CX-BZ2</a><a class="dropdown-item" target="_blank" href="https://www.microchip.com/en-us/product/wbz451"> WBZ451</a></div></div></div></div></div></form>
            
            <div class="mchp-color-stripe-grid-container">
  <div class="mchp-main-bar mchp-orange-bar"></div>
  <div class="mchp-main-bar mchp-blue-bar"></div>
  <div class="mchp-main-bar mchp-green-bar"></div>
</div>
            
        </div>
        
        <div class="container-fluid" id="wh_topic_container">
            <div class="row">

                <nav class="wh_tools d-print-none navbar-expand-md" aria-label="Tools">
                    
                    <div data-tooltip-position="bottom" class=" wh_breadcrumb "><ol class="d-print-none"><li><span class="home"><a href="index.html"><span>Home</span></a></span></li><li><div class="topicref" data-id="GUID-D7A53CEA-74B4-4CAA-A5D4-F69980188D1B"><div class="title"><a href="GUID-D7A53CEA-74B4-4CAA-A5D4-F69980188D1B.html"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">13</ph>
How-to: Firmware and OTA Updates</a><div class="wh-tooltip"><p class="shortdesc">This section documents how to enable FW updates in your design, whether its serial or over the air</p></div></div></div></li><li class="active"><div class="topicref" data-id="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0"><div class="title"><a href="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0.html"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">13.1</ph>
Bootloader</a></div></div></li></ol></div>
                    
                    
                    
                    <div class="wh_right_tools">
                        <button class="wh_hide_highlight" aria-label="Toggle search highlights" title="Toggle search highlights"></button>
                        <button class="webhelp_expand_collapse_sections" data-next-state="collapsed" aria-label="Collapse sections" title="Collapse sections"></button>
                        
                        
                        
                        
                        <div class=" wh_print_link print d-none d-md-inline-block "><button onClick="window.print()" title="Print this page" aria-label="Print this page"></button></div>
                        
                        <button type="button" id="wh_toc_button" class="custom-toggler navbar-toggler collapsed wh_toggle_button navbar-light" aria-expanded="false" aria-label="Toggle publishing table of content" aria-controls="wh_publication_toc">
                            <span class="navbar-toggler-icon"></span>
                        </button>
                    </div>
                    
                </nav>
            </div>
            
            
            
            
            <div class="wh_content_area">
                <div class="row">
                    
                        <nav id="wh_publication_toc" class="col-lg-3 col-md-3 col-sm-12 d-md-block d-none d-print-none" aria-label="Table of Contents Container">
                            <div id="wh_publication_toc_content">
		                        
                            	<div class=" wh_publication_toc " data-tooltip-position="right"><span class="expand-button-action-labels"><span id="button-expand-action" role="button" aria-label="Expand"></span><span id="button-collapse-action" role="button" aria-label="Collapse"></span><span id="button-pending-action" role="button" aria-label="Pending"></span></span><ul role="tree" aria-label="Table of Contents"><li role="treeitem"><div data-tocid="GUID-7663617B-0DD1-45FA-86B5-EB0778A5A424-d1766e9" class="topicref introduction" data-id="GUID-7663617B-0DD1-45FA-86B5-EB0778A5A424" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="GUID-7663617B-0DD1-45FA-86B5-EB0778A5A424.html" id="GUID-7663617B-0DD1-45FA-86B5-EB0778A5A424-d1766e9-link">Introduction</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="GUID-C0EB31FA-0642-4A8C-8974-E4DD62E36633-d1766e17" class="topicref" data-id="GUID-C0EB31FA-0642-4A8C-8974-E4DD62E36633" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action GUID-C0EB31FA-0642-4A8C-8974-E4DD62E36633-d1766e17-link" class="wh-expand-btn"></span><div class="title"><a href="GUID-C0EB31FA-0642-4A8C-8974-E4DD62E36633.html" id="GUID-C0EB31FA-0642-4A8C-8974-E4DD62E36633-d1766e17-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">1</ph>
Quick references </a><div class="wh-tooltip"><p class="shortdesc">Enter a short description of your topic here (optional).</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="GUID-4A40968E-8B6E-4C84-93B9-D31419BBBDA6-d1766e39" class="topicref" data-id="GUID-4A40968E-8B6E-4C84-93B9-D31419BBBDA6" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action GUID-4A40968E-8B6E-4C84-93B9-D31419BBBDA6-d1766e39-link" class="wh-expand-btn"></span><div class="title"><a href="GUID-4A40968E-8B6E-4C84-93B9-D31419BBBDA6.html" id="GUID-4A40968E-8B6E-4C84-93B9-D31419BBBDA6-d1766e39-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">2</ph>
Getting Started with WBZ451 Curiosity Board</a><div class="wh-tooltip"><p class="shortdesc">This section covers the evaluation board features and running the preprogrammed demo         example. </p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="GUID-2AD37FE2-1915-4E34-9A05-79E3810726D7-d1766e109" class="topicref" data-id="GUID-2AD37FE2-1915-4E34-9A05-79E3810726D7" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action GUID-2AD37FE2-1915-4E34-9A05-79E3810726D7-d1766e109-link" class="wh-expand-btn"></span><div class="title"><a href="GUID-2AD37FE2-1915-4E34-9A05-79E3810726D7.html" id="GUID-2AD37FE2-1915-4E34-9A05-79E3810726D7-d1766e109-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">3</ph>
Getting Started with Software Development</a><div class="wh-tooltip"><p class="shortdesc">This section gives a detailed information on the steps to install IDE, compiler, tool         chain, BLE, Zigbee stacks and application examples on the PC. </p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="GUID-3CC3561E-252E-43B9-BC8A-47DD108A0A46-d1766e212" class="topicref" data-id="GUID-3CC3561E-252E-43B9-BC8A-47DD108A0A46" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action GUID-3CC3561E-252E-43B9-BC8A-47DD108A0A46-d1766e212-link" class="wh-expand-btn"></span><div class="title"><a href="GUID-3CC3561E-252E-43B9-BC8A-47DD108A0A46.html" id="GUID-3CC3561E-252E-43B9-BC8A-47DD108A0A46-d1766e212-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">4</ph>
Bluetooth Low Energy Applications</a><div class="wh-tooltip"><p class="shortdesc">This section provides details on documentation describing the steps to test and develop         the precompiled BLE application examples. </p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="GUID-668A6CB2-F1FB-438D-9E1E-D67AC3C1C132-d1766e491" class="topicref" data-id="GUID-668A6CB2-F1FB-438D-9E1E-D67AC3C1C132" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action GUID-668A6CB2-F1FB-438D-9E1E-D67AC3C1C132-d1766e491-link" class="wh-expand-btn"></span><div class="title"><a href="GUID-668A6CB2-F1FB-438D-9E1E-D67AC3C1C132.html" id="GUID-668A6CB2-F1FB-438D-9E1E-D67AC3C1C132-d1766e491-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">5</ph>
Getting Started with Zigbee Applications</a><div class="wh-tooltip"><p class="shortdesc">This is a generic document, which gives the user an overview of few key Zigbee 3.0 protocol concepts and guidance on implementing these features on PIC32CX-BZ/WBZ using Microchip software. It shows how the protocol configurations(such as application, device types, clusters, commissioning) can be enabled/disabled, configured in a step by step manner, using Microchip's embedded software development framework tools. Microchip Harmony Framework is a full-featured, production grade, embedded software development platform from Microchip. It provides a framework for creating zigbee devices running on PIC32CX-BZ/WBZ family of device and modules.</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="GUID-2A54CAC1-1370-4448-8768-E6C7B8CFCA23-d1766e638" class="topicref" data-id="GUID-2A54CAC1-1370-4448-8768-E6C7B8CFCA23" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action GUID-2A54CAC1-1370-4448-8768-E6C7B8CFCA23-d1766e638-link" class="wh-expand-btn"></span><div class="title"><a href="GUID-2A54CAC1-1370-4448-8768-E6C7B8CFCA23.html" id="GUID-2A54CAC1-1370-4448-8768-E6C7B8CFCA23-d1766e638-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">6</ph>
Getting Started With Multiprotocol Applications</a><div class="wh-tooltip"><p class="shortdesc">Documentation describing steps to test and develop the precompiled BLE and Zigbee coexistence application examples.</p></div></div></div></li><li role="treeitem"><div data-tocid="GUID-64131DE4-2C60-4116-A206-EF72A41E71CE-d1766e689" class="topicref" data-id="GUID-64131DE4-2C60-4116-A206-EF72A41E71CE" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="GUID-64131DE4-2C60-4116-A206-EF72A41E71CE.html" id="GUID-64131DE4-2C60-4116-A206-EF72A41E71CE-d1766e689-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">7</ph>
Flashing hex from MPLAB DISCOVER using MPLAB IPE</a><div class="wh-tooltip"><p class="shortdesc">This section provides a detailed procedure of how to download an already existing     application hex file from MPLAB DISCOVER and flash the hex file into WBZ451 Curiosity Board     using MPLAB IPE.</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="GUID-3E242310-437D-4F50-9E63-3C9EF144CD18-d1766e700" class="topicref" data-id="GUID-3E242310-437D-4F50-9E63-3C9EF144CD18" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action GUID-3E242310-437D-4F50-9E63-3C9EF144CD18-d1766e700-link" class="wh-expand-btn"></span><div class="title"><a href="GUID-3E242310-437D-4F50-9E63-3C9EF144CD18.html" id="GUID-3E242310-437D-4F50-9E63-3C9EF144CD18-d1766e700-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">8</ph>
 Getting Started with IEEE 802.15.4 P2P Phy Application</a></div></div></li><li role="treeitem"><div data-tocid="GUID-5C1924BD-FC6E-4FD5-9786-55FDC1B4035A-d1766e756" class="topicref" data-id="GUID-5C1924BD-FC6E-4FD5-9786-55FDC1B4035A" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="GUID-5C1924BD-FC6E-4FD5-9786-55FDC1B4035A.html" id="GUID-5C1924BD-FC6E-4FD5-9786-55FDC1B4035A-d1766e756-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">9</ph>
Getting Started with IEEE 802.15.4 MAC Applications</a></div></div></li><li role="treeitem"><div data-tocid="GUID-7B76D0ED-C32B-48B0-AA3C-51B27787BF2B-d1766e765" class="topicref" data-id="GUID-7B76D0ED-C32B-48B0-AA3C-51B27787BF2B" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="GUID-7B76D0ED-C32B-48B0-AA3C-51B27787BF2B.html" id="GUID-7B76D0ED-C32B-48B0-AA3C-51B27787BF2B-d1766e765-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">10</ph>
Getting started with Thread Applications</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="GUID-B9333775-2F34-4B60-9429-E1B1B7F505FD-d1766e773" class="topicref" data-id="GUID-B9333775-2F34-4B60-9429-E1B1B7F505FD" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action GUID-B9333775-2F34-4B60-9429-E1B1B7F505FD-d1766e773-link" class="wh-expand-btn"></span><div class="title"><a href="GUID-B9333775-2F34-4B60-9429-E1B1B7F505FD.html" id="GUID-B9333775-2F34-4B60-9429-E1B1B7F505FD-d1766e773-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">11</ph>
How-to: Adding Chip Peripherals</a><div class="wh-tooltip"><p class="shortdesc">Guidance on how to add analog/digital peripherals to your application</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="GUID-F9A40E74-7127-4C2C-B480-2746007AAEAE-d1766e818" class="topicref" data-id="GUID-F9A40E74-7127-4C2C-B480-2746007AAEAE" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action GUID-F9A40E74-7127-4C2C-B480-2746007AAEAE-d1766e818-link" class="wh-expand-btn"></span><div class="title"><a href="GUID-F9A40E74-7127-4C2C-B480-2746007AAEAE.html" id="GUID-F9A40E74-7127-4C2C-B480-2746007AAEAE-d1766e818-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">12</ph>
How-to: Low Power Design</a><div class="wh-tooltip"><p class="shortdesc">Enable low power modes - Sleep/Standby or Deep Sleep/Backup Modes in your design</p></div></div></div></li><li role="treeitem" aria-expanded="true"><div data-tocid="GUID-D7A53CEA-74B4-4CAA-A5D4-F69980188D1B-d1766e850" class="topicref" data-id="GUID-D7A53CEA-74B4-4CAA-A5D4-F69980188D1B" data-state="expanded"><span role="button" tabindex="0" aria-labelledby="button-collapse-action GUID-D7A53CEA-74B4-4CAA-A5D4-F69980188D1B-d1766e850-link" class="wh-expand-btn"></span><div class="title"><a href="GUID-D7A53CEA-74B4-4CAA-A5D4-F69980188D1B.html" id="GUID-D7A53CEA-74B4-4CAA-A5D4-F69980188D1B-d1766e850-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">13</ph>
How-to: Firmware and OTA Updates</a><div class="wh-tooltip"><p class="shortdesc">This section documents how to enable FW updates in your design, whether its serial or over the air</p></div></div></div><ul role="group" class="navbar-nav nav-list"><li role="treeitem" class="active"><div data-tocid="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0-d1766e861" class="topicref" data-id="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0.html" id="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0-d1766e861-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">13.1</ph>
Bootloader</a></div></div></li><li role="treeitem"><div data-tocid="GUID-003E64BA-98A3-40EA-8417-ED7F09C14761-d1766e869" class="topicref" data-id="GUID-003E64BA-98A3-40EA-8417-ED7F09C14761" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="GUID-003E64BA-98A3-40EA-8417-ED7F09C14761.html" id="GUID-003E64BA-98A3-40EA-8417-ED7F09C14761-d1766e869-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">13.2</ph>
Device Firmware Upgrade Over Serial</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="GUID-908446A4-F490-4063-9096-66C4831F9BE4-d1766e877" class="topicref" data-id="GUID-908446A4-F490-4063-9096-66C4831F9BE4" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action GUID-908446A4-F490-4063-9096-66C4831F9BE4-d1766e877-link" class="wh-expand-btn"></span><div class="title"><a href="GUID-908446A4-F490-4063-9096-66C4831F9BE4.html" id="GUID-908446A4-F490-4063-9096-66C4831F9BE4-d1766e877-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">13.3</ph>
Device Firmware Upgrade Over BLE</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="GUID-FC914BE3-2FDF-44C2-9611-A500FBF9A3A6-d1766e997" class="topicref" data-id="GUID-FC914BE3-2FDF-44C2-9611-A500FBF9A3A6" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action GUID-FC914BE3-2FDF-44C2-9611-A500FBF9A3A6-d1766e997-link" class="wh-expand-btn"></span><div class="title"><a href="GUID-FC914BE3-2FDF-44C2-9611-A500FBF9A3A6.html" id="GUID-FC914BE3-2FDF-44C2-9611-A500FBF9A3A6-d1766e997-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">13.4</ph>
Device Firmware Upgrade Over Zigbee Link</a><div class="wh-tooltip"><p class="shortdesc"></p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="GUID-A3F96AEA-7517-4859-9799-149B152B5BC4-d1766e1189" class="topicref" data-id="GUID-A3F96AEA-7517-4859-9799-149B152B5BC4" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action GUID-A3F96AEA-7517-4859-9799-149B152B5BC4-d1766e1189-link" class="wh-expand-btn"></span><div class="title"><a href="GUID-A3F96AEA-7517-4859-9799-149B152B5BC4.html" id="GUID-A3F96AEA-7517-4859-9799-149B152B5BC4-d1766e1189-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">13.5</ph>
Microchip Utility Tool</a><div class="wh-tooltip"><p class="shortdesc">Microchip Utility Tool is windows based GUI Tool used for firmware upgrade.</p></div></div></div></li></ul></li><li role="treeitem" aria-expanded="false"><div data-tocid="GUID-E1A30ECC-1212-4B25-AE72-7EAF982C6D50-d1766e1261" class="topicref" data-id="GUID-E1A30ECC-1212-4B25-AE72-7EAF982C6D50" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action GUID-E1A30ECC-1212-4B25-AE72-7EAF982C6D50-d1766e1261-link" class="wh-expand-btn"></span><div class="title"><a href="GUID-E1A30ECC-1212-4B25-AE72-7EAF982C6D50.html" id="GUID-E1A30ECC-1212-4B25-AE72-7EAF982C6D50-d1766e1261-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">14</ph>
Wireless System Services API</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="GUID-5FC6D5A2-B8C3-4AD8-AC31-0AABE237A2F7-d1766e1950" class="topicref" data-id="GUID-5FC6D5A2-B8C3-4AD8-AC31-0AABE237A2F7" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action GUID-5FC6D5A2-B8C3-4AD8-AC31-0AABE237A2F7-d1766e1950-link" class="wh-expand-btn"></span><div class="title"><a href="GUID-5FC6D5A2-B8C3-4AD8-AC31-0AABE237A2F7.html" id="GUID-5FC6D5A2-B8C3-4AD8-AC31-0AABE237A2F7-d1766e1950-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">15</ph>
Support Documentation</a><div class="wh-tooltip"><p class="shortdesc">This section has documentation that is generic and used as supporting document with our application example documentation</p></div></div></div></li><li role="treeitem"><div data-tocid="GUID-BA0204D8-EFF0-4932-830D-73E2A72614A0-d1766e1998" class="topicref" data-id="GUID-BA0204D8-EFF0-4932-830D-73E2A72614A0" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="GUID-BA0204D8-EFF0-4932-830D-73E2A72614A0.html" id="GUID-BA0204D8-EFF0-4932-830D-73E2A72614A0-d1766e1998-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">16</ph>
Porting Guide for WBZ451 to PIC32CX1012BZ25048</a></div></div></li><li role="treeitem"><div data-tocid="GUID-A1E48517-2E8D-4E14-B1BB-B3541DB0DA27-d1766e2006" class="topicref" data-id="GUID-A1E48517-2E8D-4E14-B1BB-B3541DB0DA27" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="GUID-A1E48517-2E8D-4E14-B1BB-B3541DB0DA27.html" id="GUID-A1E48517-2E8D-4E14-B1BB-B3541DB0DA27-d1766e2006-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">17</ph>
Porting Guide for WBZ451 to WBZ450</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="GUID-0FB3F908-88EE-45CE-94F5-E97AF9049C9B-d1766e2014" class="topicref backmatter backmatter_parent" data-id="GUID-0FB3F908-88EE-45CE-94F5-E97AF9049C9B" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action GUID-0FB3F908-88EE-45CE-94F5-E97AF9049C9B-d1766e2014-link" class="wh-expand-btn"></span><div class="title"><a href="GUID-0FB3F908-88EE-45CE-94F5-E97AF9049C9B.html" id="GUID-0FB3F908-88EE-45CE-94F5-E97AF9049C9B-d1766e2014-link">Microchip Information</a></div></div></li></ul></div>
		                        
                            </div>
                        </nav>
                    
                    
                    <div class="col-lg-7 col-md-9 col-sm-12" id="wh_topic_body">
                        <button id="wh_close_publication_toc_button" class="close-toc-button d-none" aria-label="Toggle publishing table of content" aria-controls="wh_publication_toc" aria-expanded="true">
                            <span class="close-toc-icon-container">
                                <span class="close-toc-icon"></span>     
                            </span>
                        </button>
                        <button id="wh_close_topic_toc_button" class="close-toc-button d-none" aria-label="Toggle topic table of content" aria-controls="wh_topic_toc" aria-expanded="true">
                            <span class="close-toc-icon-container">
                                <span class="close-toc-icon"></span>     
                            </span>
                        </button>
                        
                        <div class=" wh_topic_content body "><main role="main"><article role="article" aria-labelledby="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-76569EDE-DE56-4437-A0D2-7F390629F5C3"><h1 class="- topic/title title topictitle1" id="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-76569EDE-DE56-4437-A0D2-7F390629F5C3" style="">13.1 Bootloader</h1><div class="- topic/body body"><section class="- topic/section section" id="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-4600C314-6BE7-4ABC-90C1-CFB163261393" data-ofbid="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-4600C314-6BE7-4ABC-90C1-CFB163261393"><h2 class="- topic/title title sectiontitle">Introduction</h2></section><p class="- topic/p p">A bootloader is a small application that can be used to upgrade firmware on a target device without the need for an external programmer or debugger. For <span class="- topic/ph ph">PIC32CXBZ2</span> standalone bootloader, it provides below functionalities:</p><div class="- topic/p p"><ul class="- topic/ul ul"><li class="- topic/li li" id="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-8C64D30D-A8F2-4B71-BA53-0F4FD7026C6D" data-ofbid="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-8C64D30D-A8F2-4B71-BA53-0F4FD7026C6D"><p class="- topic/p p">Device Firmware Upgrade over Serial(UART) interface, this is also called DFU over Serial.</p></li><li class="- topic/li li" id="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-A6220AE1-1DDD-43B6-972C-F31FBE865205" data-ofbid="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-A6220AE1-1DDD-43B6-972C-F31FBE865205"><p class="- topic/p p">Provide functionality support for wireless Over The Air Update, which is also called OTAU.</p></li><li class="- topic/li li" id="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-B7AC6154-26B5-4182-B6A8-F890CE06EA87" data-ofbid="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-B7AC6154-26B5-4182-B6A8-F890CE06EA87"><p class="- topic/p p">Provide various approaches to verify and authenticate firmware if enabled.</p></li><li class="- topic/li li" id="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-5BCA89F5-69F6-4E62-80FA-DA57A5E06DC0" data-ofbid="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-5BCA89F5-69F6-4E62-80FA-DA57A5E06DC0"><p class="- topic/p p">Display Console message if enabled</p></li></ul></div><section class="- topic/section section" id="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-881DEB27-9C11-4617-9B56-8B4E7D0E4829" data-ofbid="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-881DEB27-9C11-4617-9B56-8B4E7D0E4829"><h2 class="- topic/title title sectiontitle"><span class="- topic/ph ph">PIC32CXBZ2</span> Standalone Bootloader Component</h2></section><p class="- topic/p p"><span class="- topic/ph ph">PIC32CXBZ2</span> bootloader is a standalone Harmony component used to configure bootloader code for <span class="- topic/ph ph">PIC32CXBZ2</span> device. Click <a class="- topic/xref xref" href="https://onlinedocs.microchip.com/pr/GUID-2085FE66-A762-4CC0-B054-7F98E8AF999A-en-US-2/index.html?GUID-A04B5B1F-202B-4944-B18F-13E4857CC3CD" target="_blank" rel="external noopener">here</a> to know about <span class="- topic/ph ph">PIC32CXBZ2</span> standalone bootloader component, user can find more information as listed below:</p><ul class="- topic/ul ul"><li class="- topic/li li" id="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-54C7C89D-D04E-4F9B-9C45-F0191BC94C8E" data-ofbid="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-54C7C89D-D04E-4F9B-9C45-F0191BC94C8E"><p class="- topic/p p">Memory layout of <span class="- topic/ph ph">PIC32CXBZ2</span> device</p></li><li class="- topic/li li" id="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-49BA3F24-FCCF-4060-A056-85353520CF30" data-ofbid="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-49BA3F24-FCCF-4060-A056-85353520CF30"><p class="- topic/p p">Boot memory information</p></li><li class="- topic/li li" id="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-DE51FEE1-4AF7-44DD-9D31-3E933D5FE586" data-ofbid="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-DE51FEE1-4AF7-44DD-9D31-3E933D5FE586"><p class="- topic/p p">Image metadata definition</p></li><li class="- topic/li li" id="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-F4A18F38-C1C5-4EBB-AEE1-8979E9131001" data-ofbid="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-F4A18F38-C1C5-4EBB-AEE1-8979E9131001"><p class="- topic/p p">Working of Bootloader</p></li><li class="- topic/li li" id="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-C05D71D6-1957-4E4B-AC13-AE31432AB4FA" data-ofbid="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-C05D71D6-1957-4E4B-AC13-AE31432AB4FA"><p class="- topic/p p">Flow diagram of Bootloader</p></li><li class="- topic/li li" id="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-1A7FED54-FB44-4576-B46C-42063A969E29" data-ofbid="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-1A7FED54-FB44-4576-B46C-42063A969E29"><p class="- topic/p p">Bootloader configuration options</p></li><li class="- topic/li li" id="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-A48894C3-96EA-4661-BD1B-930C1BB51076" data-ofbid="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-A48894C3-96EA-4661-BD1B-930C1BB51076"><p class="- topic/p p">Bootloader and DFU API usage</p></li></ul><section class="- topic/section section" id="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-8BB1D890-221C-46E7-A103-BC77B130A573" data-ofbid="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-8BB1D890-221C-46E7-A103-BC77B130A573"><h2 class="- topic/title title sectiontitle">Bootloader Example Code</h2></section><p class="- topic/p p">PIC32CX-BZ2/WB45 bootloader provided two methods to enter DFU mode, one is GPIO Trigger, another is Timber Based Trigger. Later section will have more detailed information about them.</p><p class="- topic/p p">For bootloader using GPIO Trigger method, user can find example code in <em class="+ topic/ph hi-d/i ph i">wireless_apps_pic32cxbz2_wbz45\apps\bootloader\bootloader</em>, and precompiled hex file at <em class="+ topic/ph hi-d/i ph i">wireless_apps_pic32cxbz2_wbz45\apps\bootloader\bootloader\precompiled_hex\bootloader.X.production.hex</em></p><p class="- topic/p p">For bootloader using Timer Based Trigger method, user can find a precompiled hex file at <em class="+ topic/ph hi-d/i ph i">wireless_apps_pic32cxbz2_wbz45\apps\bootloader\bootloader\precompiled_hex\bootloader_timer.X.production.hex</em>. Since Timer Based Trigger bootloader creation is very similar to GPIO Trigger, there is no example code provided for it.</p><section class="- topic/section section" id="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-8A406025-673D-4A19-9E25-F3D42627031A" data-ofbid="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-8A406025-673D-4A19-9E25-F3D42627031A"><h2 class="- topic/title title sectiontitle">Creating Bootloader From Scratch Using MCC</h2></section><p class="- topic/p p">This section explains the steps required by a user to configure and generate a <span class="- topic/ph ph">PIC32CXBZ2</span> standalone bootloader from scratching using MCC. User can find the bootloader example code(GPIO Trigger) generated using MCC in the path <strong class="+ topic/ph hi-d/b ph b">wireless_apps_pic32cxbz2_wbz45\apps\bootloader\bootloader</strong></p><div class="- topic/p p">Generated Bootloader example has the following configurations:<ul class="- topic/ul ul"><li class="- topic/li li" id="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-889624CC-1A35-467E-9430-155A7AE5BED6" data-ofbid="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-889624CC-1A35-467E-9430-155A7AE5BED6"><p class="- topic/p p">Enabled UART DFU</p></li><li class="- topic/li li" id="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-988A8E03-820E-4367-84A2-591F8BFC3239" data-ofbid="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-988A8E03-820E-4367-84A2-591F8BFC3239"><p class="- topic/p p">Enabled console to display messages</p></li><li class="- topic/li li" id="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-988A8E03-820E-4367-84A2-591F8BFC3239" data-ofbid="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-988A8E03-820E-4367-84A2-591F8BFC3239"><p class="- topic/p p">Enabled GPIO Trigger</p></li><li class="- topic/li li" id="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-0BB4E5B2-36F0-4574-98B8-AD00DA890652" data-ofbid="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-0BB4E5B2-36F0-4574-98B8-AD00DA890652"><p class="- topic/p p">Hardware requried is <strong class="+ topic/ph hi-d/b ph b"><span class="- topic/ph ph">WBZ451</span> Curiosity Board,</strong> DFU mode is triggered by pressing SW2(GPIO PB4) on the board</p></li><li class="- topic/li li" id="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-0BB4E5B2-36F0-4574-98B8-AD00DA890652" data-ofbid="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-0BB4E5B2-36F0-4574-98B8-AD00DA890652"><p class="- topic/p p">Automatically reboot firmware after DFU is finished</p></li></ul><strong class="+ topic/ph hi-d/b ph b"><span class="- topic/ph ph">WBZ451</span> Curiosity Board</strong> is the hardware required to run this bootloader example, the board top view is shown in figure-1.</div><div class="- topic/p p"><figure class="- topic/fig fig fignone" id="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-5D1FED83-7F2E-4FB0-A3F4-0AA9B3C4BA95" data-ofbid="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-5D1FED83-7F2E-4FB0-A3F4-0AA9B3C4BA95"><figcaption class="- topic/title title figcap"><span class="figtitleprefix fig--title-label">Figure 13-1. <span id="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-274AC713-B3A2-4C5C-96A5-83A8CC4D09F5" class="fig--title"><span class="- topic/ph ph">WBZ451</span> Curiosity Board</span></span>. <span class="- topic/desc desc figdesc"><p class="- topic/p p"><span class="- topic/ph ph">WBZ451</span> Curiosity Board Top View</p></span></figcaption><div class=""><img class="- topic/image image" src="GUID-B266746C-E9EE-414F-A0D2-B491E92E6DD8-high.jpg"/></div></figure></div><p class="- topic/p p">Followings are steps to create the bootloader example(GPIO Trigger) from scratch.</p><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">Tip:</strong> New users of MPLAB Code Configurator are recommended to go through the <a class="- topic/xref xref" href="https://onlinedocs.microchip.com/pr/GUID-1F7007B8-9A46-4D03-AEED-650357BA760D-en-US-6/index.html?GUID-B5D058F5-1D0B-4720-8649-ACE5C0EEE2C0" target="_blank" rel="external noopener"><u class="+ topic/ph hi-d/u ph u">overview</u></a>.</p><p class="- topic/p p">1. Create a new MCC Harmony Project -- <a class="- topic/xref xref" href="GUID-B86E8493-D00D-46EF-8624-D412342147F0.html"><u class="+ topic/ph hi-d/u ph u">link</u></a> for instructions, selecting <strong class="+ topic/ph hi-d/b ph b"><span class="- topic/ph ph">WBZ451</span></strong> as Target Device.</p><p class="- topic/p p">2. After MCC is launched, in Device Resource window, expand <strong class="+ topic/ph hi-d/b ph b">Harmony – Wireless – Driver</strong>, select <strong class="+ topic/ph hi-d/b ph b">Bootloader</strong> and add the component. Accept all the dialog messages by clicking <strong class="+ topic/ph hi-d/b ph b">Yes</strong> on message prompt. This will resolve dependencies among components and add connection in the graph.</p><div class="- topic/p p"><figure class="- topic/fig fig fignone" id="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-24C1B00A-4B54-48CB-A235-36A2BDB5CC43" data-ofbid="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-24C1B00A-4B54-48CB-A235-36A2BDB5CC43"><figcaption class="- topic/title title figcap"><span class="figtitleprefix fig--title-label">Figure 13-2. <span id="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-305EE8A8-D114-4B9E-833C-630AE0D2B851" class="fig--title">Device Resources Window</span></span>. <span class="- topic/desc desc figdesc"><p class="- topic/p p">Harmony-Wireless-Dirver, select Bootloader</p></span></figcaption><div class=""><img class="- topic/image image" src="GUID-34199F7C-069F-4490-B8F6-1F31BFCE4E2E-high.jpg"/></div></figure><figure class="- topic/fig fig fignone" id="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-9AC79D28-4553-4747-B030-8E2DE596C2D3" data-ofbid="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-9AC79D28-4553-4747-B030-8E2DE596C2D3"><figcaption class="- topic/title title figcap"><span class="figtitleprefix fig--title-label">Figure 13-3. <span id="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-DA298643-546A-49F0-BB2B-9F55132550BE" class="fig--title">Confirmation for Components Auto-activiation</span></span>. <span class="- topic/desc desc figdesc"><p class="- topic/p p">Click all YES</p></span></figcaption><div class=""><img class="- topic/image image" src="GUID-4F97B847-2A22-4FC2-BA9C-A45176346204-high.jpg"/></div></figure>3. In the project graph window, select <strong class="+ topic/ph hi-d/b ph b">Bootloader</strong> component to show its Configuration Options. In the Configuration Options, enable <strong class="+ topic/ph hi-d/b ph b">Bootloader UART DFU</strong>, verify it is <strong class="+ topic/ph hi-d/b ph b">GPIO Trigger</strong> mode and port PB4 is selected as GPIO trigger port. PB4 is chosen as it is connected to SW2 on <span class="- topic/ph ph">WBZ451</span> Curiosity board. Then enable Console and leave <strong class="+ topic/ph hi-d/b ph b">ECC Public Key</strong> and <strong class="+ topic/ph hi-d/b ph b">Supported Authentication Methods</strong> to default.</div><div class="- topic/p p"><figure class="- topic/fig fig fignone" id="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-4F0773E5-A598-461F-84CA-B0327279A854" data-ofbid="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-4F0773E5-A598-461F-84CA-B0327279A854"><figcaption class="- topic/title title figcap"><span class="figtitleprefix fig--title-label">Figure 13-4. <span id="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-5B1206BF-B540-44A6-ADAE-6A0D4AE11F01" class="fig--title">Project Graph Window</span></span>. <span class="- topic/desc desc figdesc"><p class="- topic/p p">Select Bootloader to Configure</p></span></figcaption><div class=""><img class="- topic/image image" src="GUID-8791D0C0-AD64-4A1F-80C2-813DDC74D800-high.jpg"/></div></figure><figure class="- topic/fig fig fignone" id="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-8193D1EE-659A-4B1F-A5B8-DC68F74673EB" data-ofbid="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-8193D1EE-659A-4B1F-A5B8-DC68F74673EB"><figcaption class="- topic/title title figcap"><span class="figtitleprefix fig--title-label">Figure 13-5. <span id="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-D88CABED-FABD-41BC-9966-8B2225CA7FC8" class="fig--title">Bootloader Options for GPIO Trigger</span></span>. <span class="- topic/desc desc figdesc"><p class="- topic/p p">GPIO Trigger mode options</p></span></figcaption><div class=""><img class="- topic/image image" src="GUID-9A2FE934-30D4-4198-940F-9CEA18BEF039-high.jpg"/></div></figure></div><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">GPIO Trigger</strong> is the option to trigger DFU mode, where user needs to hold the GPIO button during reset to put the bootloader into DFU mode. Use <strong class="+ topic/ph hi-d/b ph b">GPIO Port</strong> and <strong class="+ topic/ph hi-d/b ph b">GPIO Pin</strong> option to change the port and pin based on user hardware.</p><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">Tip</strong>: Other than GPIO Trigger, another trigger option <strong class="+ topic/ph hi-d/b ph b">Timer Based Trigger</strong> is also provided, where bootloader will be in DFU mode for amount of time before jumping to the user application. User can change the <strong class="+ topic/ph hi-d/b ph b">DFU Wait Time in Milliseconds</strong> to change the amount of time. By selecting Timer Based Trigger, a 32bit timer component TC0 is asked to be activated, click <strong class="+ topic/ph hi-d/b ph b">YES</strong> to accept adding TC0 and accept its connection. Following figures show Timer Based Trigger options and message prompt of adding TC0.</p><div class="- topic/p p"><figure class="- topic/fig fig fignone" id="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-5A608F8B-1281-4E96-86F3-22DBCC549FC1" data-ofbid="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-5A608F8B-1281-4E96-86F3-22DBCC549FC1"><figcaption class="- topic/title title figcap"><span class="figtitleprefix fig--title-label">Figure 13-6. <span id="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-E12D6A15-6606-402D-A66C-8D6523414FAD" class="fig--title">Bootloader Options for Timer Based Trigger</span></span>. <span class="- topic/desc desc figdesc"><p class="- topic/p p">Timer Based Trigger mode options</p></span></figcaption><div class=""><img class="- topic/image image" src="GUID-33EA8A54-A465-4B9F-8B66-8744EF118988-high.jpg"/></div></figure><figure class="- topic/fig fig fignone" id="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-A25DF8FA-CB50-4514-A51D-454D1848A111" data-ofbid="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-A25DF8FA-CB50-4514-A51D-454D1848A111"><figcaption class="- topic/title title figcap"><span class="figtitleprefix fig--title-label">Figure 13-7. <span id="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-2FF78309-9DC5-4EB4-86D6-EEE57FCED89D" class="fig--title">Comfirmation for Components Auto-activiation</span></span>. <span class="- topic/desc desc figdesc">Click YES to Activate TC0 Component</span></figcaption><div class=""><img class="- topic/image image" src="GUID-C1821F14-69B6-4E6E-899A-6DC82510D69C-high.jpg"/></div></figure></div><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">Tip</strong>: For Supported Authentication Methods, 3 methods are provided: <strong class="+ topic/ph hi-d/b ph b">None</strong>, <strong class="+ topic/ph hi-d/b ph b">SHA256</strong>, and <strong class="+ topic/ph hi-d/b ph b">ECDSA256</strong>. Authentication methods with <strong class="+ topic/ph hi-d/b ph b">ECC Public Key</strong> are used to configure firmware authentication methods, including verifying firmware completion status and authenticating firmware vendor. For more details about these configurations, user can refer to <a class="- topic/xref xref" href="https://onlinedocs.microchip.com/pr/GUID-2085FE66-A762-4CC0-B054-7F98E8AF999A-en-US-2/index.html?GUID-4552A2E4-E35C-4FD0-9C01-0EE86D4F6163" target="_blank" rel="external noopener">here</a>.</p><p class="- topic/p p">4. In the project graph window, selecting the Bootloader component, right click the dependency of UART, select SERCOM0 in the Satisfiers list. Then SERCOM0 component will be added into project graph.</p><div class="- topic/p p"><figure class="- topic/fig fig fignone" id="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-565A9B83-F981-4726-B19D-BB6BC35476DC" data-ofbid="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-565A9B83-F981-4726-B19D-BB6BC35476DC"><figcaption class="- topic/title title figcap"><span class="figtitleprefix fig--title-label">Figure 13-8. <span id="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-1D9BFE5A-8874-4270-8870-9178CDF29595" class="fig--title">Dependency of UART</span></span>. <span class="- topic/desc desc figdesc"><p class="- topic/p p">Select SERCOM0 in UART Satisfiers</p></span></figcaption><div class=""><img class="- topic/image image" src="GUID-F52C7BDB-BA13-42D2-971E-ADB27F4B4693-high.jpg"/></div></figure><figure class="- topic/fig fig fignone" id="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-76B892DC-A782-40F4-88DB-ECA36BEC3128" data-ofbid="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-76B892DC-A782-40F4-88DB-ECA36BEC3128"><figcaption class="- topic/title title figcap"><span class="figtitleprefix fig--title-label">Figure 13-9. <span id="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-05F464B9-5E4F-4EF8-BED4-A51C794015D4" class="fig--title">Project Graph Window</span></span>. <span class="- topic/desc desc figdesc"><p class="- topic/p p">Select SERCOM0 to Configure</p></span></figcaption><div class=""><img class="- topic/image image" src="GUID-D2CCE71F-34C9-4A8C-8286-9236478DF505-high.jpg"/></div></figure>5. Select SERCOM0 component to open its Configuration Options, change <strong class="+ topic/ph hi-d/b ph b">Receive Pinout</strong> and <strong class="+ topic/ph hi-d/b ph b">Transmit Pinout</strong> according to <span class="- topic/ph ph">WBZ451</span> Curiosity board. Leave other settings to default.<figure class="- topic/fig fig fignone" id="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-A1EBC4D7-BDB7-4D74-B868-E57416FFCDDB" data-ofbid="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-A1EBC4D7-BDB7-4D74-B868-E57416FFCDDB"><figcaption class="- topic/title title figcap"><span class="figtitleprefix fig--title-label">Figure 13-10. <span id="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-8FC96002-5EFE-4FA0-98A9-FCD286F6ECC4" class="fig--title">SERCOM0 Options</span></span>. <span class="- topic/desc desc figdesc"><p class="- topic/p p">Configure Receive Pinout and Transmit Pinout</p></span></figcaption><div class=""><img class="- topic/image image" src="GUID-BA5CFB7E-27F9-4F0E-88D0-1CB8C7B62C76-high.jpg"/></div></figure>6. Expand tree of Peripherals, select and add RCON component. Verify RCON options, just leaving it as default is okay.<figure class="- topic/fig fig fignone" id="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-9231737E-A5F8-4E40-A5E6-66C3FDE95104" data-ofbid="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-9231737E-A5F8-4E40-A5E6-66C3FDE95104"><figcaption class="- topic/title title figcap"><span class="figtitleprefix fig--title-label">Figure 13-11. <span id="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-04726E84-B9F2-4D46-991A-2821A274455C" class="fig--title">Device Resources Window</span></span>. <span class="- topic/desc desc figdesc"><p class="- topic/p p">Harmony - Peripherals - RCON</p></span></figcaption><div class=""><img class="- topic/image image" src="GUID-49D9F570-070A-4A72-9B4C-2790A73778D1-high.jpg"/></div></figure><figure class="- topic/fig fig fignone" id="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-65CD005D-4D9A-4E2D-AD9D-11FAE0DB327B" data-ofbid="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-65CD005D-4D9A-4E2D-AD9D-11FAE0DB327B"><figcaption class="- topic/title title figcap"><span class="figtitleprefix fig--title-label">Figure 13-12. <span id="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-6F3FF1BC-9A9A-411B-A721-ADE7BA5835CB" class="fig--title">Project Graph Window</span></span>. <span class="- topic/desc desc figdesc"><p class="- topic/p p">Select RCON to Check its Options</p></span></figcaption><div class=""><img class="- topic/image image" src="GUID-8911B3C3-105E-4F1C-B58D-24BB261FEE7C-high.jpg"/></div></figure></div><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">Tip</strong>: RCON provides software reset function, adding RCON component is for enabling automatical firmware reboot after DFU completion.</p><div class="- topic/p p">7. Then press <strong class="+ topic/ph hi-d/b ph b">Generate</strong> button to generate the code.<figure class="- topic/fig fig fignone" id="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-9B1D3E00-5F62-40E1-AAC1-F73BD597AF9F" data-ofbid="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-9B1D3E00-5F62-40E1-AAC1-F73BD597AF9F"><figcaption class="- topic/title title figcap"><span class="figtitleprefix fig--title-label">Figure 13-13. <span id="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-A53D7ECF-56C8-4589-8CC6-DE206F3C5C72" class="fig--title">Generate Bootloader Code</span></span>. <span class="- topic/desc desc figdesc"><p class="- topic/p p">Press MCC Generate Button to Generate the Code</p></span></figcaption><div class=""><img class="- topic/image image" src="GUID-69A35D44-C482-4CE3-9DE5-47CEDC7B0FAB-high.jpg"/></div></figure>8. To make the Bootloader code be fit into 24KB boot memory of <span class="- topic/ph ph">PIC32CXBZ2</span>, manually find and replace <strong class="+ topic/ph hi-d/b ph b">ecc.c</strong> and <strong class="+ topic/ph hi-d/b ph b">crypt_ecc_pukcl.c</strong> with files provided in <strong class="+ topic/ph hi-d/b ph b">wireless_pic32cxbz_wbz\utilities\pic32cx-bz\tempBtl</strong></div><p class="- topic/p p">9. To enable firmware auto reboot after DFU completion, it need host end to send a new command to bootloader. This new command is device Reset command defined to 0x12. To add this command definition, open file progexec.h, add code as below:</p><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">#define DEVICE_RESET_CMD 0x12</strong></p><div class="- topic/p p"><figure class="- topic/fig fig fignone" id="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-4E13CE1B-8FAA-469D-8ECC-64AC37595B5B" data-ofbid="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-4E13CE1B-8FAA-469D-8ECC-64AC37595B5B"><figcaption class="- topic/title title figcap"><span class="figtitleprefix fig--title-label">Figure 13-14. <span id="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-A80A06F0-44BF-4AD3-B172-08027B6E28CD" class="fig--title">Code Change in File progexec.h</span></span>. <span class="- topic/desc desc figdesc"><p class="- topic/p p">Add RESET_CMD Definition</p></span></figcaption><div class=""><img class="- topic/image image" src="GUID-BDEB5CD7-193C-46FC-A10C-06E78158AFE5-high.jpg"/></div></figure>Then in file progexec.c, function <strong class="+ topic/ph hi-d/b ph b">program_exec_main()</strong>, add code to handle device Reset command, call <strong class="+ topic/ph hi-d/b ph b">RCON_SoftwareReset()</strong> to start software reset. Code added is shown in below figure.<figure class="- topic/fig fig fignone" id="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-136BBC41-FD04-4AC7-9F29-E6A01F56E642" data-ofbid="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-136BBC41-FD04-4AC7-9F29-E6A01F56E642"><figcaption class="- topic/title title figcap"><span class="figtitleprefix fig--title-label">Figure 13-15. <span id="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-F6F2D759-9DF0-4200-91A9-388EE21FD350" class="fig--title">Code Change in File progexec.c</span></span>. <span class="- topic/desc desc figdesc"><p class="- topic/p p">Add RESET_CMD Command Handler</p></span></figcaption><div class=""><img class="- topic/image image" src="GUID-6CD69C68-F7AE-4AA3-8AF1-5C367BC54493-high.jpg"/></div></figure></div><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">Tip</strong>: firmware auto reboot also needs host end modification to send 0x12 command to reset device after DFU completion, so far only PC GUI tool(MicrochipUtilityTool.exe) is modified and supported it, Python scripts as another way have not been modified to support it.</p><p class="- topic/p p">10. On the IDE Tools bar, click <strong class="+ topic/ph hi-d/b ph b">Clean and Build Main Project</strong> to build the code, <em class="+ topic/ph hi-d/i ph i">bootloader.X.production.hex</em> file will be generated. User can also find precompiled hex files under folder <em class="+ topic/ph hi-d/i ph i">wireless_apps_pic32cxbz2_wbz45\apps\bootloader\bootloader\precompiled_hex</em>.</p><div class="- topic/p p"><figure class="- topic/fig fig fignone" id="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-AD1950C3-C338-4FED-A675-874865A1A0FD" data-ofbid="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-AD1950C3-C338-4FED-A675-874865A1A0FD"><figcaption class="- topic/title title figcap"><span class="figtitleprefix fig--title-label">Figure 13-16. <span id="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-68ACF79A-D076-47DF-B8E7-1CDDACFDC384" class="fig--title">Build Bootloader Code</span></span>. <span class="- topic/desc desc figdesc"><p class="- topic/p p">Click <strong class="+ topic/ph hi-d/b ph b">Clean and Build Main Project</strong> to Build Code</p></span></figcaption><div class=""><img class="- topic/image image" src="GUID-B7F7E57A-B98A-4D63-A9F1-29D08E051C1A-high.jpg"/></div></figure></div><p class="- topic/p p">While generated bootloader hex file should be added to user aplication as Loadable File, they shouldn't be used alone. Followings are talking about a few simple steps need to be handled at user application side.</p><section class="- topic/section section" id="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-D83B387C-C1ED-437A-9B48-F6196A8B6C8F" data-ofbid="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-D83B387C-C1ED-437A-9B48-F6196A8B6C8F"><h2 class="- topic/title title sectiontitle">Configure User Application to Use Bootloader</h2></section><p class="- topic/p p">To use Bootloader with a user application, there are a few steps to be configured at user application project. These steps are common to any user application that wants to have Bootloader capability, these steps include:</p><ul class="- topic/ul ul"><li class="- topic/li li" id="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-C93B85FD-04BC-458C-8B0D-432DBB60DFBB" data-ofbid="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-C93B85FD-04BC-458C-8B0D-432DBB60DFBB"><p class="- topic/p p">Add <strong class="+ topic/ph hi-d/b ph b">Bootloader Services</strong> component onto user application project and generate code</p></li><li class="- topic/li li" id="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-1D28EC8B-EB9D-46B4-924B-2AC4F6D9BE3E" data-ofbid="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-1D28EC8B-EB9D-46B4-924B-2AC4F6D9BE3E"><p class="- topic/p p">Add Bootloader as <strong class="+ topic/ph hi-d/b ph b">Loadable File/Project</strong> to create unified image</p></li><li class="- topic/li li" id="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-03A92717-0DA5-44D5-944F-EC67CEC50981" data-ofbid="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-03A92717-0DA5-44D5-944F-EC67CEC50981"><p class="- topic/p p">Program unified image to device.</p></li></ul><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">Add Bootloader Services Component and Generate Code</strong></p><p class="- topic/p p">Open any user application project with MPLAB X IDE, click on <strong class="+ topic/ph hi-d/b ph b">MCC</strong> icon on Tools bar to launch MPLAB Code Configurator to open project graph.</p><p class="- topic/p p">In Device Resource window, expand <strong class="+ topic/ph hi-d/b ph b">Harmony – Wireless – Driver</strong>, select <strong class="+ topic/ph hi-d/b ph b">Bootloader Services</strong> component and add it. This component generates the supporting linker file and MPLABX script needed for adding metadata header into application image(Project Properties is added with <strong class="+ topic/ph hi-d/b ph b">SignFirmware</strong> settings). <strong class="+ topic/ph hi-d/b ph b">Use Firmware Signature Verification API in Bootloader</strong> is the only option in Bootloader Services component. For DFU via UART, it is not necessary to enable firmware signature and verification, although user can do so if needs. While for OTAU, user must enable firmware signature and verification, by clicking on check box to <strong class="+ topic/ph hi-d/b ph b">Use Firmware Signature Verification API in Bootloader</strong>.</p><p class="- topic/p p">(Following project graph is just an example, user may have different graph depending on their application.)</p><div class="- topic/p p"><figure class="- topic/fig fig fignone" id="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-FC5B44F6-4E02-4D0A-8240-C804B1F8AE93" data-ofbid="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-FC5B44F6-4E02-4D0A-8240-C804B1F8AE93"><figcaption class="- topic/title title figcap"><span class="figtitleprefix fig--title-label">Figure 13-17. <span id="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-5C7C4B87-02DB-4BBE-9EA2-647C94A638B4" class="fig--title">User Application Add Bootloader Services</span></span>. <span class="- topic/desc desc figdesc"><p class="- topic/p p">Add Bootloader Services and Configure</p></span></figcaption><div class=""><img class="- topic/image image" src="GUID-B306A9D8-0655-461D-A496-EBF5BEABBE2B-high.jpg"/></div></figure></div><p class="- topic/p p">After <strong class="+ topic/ph hi-d/b ph b">Bootloader Services</strong> component is added and configured, press <strong class="+ topic/ph hi-d/b ph b">Generate</strong> button to generate the user application code. In the generated new code, some code about bootloader service is added, as well as project’s linker script file is also automatically changed to reflect bootloader functionality.</p><div class="- topic/p p"><figure class="- topic/fig fig fignone" id="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-497D043A-83BB-4F99-B491-05A8A091FB7A" data-ofbid="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-497D043A-83BB-4F99-B491-05A8A091FB7A"><figcaption class="- topic/title title figcap"><span class="figtitleprefix fig--title-label">Figure 13-18. <span id="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-70603F35-B697-4834-8B33-E9CDA5BEF07D" class="fig--title">Generate User Application Code</span></span>. <span class="- topic/desc desc figdesc"><p class="- topic/p p">Press <strong class="+ topic/ph hi-d/b ph b">Generate</strong> button to Generate User Application Code</p></span></figcaption><div class=""><img class="- topic/image image" src="GUID-69A35D44-C482-4CE3-9DE5-47CEDC7B0FAB-high.jpg"/></div></figure>Also in the updated new project, <strong class="+ topic/ph hi-d/b ph b">SignFirmware</strong> setting is added into Project Properties. (if not see it, try close and open MPLABX to refresh the project.) It's strongly recommended to enable Authen Method as <strong class="+ topic/ph hi-d/b ph b">SHA256</strong> or <strong class="+ topic/ph hi-d/b ph b">ECDSA256-SHA256</strong> in SignFirmware setting. If user choose <strong class="+ topic/ph hi-d/b ph b">None</strong>, since there is no firmware integrity check, if any issue happens during image saving into slot1, as new image may not be complete, the firmware may become non-functional at next restart. So <strong class="+ topic/ph hi-d/b ph b">None</strong> option is not secure for firmware upgrade.</div><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">ECDSA256-SHA256</strong>: firmware signature validation and data integrity check.</p><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">SHA256</strong>: firmware data integrity check.</p><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">None</strong>: no security, no integrity check.</p><div class="- topic/p p"><figure class="- topic/fig fig fignone" id="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-D085B5DC-BF08-4ECF-B06E-C64695FE972C" data-ofbid="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-D085B5DC-BF08-4ECF-B06E-C64695FE972C"><figcaption class="- topic/title title figcap"><span class="figtitleprefix fig--title-label">Figure 13-19. <span id="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-AFC2B701-2891-4A4E-84E3-4A56D40F2AD3" class="fig--title">SignFirmware - Auth Method - ECDSA256-SHA256</span></span>. <span class="- topic/desc desc figdesc"><p class="- topic/p p">Firmware signature and integrity check</p></span></figcaption><div class=""><img class="- topic/image image" src="GUID-25596970-8C3C-4095-9DEB-2E32F411B8B2-high.jpg"/></div></figure><figure class="- topic/fig fig fignone" id="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-1A8ADD3E-F777-4A94-A7A0-31FC7546B461" data-ofbid="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-1A8ADD3E-F777-4A94-A7A0-31FC7546B461"><figcaption class="- topic/title title figcap"><span class="figtitleprefix fig--title-label">Figure 13-20. <span id="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-ADDB1244-3F6B-491C-B88A-FE408B553BEF" class="fig--title">SignFirmware - Auth Method - SHA256</span></span>. <span class="- topic/desc desc figdesc"><p class="- topic/p p">Firmware integrity check</p></span></figcaption><div class=""><img class="- topic/image image" src="GUID-D006A702-54D6-45ED-B69A-9D0C3FD15617-high.jpg"/></div></figure><strong class="+ topic/ph hi-d/b ph b">Tip</strong>: Sequence Number cannot be 0x00000000 or 0xffffffff, which are invalid values.</div><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">Add Bootloader as Lodable File/Project to Create Unified Image</strong></p><p class="- topic/p p">Once the new code is generated and configured, user need to add Bootloader as a loadable project/loadable hex file in the updated project. This enables MPLAB X IDE to merge both user application and bootloader and make an unified firmware by creating an unified image file.</p><p class="- topic/p p">To add Bootloader as loadable file, expand application project’s tree, right click <strong class="+ topic/ph hi-d/b ph b">Loadables</strong>, select <strong class="+ topic/ph hi-d/b ph b">Add Loadable File</strong>, then browse and add the bootloader hex file.</p><div class="- topic/p p"><figure class="- topic/fig fig fignone" id="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-D78F3E52-4EB6-44F3-AF11-3E3ADED0AC24" data-ofbid="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-D78F3E52-4EB6-44F3-AF11-3E3ADED0AC24"><figcaption class="- topic/title title figcap"><span class="figtitleprefix fig--title-label">Figure 13-21. <span id="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-E4858A93-8D57-4008-B150-F4C044789370" class="fig--title">User Application Add Loadable File</span></span>. <span class="- topic/desc desc figdesc"><p class="- topic/p p">Right Click <strong class="+ topic/ph hi-d/b ph b">Loadables</strong> and Add Loadable File</p></span></figcaption><div class=""><img class="- topic/image image" src="GUID-B563DEEC-85C0-49B9-A29D-7700D2F5ABCD-high.jpg"/></div></figure><figure class="- topic/fig fig fignone" id="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-D517AD23-4312-4B6E-B3BA-7B1687BD2579" data-ofbid="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-D517AD23-4312-4B6E-B3BA-7B1687BD2579"><figcaption class="- topic/title title figcap"><span class="figtitleprefix fig--title-label">Figure 13-22. <span id="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-A4142D8D-4DFF-4D63-9ED7-6580A9461C94" class="fig--title">Add Loadable File</span></span>. <span class="- topic/desc desc figdesc"><p class="- topic/p p">Select Bootloader Precompiled Hex File as Loadable File</p></span></figcaption><div class=""><img class="- topic/image image" src="GUID-71682126-FC22-42DD-BA17-113EAE120EFD-high.jpg"/></div></figure></div><div class="- topic/p p">To add bootloader as loadable project, expand application project’s tree, right click <strong class="+ topic/ph hi-d/b ph b">Loadables</strong>, select <strong class="+ topic/ph hi-d/b ph b">Add Loadable Project</strong>, then browse and add the bootloader project.<figure class="- topic/fig fig fignone" id="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-DC1B89D9-C0C1-4665-9E4A-C1DA9D14642B" data-ofbid="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-DC1B89D9-C0C1-4665-9E4A-C1DA9D14642B"><figcaption class="- topic/title title figcap"><span class="figtitleprefix fig--title-label">Figure 13-23. <span id="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-8498BB18-A3DD-4C18-BC2C-259B67D871FA" class="fig--title">User Application Add Loadable Project</span></span>. <span class="- topic/desc desc figdesc"><p class="- topic/p p">Right Click <strong class="+ topic/ph hi-d/b ph b">Loadables</strong> and Add Loadable Project</p></span></figcaption><div class=""><img class="- topic/image image" src="GUID-96158184-450B-4A70-9A40-D6090B092CB2-high.jpg"/></div></figure></div><div class="- topic/p p"><figure class="- topic/fig fig fignone" id="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-FED42244-00A1-4C42-8875-955A3903A2D4" data-ofbid="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-FED42244-00A1-4C42-8875-955A3903A2D4"><figcaption class="- topic/title title figcap"><span class="figtitleprefix fig--title-label">Figure 13-24. <span id="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-A4AD9D90-FBC6-45A8-9022-92DEEBF91949" class="fig--title">Add Loadable Project</span></span>. <span class="- topic/desc desc figdesc"><p class="- topic/p p">Select Bootloader Project as Loadable Project</p></span></figcaption><div class=""><img class="- topic/image image" src="GUID-CAFDC94F-CC3B-4716-99CF-B65CB0545EC9-high.jpg"/></div></figure>After Loadable File or Project is added, then on the IDE Tools bar, click <strong class="+ topic/ph hi-d/b ph b">Clean and Build Main Project</strong> icon to rebuild the project.</div><div class="- topic/p p"><figure class="- topic/fig fig fignone" id="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-1DDFD749-26EE-47F4-9C1D-3C96DF4FBB6B" data-ofbid="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-1DDFD749-26EE-47F4-9C1D-3C96DF4FBB6B"><figcaption class="- topic/title title figcap"><span class="figtitleprefix fig--title-label">Figure 13-25. <span id="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-E9BDE132-FD0A-4CA8-8E55-03CE24A9FF9F" class="fig--title">Build to Create Unified Image</span></span>. <span class="- topic/desc desc figdesc">Click <strong class="+ topic/ph hi-d/b ph b">Clean and Build Main Project</strong> to Create<p class="- topic/p p">Unified Image Merged Both User Application and Bootloader</p></span></figcaption><div class=""><img class="- topic/image image" src="GUID-B7F7E57A-B98A-4D63-A9F1-29D08E051C1A-high.jpg"/></div></figure>After code is built, a few files is generated under path <u class="+ topic/ph hi-d/u ph u">f</u><em class="+ topic/ph hi-d/i ph i">irmware\ble_sensor.X\dist\default\production</em>. The file named as <strong class="+ topic/ph hi-d/b ph b">signed.unified.hex</strong> is the unified image merged with both user application and bootloader. By programing this unified image, user application will have bootloader capability. The file named as <strong class="+ topic/ph hi-d/b ph b">signed.bin</strong> file is the target binary image file that bootloader use for DFU. If user has any modifications on user application firmware, user can build and generate this binary file, then use bootloader to upgrade device to new image.</div><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">Program Unified Image</strong></p><div class="- topic/p p">As mentioned above, user need to program device with unified image to make user application to have bootloader capability, to do this, on the IDE Tools bar, click <strong class="+ topic/ph hi-d/b ph b">Make and Program Device Main Project</strong> icon to program device, the unified image will be programmed into device.<figure class="- topic/fig fig fignone" id="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-77C239EA-F4D5-495B-B180-8AF4144DE6DA" data-ofbid="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-77C239EA-F4D5-495B-B180-8AF4144DE6DA"><figcaption class="- topic/title title figcap"><span class="figtitleprefix fig--title-label">Figure 13-26. <span id="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-5D7E4AC1-7392-4A88-AA40-49FC81FB7F46" class="fig--title">Program Unified Image</span></span>. <span class="- topic/desc desc figdesc"><p class="- topic/p p">Click <strong class="+ topic/ph hi-d/b ph b">Make And Program Device Main Project</strong> to Program Unified Image</p></span></figcaption><div class=""><img class="- topic/image image" src="GUID-6B3A91FA-69E9-4EE5-ADC5-5976897B400F-high.jpg"/></div></figure>Now the device with user application will have bootloader functionality, referring the guidance in <a class="- topic/xref xref" href="GUID-003E64BA-98A3-40EA-8417-ED7F09C14761.html">Device Firmware Upgrade Over Serial</a>, user can run Device Firmware Upgrade by using the bootloader.</div></div></article></main></div>
                        
                        
                        
                        
                        
                        
                    </div>
                    
                        <nav role="navigation" id="wh_topic_toc" aria-label="On this page" class="col-lg-2 d-none d-lg-block navbar d-print-none"> 
                            <div id="wh_topic_toc_content">
		                        
	                            <div class=" wh_topic_toc "><div class="wh_topic_label">On this page</div><ul><li class="section-item"><div class="section-title"><a href="#GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-4600C314-6BE7-4ABC-90C1-CFB163261393" data-tocid="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-4600C314-6BE7-4ABC-90C1-CFB163261393">Introduction</a></div></li><li class="section-item"><div class="section-title"><a href="#GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-881DEB27-9C11-4617-9B56-8B4E7D0E4829" data-tocid="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-881DEB27-9C11-4617-9B56-8B4E7D0E4829"><span class="- topic/ph ph">PIC32CXBZ2</span> Standalone Bootloader Component</a></div></li><li class="section-item"><div class="section-title"><a href="#GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-8BB1D890-221C-46E7-A103-BC77B130A573" data-tocid="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-8BB1D890-221C-46E7-A103-BC77B130A573">Bootloader Example Code</a></div></li><li class="section-item"><div class="section-title"><a href="#GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-8A406025-673D-4A19-9E25-F3D42627031A" data-tocid="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-8A406025-673D-4A19-9E25-F3D42627031A">Creating Bootloader From Scratch Using MCC</a></div></li><li class="section-item"><div class="section-title"><a href="#GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-D83B387C-C1ED-437A-9B48-F6196A8B6C8F" data-tocid="GUID-399616BF-E65E-43B3-9831-4B19472A5EF0__GUID-D83B387C-C1ED-437A-9B48-F6196A8B6C8F">Configure User Application to Use Bootloader</a></div></li></ul></div>
	                        	
                        	</div>
                        </nav>
                    
                </div>
            </div>
            
            
            
        </div> 
        <div class="mchp_disclaimer"><p class="mchp_disclaimer_text">The online versions of the documents are provided as a courtesy. Verify all content and data in the device’s PDF documentation found on the device product page.</p></div><footer class="navbar navbar-default wh_footer">
  <div class=" footer-container mx-auto ">
    <div class="footer">
  <div class="mchp-wh-footer">
    <div class="mchp-footer">
      <div class="mchp-footer-tier1">
        <div class="spacer"></div>
        <div class="mchp-footer-container">
          <div class="mchp-footer-links mchp-social-media-links">
            <div class="mchp-component-items">
              <div class="mchp-component-item">
                <a class="cmp-image__link" href="https://www.facebook.com/pages/Microchip-Technology-Inc/20320981741" target="_blank">
                  <img class="cmp-image__image" alt="Microchip Facebook" src="oxygen-webhelp/template/resources/images/201016-corp-facebook.png"/>
                </a>
              </div>
              <div class="mchp-component-item">
                <a class="cmp-image__link" href="https://www.linkedin.com/company/microchip-technology" target="_blank">
                  <img class="cmp-image__image" alt="Microchip LinkedIn" src="oxygen-webhelp/template/resources/images/201016-corp-linkedin.png"/>
                </a>
              </div>
              <div class="mchp-component-item">
                <a class="cmp-image__link" href="https://twitter.com/MicrochipTech" target="_blank">
                  <img class="cmp-image__image" alt="Microchip Twitter" src="oxygen-webhelp/template/resources/images/201016-corp-twitter.png"/>
                </a>
              </div>
              <div class="mchp-component-item">
                <a class="cmp-image__link" href="https://www.youtube.com/user/MicrochipTechnology" target="_blank">
                  <img class="cmp-image__image" alt="Microchip YouTube" src="oxygen-webhelp/template/resources/images/201016-corp-youtube.png"/>
                </a>
              </div>
              <div class="mchp-component-item">
                <a class="cmp-image__link" href="https://www.instagram.com/microchiptechnologyinc/" target="_blank">
                  <img class="cmp-image__image" alt="Microchip Instagram" src="oxygen-webhelp/template/resources/images/201016-corp-instagram.png"/>
                </a>
              </div>
              <div class="mchp-component-item">
                <a class="cmp-image__link" href="https://www.weibo.com/microchiptech" target="_blank">
                  <img class="cmp-image__image" alt="Microchip Weibo" src="oxygen-webhelp/template/resources/images/201016-corp-weibo.png"/>
                </a>
              </div>
              <div class="mchp-component-item">
                <a class="cmp-image__link" href="https://www.microchip.com/en-us/about/blog" target="_blank">
                  <img class="cmp-image__image" alt="Microchip Blog" src="oxygen-webhelp/template/resources/images/201016-corp-blog.png"/>
                </a>
              </div>
            </div>
          </div>
          <div class="mchp-footer-links">
            <div class="mchp-component-items">
              <div class="mchp-component-item">
                <div class="link">
                  <a href="https://www.microchip.com/about-us/contact-us" class="mchp-link__link">Contact</a>
                  <span class="mchp-link__separator">|</span>
                </div>
              </div>
              <div class="mchp-component-item ">
                <div class="link">
                  <a href="https://www.microchip.com/en-us/about/legal-information" class="mchp-link__link">Legal</a>
                  <span class="mchp-link__separator">|</span>
                </div>
              </div>
              <div class="mchp-component-item ">
                <div class="link">
                  <a href="https://www.microchip.com/en-us/about/legal-information/privacy-policy" class="mchp-link__link">Privacy Policy</a>
                  <span class="mchp-link__separator">|</span>
                </div>
              </div>
              <div class="mchp-component-item ">
                <div class="link">
                  <a href="https://www.microchip.com/en-us/about/legal-information/microchip-cookie-statement" class="mchp-link__link">Cookies</a>
                  <span class="mchp-link__separator">|</span>
                </div>
              </div>
              <div class="mchp-component-item">
                <div class="link">
                  <a href="https://careers.microchip.com/" class="mchp-link__link">Careers</a>
                  <span class="mchp-link__separator"></span>
                </div>
              </div>
            </div>
          </div>
          <div class="mchp-footer-newsletter">
            <div class="cmp-text">
              <p>Stay on the leading edge with our blog</p>
            </div>
            <div class="mchp-button-wrapper">
              <a role="button" href="https://www.microchip.com/en-us/about/blog" class="mchp-button mchp-button-regular solid">
                <span class="mchp-button__span">MicroSolutions</span>
              </a>
            </div>
          </div>
        </div>
        <div class="graphic">
          <img src="oxygen-webhelp/template/resources/images/footer-graphic.png"/>
        </div>
      </div>
      <div class="mchp-footer-tier2">
        <p class="mchp-copyright">© Copyright 1998-2022 Microchip Technology Inc. All rights reserved.</p>
      </div>
    </div>
  </div>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async="true" src="https://www.googletagmanager.com/gtag/js?id=UA-2724382-19"></script>
  <script>
    window.dataLayer = window.dataLayer || [];  
    function gtag(){dataLayer.push(arguments);}  
    gtag('js', new Date());   
    gtag('config', 'UA-2724382-19');
  </script>
</div>
  </div>
</footer>
        
        <div id="go2top" class="d-print-none">
            <span class="oxy-icon oxy-icon-up"></span>
        </div>
        
        <div id="modal_img_large" class="modal">
            <span class="close oxy-icon oxy-icon-remove"></span>
            <div id="modal_img_container"></div>
            <div id="caption"></div>
        </div>
        
        
        
        
        <script type="text/javascript">_satellite.pageBottom();</script><!-- Adobe Analytics -->
        </body>
</html>